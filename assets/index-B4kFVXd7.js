var Pp=Object.defineProperty;var Rp=(s,t,e)=>t in s?Pp(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var C=(s,t,e)=>Rp(s,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();var er=(s=>(s[s.WEBGL_LEGACY=0]="WEBGL_LEGACY",s[s.WEBGL=1]="WEBGL",s[s.WEBGL2=2]="WEBGL2",s))(er||{}),_c=(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.WEBGL=1]="WEBGL",s[s.CANVAS=2]="CANVAS",s))(_c||{}),ua=(s=>(s[s.COLOR=16384]="COLOR",s[s.DEPTH=256]="DEPTH",s[s.STENCIL=1024]="STENCIL",s))(ua||{}),W=(s=>(s[s.NORMAL=0]="NORMAL",s[s.ADD=1]="ADD",s[s.MULTIPLY=2]="MULTIPLY",s[s.SCREEN=3]="SCREEN",s[s.OVERLAY=4]="OVERLAY",s[s.DARKEN=5]="DARKEN",s[s.LIGHTEN=6]="LIGHTEN",s[s.COLOR_DODGE=7]="COLOR_DODGE",s[s.COLOR_BURN=8]="COLOR_BURN",s[s.HARD_LIGHT=9]="HARD_LIGHT",s[s.SOFT_LIGHT=10]="SOFT_LIGHT",s[s.DIFFERENCE=11]="DIFFERENCE",s[s.EXCLUSION=12]="EXCLUSION",s[s.HUE=13]="HUE",s[s.SATURATION=14]="SATURATION",s[s.COLOR=15]="COLOR",s[s.LUMINOSITY=16]="LUMINOSITY",s[s.NORMAL_NPM=17]="NORMAL_NPM",s[s.ADD_NPM=18]="ADD_NPM",s[s.SCREEN_NPM=19]="SCREEN_NPM",s[s.NONE=20]="NONE",s[s.SRC_OVER=0]="SRC_OVER",s[s.SRC_IN=21]="SRC_IN",s[s.SRC_OUT=22]="SRC_OUT",s[s.SRC_ATOP=23]="SRC_ATOP",s[s.DST_OVER=24]="DST_OVER",s[s.DST_IN=25]="DST_IN",s[s.DST_OUT=26]="DST_OUT",s[s.DST_ATOP=27]="DST_ATOP",s[s.ERASE=26]="ERASE",s[s.SUBTRACT=28]="SUBTRACT",s[s.XOR=29]="XOR",s))(W||{}),Fe=(s=>(s[s.POINTS=0]="POINTS",s[s.LINES=1]="LINES",s[s.LINE_LOOP=2]="LINE_LOOP",s[s.LINE_STRIP=3]="LINE_STRIP",s[s.TRIANGLES=4]="TRIANGLES",s[s.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",s[s.TRIANGLE_FAN=6]="TRIANGLE_FAN",s))(Fe||{}),M=(s=>(s[s.RGBA=6408]="RGBA",s[s.RGB=6407]="RGB",s[s.RG=33319]="RG",s[s.RED=6403]="RED",s[s.RGBA_INTEGER=36249]="RGBA_INTEGER",s[s.RGB_INTEGER=36248]="RGB_INTEGER",s[s.RG_INTEGER=33320]="RG_INTEGER",s[s.RED_INTEGER=36244]="RED_INTEGER",s[s.ALPHA=6406]="ALPHA",s[s.LUMINANCE=6409]="LUMINANCE",s[s.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",s[s.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",s[s.DEPTH_STENCIL=34041]="DEPTH_STENCIL",s))(M||{}),Tr=(s=>(s[s.TEXTURE_2D=3553]="TEXTURE_2D",s[s.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",s[s.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",s[s.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",s[s.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",s[s.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",s[s.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",s))(Tr||{}),V=(s=>(s[s.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",s[s.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",s[s.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",s[s.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",s[s.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",s[s.UNSIGNED_INT=5125]="UNSIGNED_INT",s[s.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",s[s.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",s[s.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",s[s.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",s[s.BYTE=5120]="BYTE",s[s.SHORT=5122]="SHORT",s[s.INT=5124]="INT",s[s.FLOAT=5126]="FLOAT",s[s.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",s[s.HALF_FLOAT=36193]="HALF_FLOAT",s))(V||{}),N=(s=>(s[s.FLOAT=0]="FLOAT",s[s.INT=1]="INT",s[s.UINT=2]="UINT",s))(N||{}),ge=(s=>(s[s.NEAREST=0]="NEAREST",s[s.LINEAR=1]="LINEAR",s))(ge||{}),mi=(s=>(s[s.CLAMP=33071]="CLAMP",s[s.REPEAT=10497]="REPEAT",s[s.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",s))(mi||{}),Ue=(s=>(s[s.OFF=0]="OFF",s[s.POW2=1]="POW2",s[s.ON=2]="ON",s[s.ON_MANUAL=3]="ON_MANUAL",s))(Ue||{}),Vt=(s=>(s[s.NPM=0]="NPM",s[s.UNPACK=1]="UNPACK",s[s.PMA=2]="PMA",s[s.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",s[s.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",s[s.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",s))(Vt||{}),Ie=(s=>(s[s.NO=0]="NO",s[s.YES=1]="YES",s[s.AUTO=2]="AUTO",s[s.BLEND=0]="BLEND",s[s.CLEAR=1]="CLEAR",s[s.BLIT=2]="BLIT",s))(Ie||{}),Sh=(s=>(s[s.AUTO=0]="AUTO",s[s.MANUAL=1]="MANUAL",s))(Sh||{}),oe=(s=>(s.LOW="lowp",s.MEDIUM="mediump",s.HIGH="highp",s))(oe||{}),Ct=(s=>(s[s.NONE=0]="NONE",s[s.SCISSOR=1]="SCISSOR",s[s.STENCIL=2]="STENCIL",s[s.SPRITE=3]="SPRITE",s[s.COLOR=4]="COLOR",s))(Ct||{}),At=(s=>(s[s.NONE=0]="NONE",s[s.LOW=2]="LOW",s[s.MEDIUM=4]="MEDIUM",s[s.HIGH=8]="HIGH",s))(At||{}),Be=(s=>(s[s.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",s[s.ARRAY_BUFFER=34962]="ARRAY_BUFFER",s[s.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",s))(Be||{});const Ip={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")},k={ADAPTER:Ip,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var po=/iPhone/i,ol=/iPod/i,al=/iPad/i,hl=/\biOS-universal(?:.+)Mac\b/i,mo=/\bAndroid(?:.+)Mobile\b/i,ll=/Android/i,rr=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Ns=/Silk/i,$e=/Windows Phone/i,ul=/\bWindows(?:.+)ARM\b/i,cl=/BlackBerry/i,dl=/BB10/i,fl=/Opera Mini/i,pl=/\b(CriOS|Chrome)(?:.+)Mobile/i,ml=/Mobile(?:.+)Firefox\b/i,gl=function(s){return typeof s<"u"&&s.platform==="MacIntel"&&typeof s.maxTouchPoints=="number"&&s.maxTouchPoints>1&&typeof MSStream>"u"};function Mp(s){return function(t){return t.test(s)}}function _l(s){var t={userAgent:"",platform:"",maxTouchPoints:0};!s&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof s=="string"?t.userAgent=s:s&&s.userAgent&&(t={userAgent:s.userAgent,platform:s.platform,maxTouchPoints:s.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var r=Mp(e),n={apple:{phone:r(po)&&!r($e),ipod:r(ol),tablet:!r(po)&&(r(al)||gl(t))&&!r($e),universal:r(hl),device:(r(po)||r(ol)||r(al)||r(hl)||gl(t))&&!r($e)},amazon:{phone:r(rr),tablet:!r(rr)&&r(Ns),device:r(rr)||r(Ns)},android:{phone:!r($e)&&r(rr)||!r($e)&&r(mo),tablet:!r($e)&&!r(rr)&&!r(mo)&&(r(Ns)||r(ll)),device:!r($e)&&(r(rr)||r(Ns)||r(mo)||r(ll))||r(/\bokhttp\b/i)},windows:{phone:r($e),tablet:r(ul),device:r($e)||r(ul)},other:{blackberry:r(cl),blackberry10:r(dl),opera:r(fl),firefox:r(ml),chrome:r(pl),device:r(cl)||r(dl)||r(fl)||r(ml)||r(pl)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const Dp=_l.default??_l,Ye=Dp(globalThis.navigator);k.RETINA_PREFIX=/@([0-9\.]+)x/;k.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var hs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yc(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function Fp(s){if(s.__esModule)return s;var t=s.default;if(typeof t=="function"){var e=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(s).forEach(function(i){var r=Object.getOwnPropertyDescriptor(s,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return s[i]}})}),e}var vc={exports:{}};(function(s){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function r(h,l,u){this.fn=h,this.context=l,this.once=u||!1}function n(h,l,u,c,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new r(u,c||h,d),m=e?e+l:l;return h._events[m]?h._events[m].fn?h._events[m]=[h._events[m],f]:h._events[m].push(f):(h._events[m]=f,h._eventsCount++),h}function o(h,l){--h._eventsCount===0?h._events=new i:delete h._events[l]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,c;if(this._eventsCount===0)return l;for(c in u=this._events)t.call(u,c)&&l.push(e?c.slice(1):c);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=e?e+l:l,c=this._events[u];if(!c)return[];if(c.fn)return[c.fn];for(var d=0,f=c.length,m=new Array(f);d<f;d++)m[d]=c[d].fn;return m},a.prototype.listenerCount=function(l){var u=e?e+l:l,c=this._events[u];return c?c.fn?1:c.length:0},a.prototype.emit=function(l,u,c,d,f,m){var p=e?e+l:l;if(!this._events[p])return!1;var g=this._events[p],y=arguments.length,x,_;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,c),!0;case 4:return g.fn.call(g.context,u,c,d),!0;case 5:return g.fn.call(g.context,u,c,d,f),!0;case 6:return g.fn.call(g.context,u,c,d,f,m),!0}for(_=1,x=new Array(y-1);_<y;_++)x[_-1]=arguments[_];g.fn.apply(g.context,x)}else{var v=g.length,b;for(_=0;_<v;_++)switch(g[_].once&&this.removeListener(l,g[_].fn,void 0,!0),y){case 1:g[_].fn.call(g[_].context);break;case 2:g[_].fn.call(g[_].context,u);break;case 3:g[_].fn.call(g[_].context,u,c);break;case 4:g[_].fn.call(g[_].context,u,c,d);break;default:if(!x)for(b=1,x=new Array(y-1);b<y;b++)x[b-1]=arguments[b];g[_].fn.apply(g[_].context,x)}}return!0},a.prototype.on=function(l,u,c){return n(this,l,u,c,!1)},a.prototype.once=function(l,u,c){return n(this,l,u,c,!0)},a.prototype.removeListener=function(l,u,c,d){var f=e?e+l:l;if(!this._events[f])return this;if(!u)return o(this,f),this;var m=this._events[f];if(m.fn)m.fn===u&&(!d||m.once)&&(!c||m.context===c)&&o(this,f);else{for(var p=0,g=[],y=m.length;p<y;p++)(m[p].fn!==u||d&&!m[p].once||c&&m[p].context!==c)&&g.push(m[p]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=e?e+l:l,this._events[u]&&o(this,u)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,s.exports=a})(vc);var Op=vc.exports;const Ms=yc(Op);var Ch={exports:{}};Ch.exports=Jn;Ch.exports.default=Jn;function Jn(s,t,e){e=e||2;var i=t&&t.length,r=i?t[0]*e:s.length,n=xc(s,0,r,e,!0),o=[];if(!n||n.next===n.prev)return o;var a,h,l,u,c,d,f;if(i&&(n=Up(s,t,n,e)),s.length>80*e){a=l=s[0],h=u=s[1];for(var m=e;m<r;m+=e)c=s[m],d=s[m+1],c<a&&(a=c),d<h&&(h=d),c>l&&(l=c),d>u&&(u=d);f=Math.max(l-a,u-h),f=f!==0?32767/f:0}return ys(n,o,e,a,h,f,0),o}function xc(s,t,e,i,r){var n,o;if(r===fa(s,t,e,i)>0)for(n=t;n<e;n+=i)o=yl(n,s[n],s[n+1],o);else for(n=e-i;n>=t;n-=i)o=yl(n,s[n],s[n+1],o);return o&&to(o,o.next)&&(xs(o),o=o.next),o}function Ki(s,t){if(!s)return s;t||(t=s);var e=s,i;do if(i=!1,!e.steiner&&(to(e,e.next)||pt(e.prev,e,e.next)===0)){if(xs(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function ys(s,t,e,i,r,n,o){if(s){!o&&n&&Xp(s,i,r,n);for(var a=s,h,l;s.prev!==s.next;){if(h=s.prev,l=s.next,n?Lp(s,i,r,n):Bp(s)){t.push(h.i/e|0),t.push(s.i/e|0),t.push(l.i/e|0),xs(s),s=l.next,a=l.next;continue}if(s=l,s===a){o?o===1?(s=kp(Ki(s),t,e),ys(s,t,e,i,r,n,2)):o===2&&Np(s,t,e,i,r,n):ys(Ki(s),t,e,i,r,n,1);break}}}}function Bp(s){var t=s.prev,e=s,i=s.next;if(pt(t,e,i)>=0)return!1;for(var r=t.x,n=e.x,o=i.x,a=t.y,h=e.y,l=i.y,u=r<n?r<o?r:o:n<o?n:o,c=a<h?a<l?a:l:h<l?h:l,d=r>n?r>o?r:o:n>o?n:o,f=a>h?a>l?a:l:h>l?h:l,m=i.next;m!==t;){if(m.x>=u&&m.x<=d&&m.y>=c&&m.y<=f&&yr(r,a,n,h,o,l,m.x,m.y)&&pt(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Lp(s,t,e,i){var r=s.prev,n=s,o=s.next;if(pt(r,n,o)>=0)return!1;for(var a=r.x,h=n.x,l=o.x,u=r.y,c=n.y,d=o.y,f=a<h?a<l?a:l:h<l?h:l,m=u<c?u<d?u:d:c<d?c:d,p=a>h?a>l?a:l:h>l?h:l,g=u>c?u>d?u:d:c>d?c:d,y=ca(f,m,t,e,i),x=ca(p,g,t,e,i),_=s.prevZ,v=s.nextZ;_&&_.z>=y&&v&&v.z<=x;){if(_.x>=f&&_.x<=p&&_.y>=m&&_.y<=g&&_!==r&&_!==o&&yr(a,u,h,c,l,d,_.x,_.y)&&pt(_.prev,_,_.next)>=0||(_=_.prevZ,v.x>=f&&v.x<=p&&v.y>=m&&v.y<=g&&v!==r&&v!==o&&yr(a,u,h,c,l,d,v.x,v.y)&&pt(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;_&&_.z>=y;){if(_.x>=f&&_.x<=p&&_.y>=m&&_.y<=g&&_!==r&&_!==o&&yr(a,u,h,c,l,d,_.x,_.y)&&pt(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;v&&v.z<=x;){if(v.x>=f&&v.x<=p&&v.y>=m&&v.y<=g&&v!==r&&v!==o&&yr(a,u,h,c,l,d,v.x,v.y)&&pt(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function kp(s,t,e){var i=s;do{var r=i.prev,n=i.next.next;!to(r,n)&&bc(r,i,i.next,n)&&vs(r,n)&&vs(n,r)&&(t.push(r.i/e|0),t.push(i.i/e|0),t.push(n.i/e|0),xs(i),xs(i.next),i=s=n),i=i.next}while(i!==s);return Ki(i)}function Np(s,t,e,i,r,n){var o=s;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&jp(o,a)){var h=Tc(o,a);o=Ki(o,o.next),h=Ki(h,h.next),ys(o,t,e,i,r,n,0),ys(h,t,e,i,r,n,0);return}a=a.next}o=o.next}while(o!==s)}function Up(s,t,e,i){var r=[],n,o,a,h,l;for(n=0,o=t.length;n<o;n++)a=t[n]*i,h=n<o-1?t[n+1]*i:s.length,l=xc(s,a,h,i,!1),l===l.next&&(l.steiner=!0),r.push(Wp(l));for(r.sort(Gp),n=0;n<r.length;n++)e=zp(r[n],e);return e}function Gp(s,t){return s.x-t.x}function zp(s,t){var e=Hp(s,t);if(!e)return t;var i=Tc(e,s);return Ki(i,i.next),Ki(e,e.next)}function Hp(s,t){var e=t,i=s.x,r=s.y,n=-1/0,o;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var a=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=i&&a>n&&(n=a,o=e.x<e.next.x?e:e.next,a===i))return o}e=e.next}while(e!==t);if(!o)return null;var h=o,l=o.x,u=o.y,c=1/0,d;e=o;do i>=e.x&&e.x>=l&&i!==e.x&&yr(r<u?i:n,r,l,u,r<u?n:i,r,e.x,e.y)&&(d=Math.abs(r-e.y)/(i-e.x),vs(e,s)&&(d<c||d===c&&(e.x>o.x||e.x===o.x&&$p(o,e)))&&(o=e,c=d)),e=e.next;while(e!==h);return o}function $p(s,t){return pt(s.prev,s,t.prev)<0&&pt(t.next,s,s.next)<0}function Xp(s,t,e,i){var r=s;do r.z===0&&(r.z=ca(r.x,r.y,t,e,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==s);r.prevZ.nextZ=null,r.prevZ=null,Vp(r)}function Vp(s){var t,e,i,r,n,o,a,h,l=1;do{for(e=s,s=null,n=null,o=0;e;){for(o++,i=e,a=0,t=0;t<l&&(a++,i=i.nextZ,!!i);t++);for(h=l;a>0||h>0&&i;)a!==0&&(h===0||!i||e.z<=i.z)?(r=e,e=e.nextZ,a--):(r=i,i=i.nextZ,h--),n?n.nextZ=r:s=r,r.prevZ=n,n=r;e=i}n.nextZ=null,l*=2}while(o>1);return s}function ca(s,t,e,i,r){return s=(s-e)*r|0,t=(t-i)*r|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function Wp(s){var t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function yr(s,t,e,i,r,n,o,a){return(r-o)*(t-a)>=(s-o)*(n-a)&&(s-o)*(i-a)>=(e-o)*(t-a)&&(e-o)*(n-a)>=(r-o)*(i-a)}function jp(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!Yp(s,t)&&(vs(s,t)&&vs(t,s)&&qp(s,t)&&(pt(s.prev,s,t.prev)||pt(s,t.prev,t))||to(s,t)&&pt(s.prev,s,s.next)>0&&pt(t.prev,t,t.next)>0)}function pt(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function to(s,t){return s.x===t.x&&s.y===t.y}function bc(s,t,e,i){var r=Gs(pt(s,t,e)),n=Gs(pt(s,t,i)),o=Gs(pt(e,i,s)),a=Gs(pt(e,i,t));return!!(r!==n&&o!==a||r===0&&Us(s,e,t)||n===0&&Us(s,i,t)||o===0&&Us(e,s,i)||a===0&&Us(e,t,i))}function Us(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function Gs(s){return s>0?1:s<0?-1:0}function Yp(s,t){var e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&bc(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function vs(s,t){return pt(s.prev,s,s.next)<0?pt(s,t,s.next)>=0&&pt(s,s.prev,t)>=0:pt(s,t,s.prev)<0||pt(s,s.next,t)<0}function qp(s,t){var e=s,i=!1,r=(s.x+t.x)/2,n=(s.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&r<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==s);return i}function Tc(s,t){var e=new da(s.i,s.x,s.y),i=new da(t.i,t.x,t.y),r=s.next,n=t.prev;return s.next=t,t.prev=s,e.next=r,r.prev=e,i.next=e,e.prev=i,n.next=i,i.prev=n,i}function yl(s,t,e,i){var r=new da(s,t,e);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function xs(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function da(s,t,e){this.i=s,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Jn.deviation=function(s,t,e,i){var r=t&&t.length,n=r?t[0]*e:s.length,o=Math.abs(fa(s,0,n,e));if(r)for(var a=0,h=t.length;a<h;a++){var l=t[a]*e,u=a<h-1?t[a+1]*e:s.length;o-=Math.abs(fa(s,l,u,e))}var c=0;for(a=0;a<i.length;a+=3){var d=i[a]*e,f=i[a+1]*e,m=i[a+2]*e;c+=Math.abs((s[d]-s[m])*(s[f+1]-s[d+1])-(s[d]-s[f])*(s[m+1]-s[d+1]))}return o===0&&c===0?0:Math.abs((c-o)/o)};function fa(s,t,e,i){for(var r=0,n=t,o=e-i;n<e;n+=i)r+=(s[o]-s[n])*(s[n+1]+s[o+1]),o=n;return r}Jn.flatten=function(s){for(var t=s[0][0].length,e={vertices:[],holes:[],dimensions:t},i=0,r=0;r<s.length;r++){for(var n=0;n<s[r].length;n++)for(var o=0;o<t;o++)e.vertices.push(s[r][n][o]);r>0&&(i+=s[r-1].length,e.holes.push(i))}return e};var Kp=Ch.exports;const Zp=yc(Kp);var Sn={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Sn.exports;(function(s,t){(function(e){var i=t&&!t.nodeType&&t,r=s&&!s.nodeType&&s,n=typeof hs=="object"&&hs;(n.global===n||n.window===n||n.self===n)&&(e=n);var o,a=2147483647,h=36,l=1,u=26,c=38,d=700,f=72,m=128,p="-",g=/^xn--/,y=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},v=h-l,b=Math.floor,S=String.fromCharCode,w;function T(D){throw new RangeError(_[D])}function E(D,F){for(var Y=D.length,it=[];Y--;)it[Y]=F(D[Y]);return it}function I(D,F){var Y=D.split("@"),it="";Y.length>1&&(it=Y[0]+"@",D=Y[1]),D=D.replace(x,".");var Q=D.split("."),ot=E(Q,F).join(".");return it+ot}function z(D){for(var F=[],Y=0,it=D.length,Q,ot;Y<it;)Q=D.charCodeAt(Y++),Q>=55296&&Q<=56319&&Y<it?(ot=D.charCodeAt(Y++),(ot&64512)==56320?F.push(((Q&1023)<<10)+(ot&1023)+65536):(F.push(Q),Y--)):F.push(Q);return F}function R(D){return E(D,function(F){var Y="";return F>65535&&(F-=65536,Y+=S(F>>>10&1023|55296),F=56320|F&1023),Y+=S(F),Y}).join("")}function A(D){return D-48<10?D-22:D-65<26?D-65:D-97<26?D-97:h}function P(D,F){return D+22+75*(D<26)-((F!=0)<<5)}function O(D,F,Y){var it=0;for(D=Y?b(D/d):D>>1,D+=b(D/F);D>v*u>>1;it+=h)D=b(D/v);return b(it+(v+1)*D/(D+c))}function G(D){var F=[],Y=D.length,it,Q=0,ot=m,bt=f,Pt,Ut,Zt,Bt,ut,Tt,Et,xe,be;for(Pt=D.lastIndexOf(p),Pt<0&&(Pt=0),Ut=0;Ut<Pt;++Ut)D.charCodeAt(Ut)>=128&&T("not-basic"),F.push(D.charCodeAt(Ut));for(Zt=Pt>0?Pt+1:0;Zt<Y;){for(Bt=Q,ut=1,Tt=h;Zt>=Y&&T("invalid-input"),Et=A(D.charCodeAt(Zt++)),(Et>=h||Et>b((a-Q)/ut))&&T("overflow"),Q+=Et*ut,xe=Tt<=bt?l:Tt>=bt+u?u:Tt-bt,!(Et<xe);Tt+=h)be=h-xe,ut>b(a/be)&&T("overflow"),ut*=be;it=F.length+1,bt=O(Q-Bt,it,Bt==0),b(Q/it)>a-ot&&T("overflow"),ot+=b(Q/it),Q%=it,F.splice(Q++,0,ot)}return R(F)}function L(D){var F,Y,it,Q,ot,bt,Pt,Ut,Zt,Bt,ut,Tt=[],Et,xe,be,Vr;for(D=z(D),Et=D.length,F=m,Y=0,ot=f,bt=0;bt<Et;++bt)ut=D[bt],ut<128&&Tt.push(S(ut));for(it=Q=Tt.length,Q&&Tt.push(p);it<Et;){for(Pt=a,bt=0;bt<Et;++bt)ut=D[bt],ut>=F&&ut<Pt&&(Pt=ut);for(xe=it+1,Pt-F>b((a-Y)/xe)&&T("overflow"),Y+=(Pt-F)*xe,F=Pt,bt=0;bt<Et;++bt)if(ut=D[bt],ut<F&&++Y>a&&T("overflow"),ut==F){for(Ut=Y,Zt=h;Bt=Zt<=ot?l:Zt>=ot+u?u:Zt-ot,!(Ut<Bt);Zt+=h)Vr=Ut-Bt,be=h-Bt,Tt.push(S(P(Bt+Vr%be,0))),Ut=b(Vr/be);Tt.push(S(P(Ut,0))),ot=O(Y,xe,it==Q),Y=0,++it}++Y,++F}return Tt.join("")}function X(D){return I(D,function(F){return g.test(F)?G(F.slice(4).toLowerCase()):F})}function rt(D){return I(D,function(F){return y.test(F)?"xn--"+L(F):F})}if(o={version:"1.4.1",ucs2:{decode:z,encode:R},decode:G,encode:L,toASCII:rt,toUnicode:X},i&&r)if(s.exports==i)r.exports=o;else for(w in o)o.hasOwnProperty(w)&&(i[w]=o[w]);else e.punycode=o})(hs)})(Sn,Sn.exports);var Qp=Sn.exports,Jp=Error,tm=EvalError,em=RangeError,im=ReferenceError,wc=SyntaxError,Ds=TypeError,rm=URIError,sm=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),i=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var r=42;t[e]=r;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var n=Object.getOwnPropertySymbols(t);if(n.length!==1||n[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,e);if(o.value!==r||o.enumerable!==!0)return!1}return!0},vl=typeof Symbol<"u"&&Symbol,nm=sm,om=function(){return typeof vl!="function"||typeof Symbol!="function"||typeof vl("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:nm()},go={__proto__:null,foo:{}},am=Object,hm=function(){return{__proto__:go}.foo===go.foo&&!(go instanceof am)},lm="Function.prototype.bind called on incompatible ",um=Object.prototype.toString,cm=Math.max,dm="[object Function]",xl=function(t,e){for(var i=[],r=0;r<t.length;r+=1)i[r]=t[r];for(var n=0;n<e.length;n+=1)i[n+t.length]=e[n];return i},fm=function(t,e){for(var i=[],r=e,n=0;r<t.length;r+=1,n+=1)i[n]=t[r];return i},pm=function(s,t){for(var e="",i=0;i<s.length;i+=1)e+=s[i],i+1<s.length&&(e+=t);return e},mm=function(t){var e=this;if(typeof e!="function"||um.apply(e)!==dm)throw new TypeError(lm+e);for(var i=fm(arguments,1),r,n=function(){if(this instanceof r){var u=e.apply(this,xl(i,arguments));return Object(u)===u?u:this}return e.apply(t,xl(i,arguments))},o=cm(0,e.length-i.length),a=[],h=0;h<o;h++)a[h]="$"+h;if(r=Function("binder","return function ("+pm(a,",")+"){ return binder.apply(this,arguments); }")(n),e.prototype){var l=function(){};l.prototype=e.prototype,r.prototype=new l,l.prototype=null}return r},gm=mm,Ph=Function.prototype.bind||gm,_m=Function.prototype.call,ym=Object.prototype.hasOwnProperty,vm=Ph,xm=vm.call(_m,ym),J,bm=Jp,Tm=tm,wm=em,Am=im,Fr=wc,wr=Ds,Em=rm,Ac=Function,_o=function(s){try{return Ac('"use strict"; return ('+s+").constructor;")()}catch{}},Hi=Object.getOwnPropertyDescriptor;if(Hi)try{Hi({},"")}catch{Hi=null}var yo=function(){throw new wr},Sm=Hi?function(){try{return arguments.callee,yo}catch{try{return Hi(arguments,"callee").get}catch{return yo}}}():yo,sr=om(),Cm=hm(),Rt=Object.getPrototypeOf||(Cm?function(s){return s.__proto__}:null),ur={},Pm=typeof Uint8Array>"u"||!Rt?J:Rt(Uint8Array),$i={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?J:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?J:ArrayBuffer,"%ArrayIteratorPrototype%":sr&&Rt?Rt([][Symbol.iterator]()):J,"%AsyncFromSyncIteratorPrototype%":J,"%AsyncFunction%":ur,"%AsyncGenerator%":ur,"%AsyncGeneratorFunction%":ur,"%AsyncIteratorPrototype%":ur,"%Atomics%":typeof Atomics>"u"?J:Atomics,"%BigInt%":typeof BigInt>"u"?J:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?J:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?J:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?J:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":bm,"%eval%":eval,"%EvalError%":Tm,"%Float32Array%":typeof Float32Array>"u"?J:Float32Array,"%Float64Array%":typeof Float64Array>"u"?J:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?J:FinalizationRegistry,"%Function%":Ac,"%GeneratorFunction%":ur,"%Int8Array%":typeof Int8Array>"u"?J:Int8Array,"%Int16Array%":typeof Int16Array>"u"?J:Int16Array,"%Int32Array%":typeof Int32Array>"u"?J:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":sr&&Rt?Rt(Rt([][Symbol.iterator]())):J,"%JSON%":typeof JSON=="object"?JSON:J,"%Map%":typeof Map>"u"?J:Map,"%MapIteratorPrototype%":typeof Map>"u"||!sr||!Rt?J:Rt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?J:Promise,"%Proxy%":typeof Proxy>"u"?J:Proxy,"%RangeError%":wm,"%ReferenceError%":Am,"%Reflect%":typeof Reflect>"u"?J:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?J:Set,"%SetIteratorPrototype%":typeof Set>"u"||!sr||!Rt?J:Rt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?J:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":sr&&Rt?Rt(""[Symbol.iterator]()):J,"%Symbol%":sr?Symbol:J,"%SyntaxError%":Fr,"%ThrowTypeError%":Sm,"%TypedArray%":Pm,"%TypeError%":wr,"%Uint8Array%":typeof Uint8Array>"u"?J:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?J:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?J:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?J:Uint32Array,"%URIError%":Em,"%WeakMap%":typeof WeakMap>"u"?J:WeakMap,"%WeakRef%":typeof WeakRef>"u"?J:WeakRef,"%WeakSet%":typeof WeakSet>"u"?J:WeakSet};if(Rt)try{null.error}catch(s){var Rm=Rt(Rt(s));$i["%Error.prototype%"]=Rm}var Im=function s(t){var e;if(t==="%AsyncFunction%")e=_o("async function () {}");else if(t==="%GeneratorFunction%")e=_o("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=_o("async function* () {}");else if(t==="%AsyncGenerator%"){var i=s("%AsyncGeneratorFunction%");i&&(e=i.prototype)}else if(t==="%AsyncIteratorPrototype%"){var r=s("%AsyncGenerator%");r&&Rt&&(e=Rt(r.prototype))}return $i[t]=e,e},bl={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Fs=Ph,Cn=xm,Mm=Fs.call(Function.call,Array.prototype.concat),Dm=Fs.call(Function.apply,Array.prototype.splice),Tl=Fs.call(Function.call,String.prototype.replace),Pn=Fs.call(Function.call,String.prototype.slice),Fm=Fs.call(Function.call,RegExp.prototype.exec),Om=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Bm=/\\(\\)?/g,Lm=function(t){var e=Pn(t,0,1),i=Pn(t,-1);if(e==="%"&&i!=="%")throw new Fr("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&e!=="%")throw new Fr("invalid intrinsic syntax, expected opening `%`");var r=[];return Tl(t,Om,function(n,o,a,h){r[r.length]=a?Tl(h,Bm,"$1"):o||n}),r},km=function(t,e){var i=t,r;if(Cn(bl,i)&&(r=bl[i],i="%"+r[0]+"%"),Cn($i,i)){var n=$i[i];if(n===ur&&(n=Im(i)),typeof n>"u"&&!e)throw new wr("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:r,name:i,value:n}}throw new Fr("intrinsic "+t+" does not exist!")},Hr=function(t,e){if(typeof t!="string"||t.length===0)throw new wr("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new wr('"allowMissing" argument must be a boolean');if(Fm(/^%?[^%]*%?$/,t)===null)throw new Fr("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=Lm(t),r=i.length>0?i[0]:"",n=km("%"+r+"%",e),o=n.name,a=n.value,h=!1,l=n.alias;l&&(r=l[0],Dm(i,Mm([0,1],l)));for(var u=1,c=!0;u<i.length;u+=1){var d=i[u],f=Pn(d,0,1),m=Pn(d,-1);if((f==='"'||f==="'"||f==="`"||m==='"'||m==="'"||m==="`")&&f!==m)throw new Fr("property names with quotes must have matching quotes");if((d==="constructor"||!c)&&(h=!0),r+="."+d,o="%"+r+"%",Cn($i,o))a=$i[o];else if(a!=null){if(!(d in a)){if(!e)throw new wr("base intrinsic for "+t+" exists, but the property is not available.");return}if(Hi&&u+1>=i.length){var p=Hi(a,d);c=!!p,c&&"get"in p&&!("originalValue"in p.get)?a=p.get:a=a[d]}else c=Cn(a,d),a=a[d];c&&!h&&($i[o]=a)}}return a},Ec={exports:{}},vo,wl;function Rh(){if(wl)return vo;wl=1;var s=Hr,t=s("%Object.defineProperty%",!0)||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return vo=t,vo}var Nm=Hr,cn=Nm("%Object.getOwnPropertyDescriptor%",!0);if(cn)try{cn([],"length")}catch{cn=null}var Sc=cn,Al=Rh(),Um=wc,nr=Ds,El=Sc,Gm=function(t,e,i){if(!t||typeof t!="object"&&typeof t!="function")throw new nr("`obj` must be an object or a function`");if(typeof e!="string"&&typeof e!="symbol")throw new nr("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new nr("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new nr("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new nr("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new nr("`loose`, if provided, must be a boolean");var r=arguments.length>3?arguments[3]:null,n=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,h=!!El&&El(t,e);if(Al)Al(t,e,{configurable:o===null&&h?h.configurable:!o,enumerable:r===null&&h?h.enumerable:!r,value:i,writable:n===null&&h?h.writable:!n});else if(a||!r&&!n&&!o)t[e]=i;else throw new Um("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},pa=Rh(),Cc=function(){return!!pa};Cc.hasArrayLengthDefineBug=function(){if(!pa)return null;try{return pa([],"length",{value:1}).length!==1}catch{return!0}};var zm=Cc,Hm=Hr,Sl=Gm,$m=zm(),Cl=Sc,Pl=Ds,Xm=Hm("%Math.floor%"),Vm=function(t,e){if(typeof t!="function")throw new Pl("`fn` is not a function");if(typeof e!="number"||e<0||e>4294967295||Xm(e)!==e)throw new Pl("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],r=!0,n=!0;if("length"in t&&Cl){var o=Cl(t,"length");o&&!o.configurable&&(r=!1),o&&!o.writable&&(n=!1)}return(r||n||!i)&&($m?Sl(t,"length",e,!0,!0):Sl(t,"length",e)),t};(function(s){var t=Ph,e=Hr,i=Vm,r=Ds,n=e("%Function.prototype.apply%"),o=e("%Function.prototype.call%"),a=e("%Reflect.apply%",!0)||t.call(o,n),h=Rh(),l=e("%Math.max%");s.exports=function(d){if(typeof d!="function")throw new r("a function is required");var f=a(t,o,arguments);return i(f,1+l(0,d.length-(arguments.length-1)),!0)};var u=function(){return a(t,n,arguments)};h?h(s.exports,"apply",{value:u}):s.exports.apply=u})(Ec);var Wm=Ec.exports,Pc=Hr,Rc=Wm,jm=Rc(Pc("String.prototype.indexOf")),Ym=function(t,e){var i=Pc(t,!!e);return typeof i=="function"&&jm(t,".prototype.")>-1?Rc(i):i};const qm={},Km=Object.freeze(Object.defineProperty({__proto__:null,default:qm},Symbol.toStringTag,{value:"Module"})),Zm=Fp(Km);var Ih=typeof Map=="function"&&Map.prototype,xo=Object.getOwnPropertyDescriptor&&Ih?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Rn=Ih&&xo&&typeof xo.get=="function"?xo.get:null,Rl=Ih&&Map.prototype.forEach,Mh=typeof Set=="function"&&Set.prototype,bo=Object.getOwnPropertyDescriptor&&Mh?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,In=Mh&&bo&&typeof bo.get=="function"?bo.get:null,Il=Mh&&Set.prototype.forEach,Qm=typeof WeakMap=="function"&&WeakMap.prototype,ls=Qm?WeakMap.prototype.has:null,Jm=typeof WeakSet=="function"&&WeakSet.prototype,us=Jm?WeakSet.prototype.has:null,tg=typeof WeakRef=="function"&&WeakRef.prototype,Ml=tg?WeakRef.prototype.deref:null,eg=Boolean.prototype.valueOf,ig=Object.prototype.toString,rg=Function.prototype.toString,sg=String.prototype.match,Dh=String.prototype.slice,li=String.prototype.replace,ng=String.prototype.toUpperCase,Dl=String.prototype.toLowerCase,Ic=RegExp.prototype.test,Fl=Array.prototype.concat,Me=Array.prototype.join,og=Array.prototype.slice,Ol=Math.floor,ma=typeof BigInt=="function"?BigInt.prototype.valueOf:null,To=Object.getOwnPropertySymbols,ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Or=typeof Symbol=="function"&&typeof Symbol.iterator=="object",$t=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Or||!0)?Symbol.toStringTag:null,Mc=Object.prototype.propertyIsEnumerable,Bl=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(s){return s.__proto__}:null);function Ll(s,t){if(s===1/0||s===-1/0||s!==s||s&&s>-1e3&&s<1e3||Ic.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof s=="number"){var i=s<0?-Ol(-s):Ol(s);if(i!==s){var r=String(i),n=Dh.call(t,r.length+1);return li.call(r,e,"$&_")+"."+li.call(li.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}}return li.call(t,e,"$&_")}var _a=Zm,kl=_a.custom,Nl=Fc(kl)?kl:null,ag=function s(t,e,i,r){var n=e||{};if(oi(n,"quoteStyle")&&n.quoteStyle!=="single"&&n.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(oi(n,"maxStringLength")&&(typeof n.maxStringLength=="number"?n.maxStringLength<0&&n.maxStringLength!==1/0:n.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=oi(n,"customInspect")?n.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(oi(n,"indent")&&n.indent!==null&&n.indent!=="	"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(oi(n,"numericSeparator")&&typeof n.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=n.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return Bc(t,n);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var h=String(t);return a?Ll(t,h):h}if(typeof t=="bigint"){var l=String(t)+"n";return a?Ll(t,l):l}var u=typeof n.depth>"u"?5:n.depth;if(typeof i>"u"&&(i=0),i>=u&&u>0&&typeof t=="object")return ya(t)?"[Array]":"[Object]";var c=Eg(n,i);if(typeof r>"u")r=[];else if(Oc(r,t)>=0)return"[Circular]";function d(A,P,O){if(P&&(r=og.call(r),r.push(P)),O){var G={depth:n.depth};return oi(n,"quoteStyle")&&(G.quoteStyle=n.quoteStyle),s(A,G,i+1,r)}return s(A,n,i+1,r)}if(typeof t=="function"&&!Ul(t)){var f=gg(t),m=zs(t,d);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(m.length>0?" { "+Me.call(m,", ")+" }":"")}if(Fc(t)){var p=Or?li.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):ga.call(t);return typeof t=="object"&&!Or?Wr(p):p}if(Tg(t)){for(var g="<"+Dl.call(String(t.nodeName)),y=t.attributes||[],x=0;x<y.length;x++)g+=" "+y[x].name+"="+Dc(hg(y[x].value),"double",n);return g+=">",t.childNodes&&t.childNodes.length&&(g+="..."),g+="</"+Dl.call(String(t.nodeName))+">",g}if(ya(t)){if(t.length===0)return"[]";var _=zs(t,d);return c&&!Ag(_)?"["+va(_,c)+"]":"[ "+Me.call(_,", ")+" ]"}if(ug(t)){var v=zs(t,d);return!("cause"in Error.prototype)&&"cause"in t&&!Mc.call(t,"cause")?"{ ["+String(t)+"] "+Me.call(Fl.call("[cause]: "+d(t.cause),v),", ")+" }":v.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+Me.call(v,", ")+" }"}if(typeof t=="object"&&o){if(Nl&&typeof t[Nl]=="function"&&_a)return _a(t,{depth:u-i});if(o!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(_g(t)){var b=[];return Rl&&Rl.call(t,function(A,P){b.push(d(P,t,!0)+" => "+d(A,t))}),Gl("Map",Rn.call(t),b,c)}if(xg(t)){var S=[];return Il&&Il.call(t,function(A){S.push(d(A,t))}),Gl("Set",In.call(t),S,c)}if(yg(t))return wo("WeakMap");if(bg(t))return wo("WeakSet");if(vg(t))return wo("WeakRef");if(dg(t))return Wr(d(Number(t)));if(pg(t))return Wr(d(ma.call(t)));if(fg(t))return Wr(eg.call(t));if(cg(t))return Wr(d(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(typeof globalThis<"u"&&t===globalThis||typeof hs<"u"&&t===hs)return"{ [object globalThis] }";if(!lg(t)&&!Ul(t)){var w=zs(t,d),T=Bl?Bl(t)===Object.prototype:t instanceof Object||t.constructor===Object,E=t instanceof Object?"":"null prototype",I=!T&&$t&&Object(t)===t&&$t in t?Dh.call(wi(t),8,-1):E?"Object":"",z=T||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",R=z+(I||E?"["+Me.call(Fl.call([],I||[],E||[]),": ")+"] ":"");return w.length===0?R+"{}":c?R+"{"+va(w,c)+"}":R+"{ "+Me.call(w,", ")+" }"}return String(t)};function Dc(s,t,e){var i=(e.quoteStyle||t)==="double"?'"':"'";return i+s+i}function hg(s){return li.call(String(s),/"/g,"&quot;")}function ya(s){return wi(s)==="[object Array]"&&(!$t||!(typeof s=="object"&&$t in s))}function lg(s){return wi(s)==="[object Date]"&&(!$t||!(typeof s=="object"&&$t in s))}function Ul(s){return wi(s)==="[object RegExp]"&&(!$t||!(typeof s=="object"&&$t in s))}function ug(s){return wi(s)==="[object Error]"&&(!$t||!(typeof s=="object"&&$t in s))}function cg(s){return wi(s)==="[object String]"&&(!$t||!(typeof s=="object"&&$t in s))}function dg(s){return wi(s)==="[object Number]"&&(!$t||!(typeof s=="object"&&$t in s))}function fg(s){return wi(s)==="[object Boolean]"&&(!$t||!(typeof s=="object"&&$t in s))}function Fc(s){if(Or)return s&&typeof s=="object"&&s instanceof Symbol;if(typeof s=="symbol")return!0;if(!s||typeof s!="object"||!ga)return!1;try{return ga.call(s),!0}catch{}return!1}function pg(s){if(!s||typeof s!="object"||!ma)return!1;try{return ma.call(s),!0}catch{}return!1}var mg=Object.prototype.hasOwnProperty||function(s){return s in this};function oi(s,t){return mg.call(s,t)}function wi(s){return ig.call(s)}function gg(s){if(s.name)return s.name;var t=sg.call(rg.call(s),/^function\s*([\w$]+)/);return t?t[1]:null}function Oc(s,t){if(s.indexOf)return s.indexOf(t);for(var e=0,i=s.length;e<i;e++)if(s[e]===t)return e;return-1}function _g(s){if(!Rn||!s||typeof s!="object")return!1;try{Rn.call(s);try{In.call(s)}catch{return!0}return s instanceof Map}catch{}return!1}function yg(s){if(!ls||!s||typeof s!="object")return!1;try{ls.call(s,ls);try{us.call(s,us)}catch{return!0}return s instanceof WeakMap}catch{}return!1}function vg(s){if(!Ml||!s||typeof s!="object")return!1;try{return Ml.call(s),!0}catch{}return!1}function xg(s){if(!In||!s||typeof s!="object")return!1;try{In.call(s);try{Rn.call(s)}catch{return!0}return s instanceof Set}catch{}return!1}function bg(s){if(!us||!s||typeof s!="object")return!1;try{us.call(s,us);try{ls.call(s,ls)}catch{return!0}return s instanceof WeakSet}catch{}return!1}function Tg(s){return!s||typeof s!="object"?!1:typeof HTMLElement<"u"&&s instanceof HTMLElement?!0:typeof s.nodeName=="string"&&typeof s.getAttribute=="function"}function Bc(s,t){if(s.length>t.maxStringLength){var e=s.length-t.maxStringLength,i="... "+e+" more character"+(e>1?"s":"");return Bc(Dh.call(s,0,t.maxStringLength),t)+i}var r=li.call(li.call(s,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,wg);return Dc(r,"single",t)}function wg(s){var t=s.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+ng.call(t.toString(16))}function Wr(s){return"Object("+s+")"}function wo(s){return s+" { ? }"}function Gl(s,t,e,i){var r=i?va(e,i):Me.call(e,", ");return s+" ("+t+") {"+r+"}"}function Ag(s){for(var t=0;t<s.length;t++)if(Oc(s[t],`
`)>=0)return!1;return!0}function Eg(s,t){var e;if(s.indent==="	")e="	";else if(typeof s.indent=="number"&&s.indent>0)e=Me.call(Array(s.indent+1)," ");else return null;return{base:e,prev:Me.call(Array(t+1),e)}}function va(s,t){if(s.length===0)return"";var e=`
`+t.prev+t.base;return e+Me.call(s,","+e)+`
`+t.prev}function zs(s,t){var e=ya(s),i=[];if(e){i.length=s.length;for(var r=0;r<s.length;r++)i[r]=oi(s,r)?t(s[r],s):""}var n=typeof To=="function"?To(s):[],o;if(Or){o={};for(var a=0;a<n.length;a++)o["$"+n[a]]=n[a]}for(var h in s)oi(s,h)&&(e&&String(Number(h))===h&&h<s.length||Or&&o["$"+h]instanceof Symbol||(Ic.call(/[^\w$]/,h)?i.push(t(h,s)+": "+t(s[h],s)):i.push(h+": "+t(s[h],s))));if(typeof To=="function")for(var l=0;l<n.length;l++)Mc.call(s,n[l])&&i.push("["+t(n[l])+"]: "+t(s[n[l]],s));return i}var Lc=Hr,$r=Ym,Sg=ag,Cg=Ds,Hs=Lc("%WeakMap%",!0),$s=Lc("%Map%",!0),Pg=$r("WeakMap.prototype.get",!0),Rg=$r("WeakMap.prototype.set",!0),Ig=$r("WeakMap.prototype.has",!0),Mg=$r("Map.prototype.get",!0),Dg=$r("Map.prototype.set",!0),Fg=$r("Map.prototype.has",!0),Fh=function(s,t){for(var e=s,i;(i=e.next)!==null;e=i)if(i.key===t)return e.next=i.next,i.next=s.next,s.next=i,i},Og=function(s,t){var e=Fh(s,t);return e&&e.value},Bg=function(s,t,e){var i=Fh(s,t);i?i.value=e:s.next={key:t,next:s.next,value:e}},Lg=function(s,t){return!!Fh(s,t)},kg=function(){var t,e,i,r={assert:function(n){if(!r.has(n))throw new Cg("Side channel does not contain "+Sg(n))},get:function(n){if(Hs&&n&&(typeof n=="object"||typeof n=="function")){if(t)return Pg(t,n)}else if($s){if(e)return Mg(e,n)}else if(i)return Og(i,n)},has:function(n){if(Hs&&n&&(typeof n=="object"||typeof n=="function")){if(t)return Ig(t,n)}else if($s){if(e)return Fg(e,n)}else if(i)return Lg(i,n);return!1},set:function(n,o){Hs&&n&&(typeof n=="object"||typeof n=="function")?(t||(t=new Hs),Rg(t,n,o)):$s?(e||(e=new $s),Dg(e,n,o)):(i||(i={key:{},next:null}),Bg(i,n,o))}};return r},Ng=String.prototype.replace,Ug=/%20/g,Ao={RFC1738:"RFC1738",RFC3986:"RFC3986"},Oh={default:Ao.RFC3986,formatters:{RFC1738:function(s){return Ng.call(s,Ug,"+")},RFC3986:function(s){return String(s)}},RFC1738:Ao.RFC1738,RFC3986:Ao.RFC3986},Gg=Oh,Eo=Object.prototype.hasOwnProperty,ki=Array.isArray,Te=function(){for(var s=[],t=0;t<256;++t)s.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return s}(),zg=function(t){for(;t.length>1;){var e=t.pop(),i=e.obj[e.prop];if(ki(i)){for(var r=[],n=0;n<i.length;++n)typeof i[n]<"u"&&r.push(i[n]);e.obj[e.prop]=r}}},kc=function(t,e){for(var i=e&&e.plainObjects?Object.create(null):{},r=0;r<t.length;++r)typeof t[r]<"u"&&(i[r]=t[r]);return i},Hg=function s(t,e,i){if(!e)return t;if(typeof e!="object"){if(ki(t))t.push(e);else if(t&&typeof t=="object")(i&&(i.plainObjects||i.allowPrototypes)||!Eo.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object")return[t].concat(e);var r=t;return ki(t)&&!ki(e)&&(r=kc(t,i)),ki(t)&&ki(e)?(e.forEach(function(n,o){if(Eo.call(t,o)){var a=t[o];a&&typeof a=="object"&&n&&typeof n=="object"?t[o]=s(a,n,i):t.push(n)}else t[o]=n}),t):Object.keys(e).reduce(function(n,o){var a=e[o];return Eo.call(n,o)?n[o]=s(n[o],a,i):n[o]=a,n},r)},$g=function(t,e){return Object.keys(e).reduce(function(i,r){return i[r]=e[r],i},t)},Xg=function(s,t,e){var i=s.replace(/\+/g," ");if(e==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},So=1024,Vg=function(t,e,i,r,n){if(t.length===0)return t;var o=t;if(typeof t=="symbol"?o=Symbol.prototype.toString.call(t):typeof t!="string"&&(o=String(t)),i==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var a="",h=0;h<o.length;h+=So){for(var l=o.length>=So?o.slice(h,h+So):o,u=[],c=0;c<l.length;++c){var d=l.charCodeAt(c);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||n===Gg.RFC1738&&(d===40||d===41)){u[u.length]=l.charAt(c);continue}if(d<128){u[u.length]=Te[d];continue}if(d<2048){u[u.length]=Te[192|d>>6]+Te[128|d&63];continue}if(d<55296||d>=57344){u[u.length]=Te[224|d>>12]+Te[128|d>>6&63]+Te[128|d&63];continue}c+=1,d=65536+((d&1023)<<10|l.charCodeAt(c)&1023),u[u.length]=Te[240|d>>18]+Te[128|d>>12&63]+Te[128|d>>6&63]+Te[128|d&63]}a+=u.join("")}return a},Wg=function(t){for(var e=[{obj:{o:t},prop:"o"}],i=[],r=0;r<e.length;++r)for(var n=e[r],o=n.obj[n.prop],a=Object.keys(o),h=0;h<a.length;++h){var l=a[h],u=o[l];typeof u=="object"&&u!==null&&i.indexOf(u)===-1&&(e.push({obj:o,prop:l}),i.push(u))}return zg(e),t},jg=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},Yg=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},qg=function(t,e){return[].concat(t,e)},Kg=function(t,e){if(ki(t)){for(var i=[],r=0;r<t.length;r+=1)i.push(e(t[r]));return i}return e(t)},Nc={arrayToObject:kc,assign:$g,combine:qg,compact:Wg,decode:Xg,encode:Vg,isBuffer:Yg,isRegExp:jg,maybeMap:Kg,merge:Hg},Uc=kg,dn=Nc,cs=Oh,Zg=Object.prototype.hasOwnProperty,Gc={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},Pe=Array.isArray,Qg=Array.prototype.push,zc=function(s,t){Qg.apply(s,Pe(t)?t:[t])},Jg=Date.prototype.toISOString,zl=cs.default,St={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:dn.encode,encodeValuesOnly:!1,format:zl,formatter:cs.formatters[zl],indices:!1,serializeDate:function(t){return Jg.call(t)},skipNulls:!1,strictNullHandling:!1},t_=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},Co={},e_=function s(t,e,i,r,n,o,a,h,l,u,c,d,f,m,p,g,y,x){for(var _=t,v=x,b=0,S=!1;(v=v.get(Co))!==void 0&&!S;){var w=v.get(t);if(b+=1,typeof w<"u"){if(w===b)throw new RangeError("Cyclic object value");S=!0}typeof v.get(Co)>"u"&&(b=0)}if(typeof u=="function"?_=u(e,_):_ instanceof Date?_=f(_):i==="comma"&&Pe(_)&&(_=dn.maybeMap(_,function(D){return D instanceof Date?f(D):D})),_===null){if(o)return l&&!g?l(e,St.encoder,y,"key",m):e;_=""}if(t_(_)||dn.isBuffer(_)){if(l){var T=g?e:l(e,St.encoder,y,"key",m);return[p(T)+"="+p(l(_,St.encoder,y,"value",m))]}return[p(e)+"="+p(String(_))]}var E=[];if(typeof _>"u")return E;var I;if(i==="comma"&&Pe(_))g&&l&&(_=dn.maybeMap(_,l)),I=[{value:_.length>0?_.join(",")||null:void 0}];else if(Pe(u))I=u;else{var z=Object.keys(_);I=c?z.sort(c):z}var R=h?e.replace(/\./g,"%2E"):e,A=r&&Pe(_)&&_.length===1?R+"[]":R;if(n&&Pe(_)&&_.length===0)return A+"[]";for(var P=0;P<I.length;++P){var O=I[P],G=typeof O=="object"&&typeof O.value<"u"?O.value:_[O];if(!(a&&G===null)){var L=d&&h?O.replace(/\./g,"%2E"):O,X=Pe(_)?typeof i=="function"?i(A,L):A:A+(d?"."+L:"["+L+"]");x.set(t,b);var rt=Uc();rt.set(Co,x),zc(E,s(G,X,i,r,n,o,a,h,i==="comma"&&g&&Pe(_)?null:l,u,c,d,f,m,p,g,y,rt))}}return E},i_=function(t){if(!t)return St;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||St.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=cs.default;if(typeof t.format<"u"){if(!Zg.call(cs.formatters,t.format))throw new TypeError("Unknown format option provided.");i=t.format}var r=cs.formatters[i],n=St.filter;(typeof t.filter=="function"||Pe(t.filter))&&(n=t.filter);var o;if(t.arrayFormat in Gc?o=t.arrayFormat:"indices"in t?o=t.indices?"indices":"repeat":o=St.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof t.allowDots>"u"?t.encodeDotInKeys===!0?!0:St.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:St.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:St.allowEmptyArrays,arrayFormat:o,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:St.charsetSentinel,commaRoundTrip:t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?St.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:St.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:St.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:St.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:St.encodeValuesOnly,filter:n,format:i,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:St.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:St.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:St.strictNullHandling}},r_=function(s,t){var e=s,i=i_(t),r,n;typeof i.filter=="function"?(n=i.filter,e=n("",e)):Pe(i.filter)&&(n=i.filter,r=n);var o=[];if(typeof e!="object"||e===null)return"";var a=Gc[i.arrayFormat],h=a==="comma"&&i.commaRoundTrip;r||(r=Object.keys(e)),i.sort&&r.sort(i.sort);for(var l=Uc(),u=0;u<r.length;++u){var c=r[u];i.skipNulls&&e[c]===null||zc(o,e_(e[c],c,a,h,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,l))}var d=o.join(i.delimiter),f=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),d.length>0?f+d:""},Br=Nc,xa=Object.prototype.hasOwnProperty,s_=Array.isArray,_t={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Br.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1},n_=function(s){return s.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},Hc=function(s,t){return s&&typeof s=="string"&&t.comma&&s.indexOf(",")>-1?s.split(","):s},o_="utf8=%26%2310003%3B",a_="utf8=%E2%9C%93",h_=function(t,e){var i={__proto__:null},r=e.ignoreQueryPrefix?t.replace(/^\?/,""):t;r=r.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var n=e.parameterLimit===1/0?void 0:e.parameterLimit,o=r.split(e.delimiter,n),a=-1,h,l=e.charset;if(e.charsetSentinel)for(h=0;h<o.length;++h)o[h].indexOf("utf8=")===0&&(o[h]===a_?l="utf-8":o[h]===o_&&(l="iso-8859-1"),a=h,h=o.length);for(h=0;h<o.length;++h)if(h!==a){var u=o[h],c=u.indexOf("]="),d=c===-1?u.indexOf("="):c+1,f,m;d===-1?(f=e.decoder(u,_t.decoder,l,"key"),m=e.strictNullHandling?null:""):(f=e.decoder(u.slice(0,d),_t.decoder,l,"key"),m=Br.maybeMap(Hc(u.slice(d+1),e),function(g){return e.decoder(g,_t.decoder,l,"value")})),m&&e.interpretNumericEntities&&l==="iso-8859-1"&&(m=n_(m)),u.indexOf("[]=")>-1&&(m=s_(m)?[m]:m);var p=xa.call(i,f);p&&e.duplicates==="combine"?i[f]=Br.combine(i[f],m):(!p||e.duplicates==="last")&&(i[f]=m)}return i},l_=function(s,t,e,i){for(var r=i?t:Hc(t,e),n=s.length-1;n>=0;--n){var o,a=s[n];if(a==="[]"&&e.parseArrays)o=e.allowEmptyArrays&&(r===""||e.strictNullHandling&&r===null)?[]:[].concat(r);else{o=e.plainObjects?Object.create(null):{};var h=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,l=e.decodeDotInKeys?h.replace(/%2E/g,"."):h,u=parseInt(l,10);!e.parseArrays&&l===""?o={0:r}:!isNaN(u)&&a!==l&&String(u)===l&&u>=0&&e.parseArrays&&u<=e.arrayLimit?(o=[],o[u]=r):l!=="__proto__"&&(o[l]=r)}r=o}return r},u_=function(t,e,i,r){if(t){var n=i.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,h=i.depth>0&&o.exec(n),l=h?n.slice(0,h.index):n,u=[];if(l){if(!i.plainObjects&&xa.call(Object.prototype,l)&&!i.allowPrototypes)return;u.push(l)}for(var c=0;i.depth>0&&(h=a.exec(n))!==null&&c<i.depth;){if(c+=1,!i.plainObjects&&xa.call(Object.prototype,h[1].slice(1,-1))&&!i.allowPrototypes)return;u.push(h[1])}if(h){if(i.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+i.depth+" and strictDepth is true");u.push("["+n.slice(h.index)+"]")}return l_(u,e,i,r)}},c_=function(t){if(!t)return _t;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.decodeDotInKeys<"u"&&typeof t.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(t.decoder!==null&&typeof t.decoder<"u"&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=typeof t.charset>"u"?_t.charset:t.charset,i=typeof t.duplicates>"u"?_t.duplicates:t.duplicates;if(i!=="combine"&&i!=="first"&&i!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var r=typeof t.allowDots>"u"?t.decodeDotInKeys===!0?!0:_t.allowDots:!!t.allowDots;return{allowDots:r,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:_t.allowEmptyArrays,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:_t.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:_t.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:_t.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:_t.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:_t.comma,decodeDotInKeys:typeof t.decodeDotInKeys=="boolean"?t.decodeDotInKeys:_t.decodeDotInKeys,decoder:typeof t.decoder=="function"?t.decoder:_t.decoder,delimiter:typeof t.delimiter=="string"||Br.isRegExp(t.delimiter)?t.delimiter:_t.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:_t.depth,duplicates:i,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:_t.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:_t.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:_t.plainObjects,strictDepth:typeof t.strictDepth=="boolean"?!!t.strictDepth:_t.strictDepth,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:_t.strictNullHandling}},d_=function(s,t){var e=c_(t);if(s===""||s===null||typeof s>"u")return e.plainObjects?Object.create(null):{};for(var i=typeof s=="string"?h_(s,e):s,r=e.plainObjects?Object.create(null):{},n=Object.keys(i),o=0;o<n.length;++o){var a=n[o],h=u_(a,i[a],e,typeof s=="string");r=Br.merge(r,h,e)}return e.allowSparse===!0?r:Br.compact(r)},f_=r_,p_=d_,m_=Oh,g_={formats:m_,parse:p_,stringify:f_},__=Qp;function Ze(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var y_=/^([a-z0-9.+-]+:)/i,v_=/:[0-9]*$/,x_=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,b_=["<",">",'"',"`"," ","\r",`
`,"	"],T_=["{","}","|","\\","^","`"].concat(b_),ba=["'"].concat(T_),Hl=["%","/","?",";","#"].concat(ba),$l=["/","?","#"],w_=255,Xl=/^[+a-z0-9A-Z_-]{0,63}$/,A_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,E_={javascript:!0,"javascript:":!0},Ta={javascript:!0,"javascript:":!0},Ar={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},wa=g_;function S_(s,t,e){if(s&&typeof s=="object"&&s instanceof Ze)return s;var i=new Ze;return i.parse(s,t,e),i}Ze.prototype.parse=function(s,t,e){if(typeof s!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof s);var i=s.indexOf("?"),r=i!==-1&&i<s.indexOf("#")?"?":"#",n=s.split(r),o=/\\/g;n[0]=n[0].replace(o,"/"),s=n.join(r);var a=s;if(a=a.trim(),!e&&s.split("#").length===1){var h=x_.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],t?this.query=wa.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=y_.exec(a);if(l){l=l[0];var u=l.toLowerCase();this.protocol=u,a=a.substr(l.length)}if(e||l||a.match(/^\/\/[^@/]+@[^@/]+/)){var c=a.substr(0,2)==="//";c&&!(l&&Ta[l])&&(a=a.substr(2),this.slashes=!0)}if(!Ta[l]&&(c||l&&!Ar[l])){for(var d=-1,f=0;f<$l.length;f++){var m=a.indexOf($l[f]);m!==-1&&(d===-1||m<d)&&(d=m)}var p,g;d===-1?g=a.lastIndexOf("@"):g=a.lastIndexOf("@",d),g!==-1&&(p=a.slice(0,g),a=a.slice(g+1),this.auth=decodeURIComponent(p)),d=-1;for(var f=0;f<Hl.length;f++){var m=a.indexOf(Hl[f]);m!==-1&&(d===-1||m<d)&&(d=m)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var x=this.hostname.split(/\./),f=0,_=x.length;f<_;f++){var v=x[f];if(v&&!v.match(Xl)){for(var b="",S=0,w=v.length;S<w;S++)v.charCodeAt(S)>127?b+="x":b+=v[S];if(!b.match(Xl)){var T=x.slice(0,f),E=x.slice(f+1),I=v.match(A_);I&&(T.push(I[1]),E.unshift(I[2])),E.length&&(a="/"+E.join(".")+a),this.hostname=T.join(".");break}}}this.hostname.length>w_?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=__.toASCII(this.hostname));var z=this.port?":"+this.port:"",R=this.hostname||"";this.host=R+z,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!E_[u])for(var f=0,_=ba.length;f<_;f++){var A=ba[f];if(a.indexOf(A)!==-1){var P=encodeURIComponent(A);P===A&&(P=escape(A)),a=a.split(A).join(P)}}var O=a.indexOf("#");O!==-1&&(this.hash=a.substr(O),a=a.slice(0,O));var G=a.indexOf("?");if(G!==-1?(this.search=a.substr(G),this.query=a.substr(G+1),t&&(this.query=wa.parse(this.query)),a=a.slice(0,G)):t&&(this.search="",this.query={}),a&&(this.pathname=a),Ar[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var z=this.pathname||"",L=this.search||"";this.path=z+L}return this.href=this.format(),this};Ze.prototype.format=function(){var s=this.auth||"";s&&(s=encodeURIComponent(s),s=s.replace(/%3A/i,":"),s+="@");var t=this.protocol||"",e=this.pathname||"",i=this.hash||"",r=!1,n="";this.host?r=s+this.host:this.hostname&&(r=s+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(n=wa.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Ar[t])&&r!==!1?(r="//"+(r||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):r||(r=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),e=e.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+r+e+o+i};Ze.prototype.resolve=function(s){return this.resolveObject(S_(s,!1,!0)).format()};Ze.prototype.resolveObject=function(s){if(typeof s=="string"){var t=new Ze;t.parse(s,!1,!0),s=t}for(var e=new Ze,i=Object.keys(this),r=0;r<i.length;r++){var n=i[r];e[n]=this[n]}if(e.hash=s.hash,s.href==="")return e.href=e.format(),e;if(s.slashes&&!s.protocol){for(var o=Object.keys(s),a=0;a<o.length;a++){var h=o[a];h!=="protocol"&&(e[h]=s[h])}return Ar[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname),e.href=e.format(),e}if(s.protocol&&s.protocol!==e.protocol){if(!Ar[s.protocol]){for(var l=Object.keys(s),u=0;u<l.length;u++){var c=l[u];e[c]=s[c]}return e.href=e.format(),e}if(e.protocol=s.protocol,!s.host&&!Ta[s.protocol]){for(var _=(s.pathname||"").split("/");_.length&&!(s.host=_.shift()););s.host||(s.host=""),s.hostname||(s.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),e.pathname=_.join("/")}else e.pathname=s.pathname;if(e.search=s.search,e.query=s.query,e.host=s.host||"",e.auth=s.auth,e.hostname=s.hostname||s.host,e.port=s.port,e.pathname||e.search){var d=e.pathname||"",f=e.search||"";e.path=d+f}return e.slashes=e.slashes||s.slashes,e.href=e.format(),e}var m=e.pathname&&e.pathname.charAt(0)==="/",p=s.host||s.pathname&&s.pathname.charAt(0)==="/",g=p||m||e.host&&s.pathname,y=g,x=e.pathname&&e.pathname.split("/")||[],_=s.pathname&&s.pathname.split("/")||[],v=e.protocol&&!Ar[e.protocol];if(v&&(e.hostname="",e.port=null,e.host&&(x[0]===""?x[0]=e.host:x.unshift(e.host)),e.host="",s.protocol&&(s.hostname=null,s.port=null,s.host&&(_[0]===""?_[0]=s.host:_.unshift(s.host)),s.host=null),g=g&&(_[0]===""||x[0]==="")),p)e.host=s.host||s.host===""?s.host:e.host,e.hostname=s.hostname||s.hostname===""?s.hostname:e.hostname,e.search=s.search,e.query=s.query,x=_;else if(_.length)x||(x=[]),x.pop(),x=x.concat(_),e.search=s.search,e.query=s.query;else if(s.search!=null){if(v){e.host=x.shift(),e.hostname=e.host;var b=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;b&&(e.auth=b.shift(),e.hostname=b.shift(),e.host=e.hostname)}return e.search=s.search,e.query=s.query,(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!x.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var S=x.slice(-1)[0],w=(e.host||s.host||x.length>1)&&(S==="."||S==="..")||S==="",T=0,E=x.length;E>=0;E--)S=x[E],S==="."?x.splice(E,1):S===".."?(x.splice(E,1),T++):T&&(x.splice(E,1),T--);if(!g&&!y)for(;T--;T)x.unshift("..");g&&x[0]!==""&&(!x[0]||x[0].charAt(0)!=="/")&&x.unshift(""),w&&x.join("/").substr(-1)!=="/"&&x.push("");var I=x[0]===""||x[0]&&x[0].charAt(0)==="/";if(v){e.hostname=I?"":x.length?x.shift():"",e.host=e.hostname;var b=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;b&&(e.auth=b.shift(),e.hostname=b.shift(),e.host=e.hostname)}return g=g||e.host&&x.length,g&&!I&&x.unshift(""),x.length>0?e.pathname=x.join("/"):(e.pathname=null,e.path=null),(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=s.auth||e.auth,e.slashes=e.slashes||s.slashes,e.href=e.format(),e};Ze.prototype.parseHost=function(){var s=this.host,t=v_.exec(s);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),s=s.substr(0,s.length-t.length)),s&&(this.hostname=s)};const Vl={};function Z(s,t,e=3){if(Vl[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(i))),Vl[t]=!0}function ce(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function jr(s){return s.split("?")[0].split("#")[0]}function C_(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function P_(s,t,e){return s.replace(new RegExp(C_(t),"g"),e)}function R_(s,t){let e="",i=0,r=-1,n=0,o=-1;for(let a=0;a<=s.length;++a){if(a<s.length)o=s.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",i=0):(e=e.slice(0,h),i=e.length-1-e.lastIndexOf("/")),r=a,n=0;continue}}else if(e.length===2||e.length===1){e="",i=0,r=a,n=0;continue}}}else e.length>0?e+=`/${s.slice(r+1,a)}`:e=s.slice(r+1,a),i=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const Ft={toPosix(s){return P_(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){ce(s),s=this.toPosix(s);const t=/^file:\/\/\//.exec(s);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(s);return e?e[0]:""},toAbsolute(s,t,e){if(ce(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const i=jr(this.toPosix(t??k.ADAPTER.getBaseUrl())),r=jr(this.toPosix(e??this.rootname(i)));return s=this.toPosix(s),s.startsWith("/")?Ft.join(r,s.slice(1)):this.isAbsolute(s)?s:this.join(i,s)},normalize(s){if(ce(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const i=s.endsWith("/");return s=R_(s),s.length>0&&i&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return ce(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const i=s[e];if(ce(i),i.length>0)if(t===void 0)t=i;else{const r=s[e-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(ce(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let i=-1,r=!0;const n=this.getProtocol(s),o=s;s=s.slice(n.length);for(let a=s.length-1;a>=1;--a)if(t=s.charCodeAt(a),t===47){if(!r){i=a;break}}else r=!1;return i===-1?e?"/":this.isUrl(o)?n+s:n:e&&i===1?"//":n+s.slice(0,i)},rootname(s){ce(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){ce(s),t&&ce(t),s=jr(this.toPosix(s));let e=0,i=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let o=t.length-1,a=-1;for(n=s.length-1;n>=0;--n){const h=s.charCodeAt(n);if(h===47){if(!r){e=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(i=n):(o=-1,i=a))}return e===i?i=a:i===-1&&(i=s.length),s.slice(e,i)}for(n=s.length-1;n>=0;--n)if(s.charCodeAt(n)===47){if(!r){e=n+1;break}}else i===-1&&(r=!1,i=n+1);return i===-1?"":s.slice(e,i)},extname(s){ce(s),s=jr(this.toPosix(s));let t=-1,e=0,i=-1,r=!0,n=0;for(let o=s.length-1;o>=0;--o){const a=s.charCodeAt(o);if(a===47){if(!r){e=o+1;break}continue}i===-1&&(r=!1,i=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===e+1?"":s.slice(t,i)},parse(s){ce(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=jr(this.toPosix(s));let e=s.charCodeAt(0);const i=this.isAbsolute(s);let r;t.root=this.rootname(s),i||this.hasProtocol(s)?r=1:r=0;let n=-1,o=0,a=-1,h=!0,l=s.length-1,u=0;for(;l>=r;--l){if(e=s.charCodeAt(l),e===47){if(!h){o=l+1;break}continue}a===-1&&(h=!1,a=l+1),e===46?n===-1?n=l:u!==1&&(u=1):n!==-1&&(u=-1)}return n===-1||a===-1||u===0||u===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&i?t.base=t.name=s.slice(1,a):t.base=t.name=s.slice(o,a)):(o===0&&i?(t.name=s.slice(1,n),t.base=s.slice(1,a)):(t.name=s.slice(o,n),t.base=s.slice(o,a)),t.ext=s.slice(n,a)),t.dir=this.dirname(s),t},sep:"/",delimiter:":",joinExtensions:[".html"]};let Po;async function I_(){return Po??(Po=(async()=>{var n;const s=document.createElement("canvas").getContext("webgl");if(!s)return Vt.UNPACK;const t=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!t)return Vt.UNPACK;const e=s.createTexture();s.bindTexture(s.TEXTURE_2D,e);const i=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,i),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.NONE),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,t);const r=new Uint8Array(4);return s.readPixels(0,0,1,1,s.RGBA,s.UNSIGNED_BYTE,r),s.deleteFramebuffer(i),s.deleteTexture(e),(n=s.getExtension("WEBGL_lose_context"))==null||n.loseContext(),r[0]<=r[3]?Vt.PMA:Vt.UNPACK})()),Po}let Ro;function M_(){return typeof Ro>"u"&&(Ro=function(){var t;const s={stencil:!0,failIfMajorPerformanceCaveat:k.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!k.ADAPTER.getWebGLRenderingContext())return!1;const e=k.ADAPTER.createCanvas();let i=e.getContext("webgl",s)||e.getContext("experimental-webgl",s);const r=!!((t=i==null?void 0:i.getContextAttributes())!=null&&t.stencil);if(i){const n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,r}catch{return!1}}()),Ro}var D_={grad:.9,turn:360,rad:360/(2*Math.PI)},Xe=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},It=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},ae=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},$c=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},Wl=function(s){return{r:ae(s.r,0,255),g:ae(s.g,0,255),b:ae(s.b,0,255),a:ae(s.a)}},Io=function(s){return{r:It(s.r),g:It(s.g),b:It(s.b),a:It(s.a,3)}},F_=/^#([0-9a-f]{3,8})$/i,Xs=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},Xc=function(s){var t=s.r,e=s.g,i=s.b,r=s.a,n=Math.max(t,e,i),o=n-Math.min(t,e,i),a=o?n===t?(e-i)/o:n===e?2+(i-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:r}},Vc=function(s){var t=s.h,e=s.s,i=s.v,r=s.a;t=t/360*6,e/=100,i/=100;var n=Math.floor(t),o=i*(1-e),a=i*(1-(t-n)*e),h=i*(1-(1-t+n)*e),l=n%6;return{r:255*[i,a,o,o,h,i][l],g:255*[h,i,i,a,o,o][l],b:255*[o,o,h,i,i,a][l],a:r}},jl=function(s){return{h:$c(s.h),s:ae(s.s,0,100),l:ae(s.l,0,100),a:ae(s.a)}},Yl=function(s){return{h:It(s.h),s:It(s.s),l:It(s.l),a:It(s.a,3)}},ql=function(s){return Vc((e=(t=s).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},ds=function(s){return{h:(t=Xc(s)).h,s:(r=(200-(e=t.s))*(i=t.v)/100)>0&&r<200?e*i/100/(r<=100?r:200-r)*100:0,l:r/2,a:t.a};var t,e,i,r},O_=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,B_=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,L_=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,k_=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Aa={string:[[function(s){var t=F_.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?It(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?It(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=L_.exec(s)||k_.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:Wl({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=O_.exec(s)||B_.exec(s);if(!t)return null;var e,i,r=jl({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(D_[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return ql(r)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,i=s.b,r=s.a,n=r===void 0?1:r;return Xe(t)&&Xe(e)&&Xe(i)?Wl({r:Number(t),g:Number(e),b:Number(i),a:Number(n)}):null},"rgb"],[function(s){var t=s.h,e=s.s,i=s.l,r=s.a,n=r===void 0?1:r;if(!Xe(t)||!Xe(e)||!Xe(i))return null;var o=jl({h:Number(t),s:Number(e),l:Number(i),a:Number(n)});return ql(o)},"hsl"],[function(s){var t=s.h,e=s.s,i=s.v,r=s.a,n=r===void 0?1:r;if(!Xe(t)||!Xe(e)||!Xe(i))return null;var o=function(a){return{h:$c(a.h),s:ae(a.s,0,100),v:ae(a.v,0,100),a:ae(a.a)}}({h:Number(t),s:Number(e),v:Number(i),a:Number(n)});return Vc(o)},"hsv"]]},Kl=function(s,t){for(var e=0;e<t.length;e++){var i=t[e][0](s);if(i)return[i,t[e][1]]}return[null,void 0]},N_=function(s){return typeof s=="string"?Kl(s.trim(),Aa.string):typeof s=="object"&&s!==null?Kl(s,Aa.object):[null,void 0]},Mo=function(s,t){var e=ds(s);return{h:e.h,s:ae(e.s+100*t,0,100),l:e.l,a:e.a}},Do=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},Zl=function(s,t){var e=ds(s);return{h:e.h,s:e.s,l:ae(e.l+100*t,0,100),a:e.a}},Ea=function(){function s(t){this.parsed=N_(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return It(Do(this.rgba),2)},s.prototype.isDark=function(){return Do(this.rgba)<.5},s.prototype.isLight=function(){return Do(this.rgba)>=.5},s.prototype.toHex=function(){return t=Io(this.rgba),e=t.r,i=t.g,r=t.b,o=(n=t.a)<1?Xs(It(255*n)):"","#"+Xs(e)+Xs(i)+Xs(r)+o;var t,e,i,r,n,o},s.prototype.toRgb=function(){return Io(this.rgba)},s.prototype.toRgbString=function(){return t=Io(this.rgba),e=t.r,i=t.g,r=t.b,(n=t.a)<1?"rgba("+e+", "+i+", "+r+", "+n+")":"rgb("+e+", "+i+", "+r+")";var t,e,i,r,n},s.prototype.toHsl=function(){return Yl(ds(this.rgba))},s.prototype.toHslString=function(){return t=Yl(ds(this.rgba)),e=t.h,i=t.s,r=t.l,(n=t.a)<1?"hsla("+e+", "+i+"%, "+r+"%, "+n+")":"hsl("+e+", "+i+"%, "+r+"%)";var t,e,i,r,n},s.prototype.toHsv=function(){return t=Xc(this.rgba),{h:It(t.h),s:It(t.s),v:It(t.v),a:It(t.a,3)};var t},s.prototype.invert=function(){return we({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),we(Mo(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),we(Mo(this.rgba,-t))},s.prototype.grayscale=function(){return we(Mo(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),we(Zl(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),we(Zl(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?we({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):It(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=ds(this.rgba);return typeof t=="number"?we({h:t,s:e.s,l:e.l,a:e.a}):It(e.h)},s.prototype.isEqual=function(t){return this.toHex()===we(t).toHex()},s}(),we=function(s){return s instanceof Ea?s:new Ea(s)},Ql=[],U_=function(s){s.forEach(function(t){Ql.indexOf(t)<0&&(t(Ea,Aa),Ql.push(t))})};function G_(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var r in e)i[e[r]]=r;var n={};s.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,h,l=i[this.toHex()];if(l)return l;if(o!=null&&o.closest){var u=this.toRgb(),c=1/0,d="black";if(!n.length)for(var f in e)n[f]=new s(e[f]).toRgb();for(var m in e){var p=(a=u,h=n[m],Math.pow(a.r-h.r,2)+Math.pow(a.g-h.g,2)+Math.pow(a.b-h.b,2));p<c&&(c=p,d=m)}return d}},t.string.push([function(o){var a=o.toLowerCase(),h=a==="transparent"?"#0000":e[a];return h?new s(h).toRgb():null},"name"])}U_([G_]);const cr=class fn{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof fn)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((r,n)=>r===e[n]);if(t!==null&&e!==null){const r=Object.keys(t),n=Object.keys(e);return r.length!==n.length?!1:r.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,i,r]=this._components;return{r:t,g:e,b:i,a:r}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,r]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(r*255),t}toRgbArray(t){t=t??[];const[e,i,r]=this._components;return t[0]=e,t[1]=i,t[2]=r,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,r,n]=fn.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=r,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,r=this._int>>8&255,n=this._int&255;return e&&(i=i*t+.5|0,r=r*t+.5|0,n=n*t+.5|0),(t*255<<24)+(i<<16)+(r<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,i,r]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(i*t)/t,this._components[2]=Math.round(r*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,i,r,n]=this._components;return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t}normalize(t){let e,i,r,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,i=(o>>8&255)/255,r=(o&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,r,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,r,n=255]=t,e/=255,i/=255,r/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=fn.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=we(t);o.isValid()&&({r:e,g:i,b:r,a:n}=o.rgba,e/=255,i/=255,r/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=r,this._components[3]=n,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((r,n)=>{t[n]=Math.min(Math.max(r,e),i)}),t)}};cr.shared=new cr,cr.temp=new cr,cr.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let ht=cr;function Bh(s,t=[]){return Z("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),ht.shared.setValue(s).toRgbArray(t)}function z_(s){return Z("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),ht.shared.setValue(s).toHex()}function eo(s){return Z("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),ht.shared.setValue(s).toNumber()}function H_(){const s=[],t=[];for(let i=0;i<32;i++)s[i]=i,t[i]=i;s[W.NORMAL_NPM]=W.NORMAL,s[W.ADD_NPM]=W.ADD,s[W.SCREEN_NPM]=W.SCREEN,t[W.NORMAL]=W.NORMAL_NPM,t[W.ADD]=W.ADD_NPM,t[W.SCREEN]=W.SCREEN_NPM;const e=[];return e.push(t),e.push(s),e}const Wc=H_();function jc(s,t){return Wc[t?1:0][s]}function $_(s,t=null){const e=s*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let i=0,r=0;i<e;i+=6,r+=4)t[i+0]=r+0,t[i+1]=r+1,t[i+2]=r+2,t[i+3]=r+0,t[i+4]=r+2,t[i+5]=r+3;return t}function Yc(s){if(s.BYTES_PER_ELEMENT===4)return s instanceof Float32Array?"Float32Array":s instanceof Uint32Array?"Uint32Array":"Int32Array";if(s.BYTES_PER_ELEMENT===2){if(s instanceof Uint16Array)return"Uint16Array"}else if(s.BYTES_PER_ELEMENT===1&&s instanceof Uint8Array)return"Uint8Array";return null}function Mn(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function Jl(s){return!(s&s-1)&&!!s}function tu(s){let t=(s>65535?1:0)<<4;s>>>=t;let e=(s>255?1:0)<<3;return s>>>=e,t|=e,e=(s>15?1:0)<<2,s>>>=e,t|=e,e=(s>3?1:0)<<1,s>>>=e,t|=e,t|s>>1}function Er(s,t,e){const i=s.length;let r;if(t>=i||e===0)return;e=t+e>i?i-t:e;const n=i-e;for(r=t;r<n;++r)s[r]=s[r+e];s.length=n}function ui(s){return s===0?0:s<0?-1:1}let X_=0;function Zi(){return++X_}const Sa=class{constructor(s,t,e,i){this.left=s,this.top=t,this.right=e,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Sa.EMPTY=new Sa(0,0,0,0);let eu=Sa;const iu={},Ae=Object.create(null),ii=Object.create(null);class V_{constructor(t,e,i){this._canvas=k.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||k.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function ru(s,t,e){for(let i=0,r=4*e*t;i<t;++i,r+=4)if(s[r+3]!==0)return!1;return!0}function su(s,t,e,i,r){const n=4*t;for(let o=i,a=i*n+4*e;o<=r;++o,a+=n)if(s[a+3]!==0)return!1;return!0}function W_(s){const{width:t,height:e}=s,i=s.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const r=i.getImageData(0,0,t,e).data;let n=0,o=0,a=t-1,h=e-1;for(;o<e&&ru(r,t,o);)++o;if(o===e)return eu.EMPTY;for(;ru(r,t,h);)--h;for(;su(r,t,n,o,h);)++n;for(;su(r,t,a,o,h);)--a;return++a,++h,new eu(n,o,a,h)}function j_(s){const t=W_(s),{width:e,height:i}=t;let r=null;if(!t.isEmpty()){const n=s.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");r=n.getImageData(t.left,t.top,e,i)}return{width:e,height:i,data:r}}function Y_(s,t=globalThis.location){if(s.startsWith("data:"))return"";t=t||globalThis.location;const e=new URL(s,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function Qe(s,t=1){var i;const e=(i=k.RETINA_PREFIX)==null?void 0:i.exec(s);return e?parseFloat(e[1]):t}var B=(s=>(s.Renderer="renderer",s.Application="application",s.RendererSystem="renderer-webgl-system",s.RendererPlugin="renderer-webgl-plugin",s.CanvasRendererSystem="renderer-canvas-system",s.CanvasRendererPlugin="renderer-canvas-plugin",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s))(B||{});const Ca=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},nu=(s,t)=>Ca(s).priority??t,H={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(Ca).forEach(t=>{t.type.forEach(e=>{var i,r;return(r=(i=this._removeHandlers)[e])==null?void 0:r.call(i,t)})}),this},add(...s){return s.map(Ca).forEach(t=>{t.type.forEach(e=>{var n,o;const i=this._addHandlers,r=this._queue;i[e]?(n=i[e])==null||n.call(i,t):(r[e]=r[e]||[],(o=r[e])==null||o.push(t))})}),this},handle(s,t,e){var o;const i=this._addHandlers,r=this._removeHandlers;if(i[s]||r[s])throw new Error(`Extension type ${s} already has a handler`);i[s]=t,r[s]=e;const n=this._queue;return n[s]&&((o=n[s])==null||o.forEach(a=>t(a)),delete n[s]),this},handleByMap(s,t){return this.handle(s,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByList(s,t,e=-1){return this.handle(s,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((r,n)=>nu(n,e)-nu(r,e)))},i=>{const r=t.indexOf(i.ref);r!==-1&&t.splice(r,1)})}};class Pa{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const q_=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function K_(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function Z_(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const i=q_.replace(/%forloop%/gi,K_(s));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}return s}const Fo=0,Oo=1,Bo=2,Lo=3,ko=4,No=5;class He{constructor(){this.data=0,this.blendMode=W.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Fo)}set blend(t){!!(this.data&1<<Fo)!==t&&(this.data^=1<<Fo)}get offsets(){return!!(this.data&1<<Oo)}set offsets(t){!!(this.data&1<<Oo)!==t&&(this.data^=1<<Oo)}get culling(){return!!(this.data&1<<Bo)}set culling(t){!!(this.data&1<<Bo)!==t&&(this.data^=1<<Bo)}get depthTest(){return!!(this.data&1<<Lo)}set depthTest(t){!!(this.data&1<<Lo)!==t&&(this.data^=1<<Lo)}get depthMask(){return!!(this.data&1<<No)}set depthMask(t){!!(this.data&1<<No)!==t&&(this.data^=1<<No)}get clockwiseFrontFace(){return!!(this.data&1<<ko)}set clockwiseFrontFace(t){!!(this.data&1<<ko)!==t&&(this.data^=1<<ko)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==W.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new He;return t.depthTest=!1,t.blend=!0,t}}He.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Ra=[];function qc(s,t){if(!s)return null;let e="";if(typeof s=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(s);i&&(e=i[1].toLowerCase())}for(let i=Ra.length-1;i>=0;--i){const r=Ra[i];if(r.test&&r.test(s,e))return new r(s,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class _e{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,i,r,n,o,a,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:u}=this;this._aliasCount++;for(let c=0,d=u.length;c<d;c++)u[c][l](t,e,i,r,n,o,a,h);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(_e.prototype,{dispatch:{value:_e.prototype.emit},run:{value:_e.prototype.emit}});class bs{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new _e("setRealSize"),this.onUpdate=new _e("update"),this.onError=new _e("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class io extends bs{constructor(t,e){const{width:i,height:r}=e||{};if(!i||!r)throw new Error("BufferResource width or height invalid");super(i,r),this.data=t,this.unpackAlignment=e.unpackAlignment??4}upload(t,e,i){const r=t.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,this.unpackAlignment),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Vt.UNPACK);const n=e.realWidth,o=e.realHeight;return i.width===n&&i.height===o?r.texSubImage2D(e.target,0,0,0,n,o,e.format,i.type,this.data):(i.width=n,i.height=o,r.texImage2D(e.target,0,i.internalFormat,n,o,0,e.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t===null||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const Q_={scaleMode:ge.NEAREST,alphaMode:Vt.NPM},Ia=class dr extends Ms{constructor(t=null,e=null){super(),e=Object.assign({},dr.defaultOptions,e);const{alphaMode:i,mipmap:r,anisotropicLevel:n,scaleMode:o,width:a,height:h,wrapMode:l,format:u,type:c,target:d,resolution:f,resourceOptions:m}=e;t&&!(t instanceof bs)&&(t=qc(t,m),t.internal=!0),this.resolution=f||k.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((h||0)*this.resolution)/this.resolution,this._mipmap=r,this.anisotropicLevel=n,this._wrapMode=l,this._scaleMode=o,this.format=u,this.type=c,this.target=d,this.alphaMode=i,this.uid=Zi(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let i;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this}setSize(t,e,i){return i=i||this.resolution,this.setRealSize(t*i,e*i,i)}setRealSize(t,e,i){return this.resolution=i||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Jl(this.realWidth)&&Jl(this.realHeight)}setResolution(t){const e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ii[this.cacheId],delete Ae[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),dr.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,i=k.STRICT_TEXTURE_CACHE){const r=typeof t=="string";let n=null;if(r)n=t;else{if(!t._pixiId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${Zi()}`}n=t._pixiId}let o=ii[n];if(r&&i&&!o)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return o||(o=new dr(t,e),o.cacheId=n,dr.addToCache(o,n)),o}static fromBuffer(t,e,i,r){t=t||new Float32Array(e*i*4);const n=new io(t,{width:e,height:i,...r==null?void 0:r.resourceOptions});let o,a;return t instanceof Float32Array?(o=M.RGBA,a=V.FLOAT):t instanceof Int32Array?(o=M.RGBA_INTEGER,a=V.INT):t instanceof Uint32Array?(o=M.RGBA_INTEGER,a=V.UNSIGNED_INT):t instanceof Int16Array?(o=M.RGBA_INTEGER,a=V.SHORT):t instanceof Uint16Array?(o=M.RGBA_INTEGER,a=V.UNSIGNED_SHORT):t instanceof Int8Array?(o=M.RGBA,a=V.BYTE):(o=M.RGBA,a=V.UNSIGNED_BYTE),n.internal=!0,new dr(n,Object.assign({},Q_,{type:a,format:o},r))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),ii[e]&&ii[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),ii[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=ii[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete ii[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete ii[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};Ia.defaultOptions={mipmap:Ue.POW2,anisotropicLevel:0,scaleMode:ge.LINEAR,wrapMode:mi.CLAMP,alphaMode:Vt.UNPACK,target:Tr.TEXTURE_2D,format:M.RGBA,type:V.UNSIGNED_BYTE},Ia._globalBatch=0;let j=Ia;class Ma{constructor(){this.texArray=null,this.blend=0,this.type=Fe.TRIANGLES,this.start=0,this.size=0,this.data=null}}let J_=0;class xt{constructor(t,e=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=J_++,this.disposeRunner=new _e("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Be.ELEMENT_ARRAY_BUFFER:Be.ARRAY_BUFFER}get index(){return this.type===Be.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new xt(t)}}class Dn{constructor(t,e=0,i=!1,r=V.FLOAT,n,o,a,h=1){this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=o,this.instance=a,this.divisor=h}destroy(){this.buffer=null}static from(t,e,i,r,n){return new Dn(t,e,i,r,n)}}const t0={Float32Array,Uint32Array,Int32Array,Uint8Array};function e0(s,t){let e=0,i=0;const r={};for(let h=0;h<s.length;h++)i+=t[h],e+=s[h].length;const n=new ArrayBuffer(e*4);let o=null,a=0;for(let h=0;h<s.length;h++){const l=t[h],u=s[h],c=Yc(u);r[c]||(r[c]=new t0[c](n)),o=r[c];for(let d=0;d<u.length;d++){const f=(d/l|0)*i+a,m=d%l;o[f+m]=u[d]}a+=l}return new Float32Array(n)}const ou={5126:4,5123:2,5121:1};let i0=0;const r0={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class yi{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=i0++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new _e("disposeGeometry"),this.refCount=0}addAttribute(t,e,i=0,r=!1,n,o,a,h=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof xt||(e instanceof Array&&(e=new Float32Array(e)),e=new xt(e));const l=t.split("|");if(l.length>1){for(let c=0;c<l.length;c++)this.addAttribute(l[c],e,i,r,n);return this}let u=this.buffers.indexOf(e);return u===-1&&(this.buffers.push(e),u=this.buffers.length-1),this.attributes[t]=new Dn(u,i,r,n,o,a,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof xt||(t instanceof Array&&(t=new Uint16Array(t)),t=new xt(t)),t.type=Be.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],i=new xt;let r;for(r in this.attributes){const n=this.attributes[r],o=this.buffers[n.buffer];t.push(o.data),e.push(n.size*ou[n.type]/4),n.buffer=0}for(i.data=e0(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new yi;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new xt(this.buffers[e].data.slice(0));for(const e in this.attributes){const i=this.attributes[e];t.attributes[e]=new Dn(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Be.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new yi,i=[],r=[],n=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)r[h]=r[h]||0,r[h]+=o.buffers[h].data.length,n[h]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new r0[Yc(o.buffers[a].data)](r[a]),e.buffers[a]=new xt(i[a]);for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)i[h].set(o.buffers[h].data,n[h]),n[h]+=o.buffers[h].data.length}if(e.attributes=o.attributes,o.indexBuffer){e.indexBuffer=e.buffers[o.buffers.indexOf(o.indexBuffer)],e.indexBuffer.type=Be.ELEMENT_ARRAY_BUFFER;let a=0,h=0,l=0,u=0;for(let c=0;c<o.buffers.length;c++)if(o.buffers[c]!==o.indexBuffer){u=c;break}for(const c in o.attributes){const d=o.attributes[c];(d.buffer|0)===u&&(h+=d.size*ou[d.type]/4)}for(let c=0;c<t.length;c++){const d=t[c].indexBuffer.data;for(let f=0;f<d.length;f++)e.indexBuffer.data[f+l]+=a;a+=t[c].buffers[u].data.length/h,l+=d.length}}return e}}class Kc extends yi{constructor(t=!1){super(),this._buffer=new xt(null,t,!1),this._indexBuffer=new xt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,V.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,V.FLOAT).addAttribute("aColor",this._buffer,4,!0,V.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,V.FLOAT).addIndex(this._indexBuffer)}}const Fn=Math.PI*2,s0=180/Math.PI,Ts=Math.PI/180;var kt=(s=>(s[s.POLY=0]="POLY",s[s.RECT=1]="RECT",s[s.CIRC=2]="CIRC",s[s.ELIP=3]="ELIP",s[s.RREC=4]="RREC",s))(kt||{});class K{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new K(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}}K.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Vs=[new K,new K,new K,new K];class q{constructor(t=0,e=0,i=0,r=0){this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=kt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new q(0,0,0,0)}clone(){return new q(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const E=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>E}const i=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=i||o<=n)return!1;const a=Vs[0].set(t.left,t.top),h=Vs[1].set(t.left,t.bottom),l=Vs[2].set(t.right,t.top),u=Vs[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;const c=Math.sign(e.a*e.d-e.b*e.c);if(c===0||(e.apply(a,a),e.apply(h,h),e.apply(l,l),e.apply(u,u),Math.max(a.x,h.x,l.x,u.x)<=i||Math.min(a.x,h.x,l.x,u.x)>=r||Math.max(a.y,h.y,l.y,u.y)<=n||Math.min(a.y,h.y,l.y,u.y)>=o))return!1;const d=c*(h.y-a.y),f=c*(a.x-h.x),m=d*i+f*n,p=d*r+f*n,g=d*i+f*o,y=d*r+f*o;if(Math.max(m,p,g,y)<=d*a.x+f*a.y||Math.min(m,p,g,y)>=d*u.x+f*u.y)return!1;const x=c*(a.y-l.y),_=c*(l.x-a.x),v=x*i+_*n,b=x*r+_*n,S=x*i+_*o,w=x*r+_*o;return!(Math.max(v,b,S,w)<=x*a.x+_*a.y||Math.min(v,b,S,w)>=x*u.x+_*u.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this}}q.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class ro{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.radius=i,this.type=kt.CIRC}clone(){return new ro(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=i}getBounds(){return new q(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}ro.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class so{constructor(t=0,e=0,i=0,r=0){this.x=t,this.y=e,this.width=i,this.height=r,this.type=kt.ELIP}clone(){return new so(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,r=(e-this.y)/this.height;return i*=i,r*=r,i+r<=1}getBounds(){return new q(this.x-this.width,this.y-this.height,this.width,this.height)}}so.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Xi{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let r=0,n=e.length;r<n;r++)i.push(e[r].x,e[r].y);e=i}this.points=e,this.type=kt.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new Xi(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let i=!1;const r=this.points.length/2;for(let n=0,o=r-1;n<r;o=n++){const a=this.points[n*2],h=this.points[n*2+1],l=this.points[o*2],u=this.points[o*2+1];h>e!=u>e&&t<(l-a)*((e-h)/(u-h))+a&&(i=!i)}return i}}Xi.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((s,t)=>`${s}, ${t}`,"")}]`};class no{constructor(t=0,e=0,i=0,r=0,n=20){this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=kt.RREC}clone(){return new no(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let r=t-(this.x+i),n=e-(this.y+i);const o=i*i;if(r*r+n*n<=o||(r=t-(this.x+this.width-i),r*r+n*n<=o)||(n=e-(this.y+this.height-i),r*r+n*n<=o)||(r=t-(this.x+i),r*r+n*n<=o))return!0}return!1}}no.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class lt{constructor(t=1,e=0,i=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,r,n,o){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new K;const i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e}applyInverse(t,e){e=e||new K;const i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this}append(t){const e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}setTransform(t,e,i,r,n,o,a,h,l){return this.a=Math.cos(a+l)*n,this.b=Math.sin(a+l)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),h=Math.atan2(i,e),l=Math.abs(a+h);return l<1e-5||Math.abs(Fn-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*i+o.y*n),t}invert(){const t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,o=t*r-e*i;return this.a=r/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new lt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new lt}static get TEMP_MATRIX(){return new lt}}lt.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const Ii=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Mi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Di=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Fi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Da=[],Zc=[],Ws=Math.sign;function n0(){for(let s=0;s<16;s++){const t=[];Da.push(t);for(let e=0;e<16;e++){const i=Ws(Ii[s]*Ii[e]+Di[s]*Mi[e]),r=Ws(Mi[s]*Ii[e]+Fi[s]*Mi[e]),n=Ws(Ii[s]*Di[e]+Di[s]*Fi[e]),o=Ws(Mi[s]*Di[e]+Fi[s]*Fi[e]);for(let a=0;a<16;a++)if(Ii[a]===i&&Mi[a]===r&&Di[a]===n&&Fi[a]===o){t.push(a);break}}}for(let s=0;s<16;s++){const t=new lt;t.set(Ii[s],Mi[s],Di[s],Fi[s],0,0),Zc.push(t)}}n0();const dt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Ii[s],uY:s=>Mi[s],vX:s=>Di[s],vY:s=>Fi[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>Da[s][t],sub:(s,t)=>Da[s][dt.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?dt.S:dt.N:Math.abs(t)*2<=Math.abs(s)?s>0?dt.E:dt.W:t>0?s>0?dt.SE:dt.SW:s>0?dt.NE:dt.NW,matrixAppendRotationInv:(s,t,e=0,i=0)=>{const r=Zc[dt.inv(t)];r.tx=e,r.ty=i,s.append(r)}};class qe{constructor(t,e,i=0,r=0){this._x=i,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new qe(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}qe.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Fa=class{constructor(){this.worldTransform=new lt,this.localTransform=new lt,this.position=new qe(this.onChange,this,0,0),this.scale=new qe(this.onChange,this,1,1),this.pivot=new qe(this.onChange,this,0,0),this.skew=new qe(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const s=this.localTransform;this._localID!==this._currentLocalID&&(s.a=this._cx*this.scale.x,s.b=this._sx*this.scale.x,s.c=this._cy*this.scale.y,s.d=this._sy*this.scale.y,s.tx=this.position.x-(this.pivot.x*s.a+this.pivot.y*s.c),s.ty=this.position.y-(this.pivot.x*s.b+this.pivot.y*s.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(s){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==s._worldID){const e=s.worldTransform,i=this.worldTransform;i.a=t.a*e.a+t.b*e.c,i.b=t.a*e.b+t.b*e.d,i.c=t.c*e.a+t.d*e.c,i.d=t.c*e.b+t.d*e.d,i.tx=t.tx*e.a+t.ty*e.c+e.tx,i.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=s._worldID,this._worldID++}}setFromMatrix(s){s.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(s){this._rotation!==s&&(this._rotation=s,this.updateSkew())}};Fa.IDENTITY=new Fa;let Lh=Fa;Lh.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var o0=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,a0=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function au(s,t,e){const i=s.createShader(t);return s.shaderSource(i,e),s.compileShader(i),i}function Uo(s){const t=new Array(s);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Qc(s,t){switch(s){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Uo(2*t);case"bvec3":return Uo(3*t);case"bvec4":return Uo(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Sr=[{test:s=>s.type==="float"&&s.size===1&&!s.isArray,code:s=>`
            if(uv["${s}"] !== ud["${s}"].value)
            {
                ud["${s}"].value = uv["${s}"]
                gl.uniform1f(ud["${s}"].location, uv["${s}"])
            }
            `},{test:(s,t)=>(s.type==="sampler2D"||s.type==="samplerCube"||s.type==="sampler2DArray")&&s.size===1&&!s.isArray&&(t==null||t.castToBaseTexture!==void 0),code:s=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${s}"], t);

            if(ud["${s}"].value !== t)
            {
                ud["${s}"].value = t;
                gl.uniform1i(ud["${s}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(s,t)=>s.type==="mat3"&&s.size===1&&!s.isArray&&t.a!==void 0,code:s=>`
            gl.uniformMatrix3fv(ud["${s}"].location, false, uv["${s}"].toArray(true));
            `,codeUbo:s=>`
                var ${s}_matrix = uv.${s}.toArray(true);

                data[offset] = ${s}_matrix[0];
                data[offset+1] = ${s}_matrix[1];
                data[offset+2] = ${s}_matrix[2];
        
                data[offset + 4] = ${s}_matrix[3];
                data[offset + 5] = ${s}_matrix[4];
                data[offset + 6] = ${s}_matrix[5];
        
                data[offset + 8] = ${s}_matrix[6];
                data[offset + 9] = ${s}_matrix[7];
                data[offset + 10] = ${s}_matrix[8];
            `},{test:(s,t)=>s.type==="vec2"&&s.size===1&&!s.isArray&&t.x!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${s}"].location, v.x, v.y);
                }`,codeUbo:s=>`
                v = uv.${s};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:s=>s.type==="vec2"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${s}"].location, v[0], v[1]);
                }
            `},{test:(s,t)=>s.type==="vec4"&&s.size===1&&!s.isArray&&t.width!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${s}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(s,t)=>s.type==="vec4"&&s.size===1&&!s.isArray&&t.red!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${s}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(s,t)=>s.type==="vec3"&&s.size===1&&!s.isArray&&t.red!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${s}"].location, v.red, v.green, v.blue)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:s=>s.type==="vec4"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${s}"].location, v[0], v[1], v[2], v[3])
                }`}],h0={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},l0={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function u0(s,t){var i;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in s.uniforms){const n=t[r];if(!n){((i=s.uniforms[r])==null?void 0:i.group)===!0&&(s.uniforms[r].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const o=s.uniforms[r];let a=!1;for(let h=0;h<Sr.length;h++)if(Sr[h].test(n,o)){e.push(Sr[h].code(r,o)),a=!0;break}if(!a){const h=(n.size===1&&!n.isArray?h0:l0)[n.type].replace("location",`ud["${r}"].location`);e.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const Jc={};let or=Jc;function c0(){if(or===Jc||or!=null&&or.isContextLost()){const s=k.ADAPTER.createCanvas();let t;k.PREFER_ENV>=er.WEBGL2&&(t=s.getContext("webgl2",{})),t||(t=s.getContext("webgl",{})||s.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),or=t}return or}let js;function d0(){if(!js){js=oe.MEDIUM;const s=c0();if(s&&s.getShaderPrecisionFormat){const t=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT);t&&(js=t.precision?oe.HIGH:oe.MEDIUM)}}return js}function hu(s,t){const e=s.getShaderSource(t).split(`
`).map((l,u)=>`${u}: ${l}`),i=s.getShaderInfoLog(t),r=i.split(`
`),n={},o=r.map(l=>parseFloat(l.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(l=>l&&!n[l]?(n[l]=!0,!0):!1),a=[""];o.forEach(l=>{e[l-1]=`%c${e[l-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=e.join(`
`);a[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function f0(s,t,e,i){s.getProgramParameter(t,s.LINK_STATUS)||(s.getShaderParameter(e,s.COMPILE_STATUS)||hu(s,e),s.getShaderParameter(i,s.COMPILE_STATUS)||hu(s,i),console.error("PixiJS Error: Could not initialize shader."),s.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",s.getProgramInfoLog(t)))}const p0={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function td(s){return p0[s]}let Ys=null;const lu={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function ed(s,t){if(!Ys){const e=Object.keys(lu);Ys={};for(let i=0;i<e.length;++i){const r=e[i];Ys[s[r]]=lu[r]}}return Ys[t]}function uu(s,t,e){if(s.substring(0,9)!=="precision"){let i=t;return t===oe.HIGH&&e!==oe.HIGH&&(i=oe.MEDIUM),`precision ${i} float;
${s}`}else if(e!==oe.HIGH&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}let Yr;function m0(){if(typeof Yr=="boolean")return Yr;try{Yr=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Yr=!1}return Yr}let g0=0;const qs={},Oa=class fr{constructor(t,e,i="pixi-shader",r={}){this.extra={},this.id=g0++,this.vertexSrc=t||fr.defaultVertexSrc,this.fragmentSrc=e||fr.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=r,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),qs[i]?(qs[i]++,i+=`-${qs[i]}`):qs[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=uu(this.vertexSrc,fr.defaultVertexPrecision,oe.HIGH),this.fragmentSrc=uu(this.fragmentSrc,fr.defaultFragmentPrecision,d0())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return a0}static get defaultFragmentSrc(){return o0}static from(t,e,i){const r=t+e;let n=iu[r];return n||(iu[r]=n=new fr(t,e,i)),n}};Oa.defaultVertexPrecision=oe.HIGH,Oa.defaultFragmentPrecision=Ye.apple.device?oe.HIGH:oe.MEDIUM;let Ke=Oa,_0=0;class ye{constructor(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=_0++,this.static=!!e,this.ubo=!!i,t instanceof xt?(this.buffer=t,this.buffer.type=Be.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new xt(new Float32Array(1)),this.buffer.type=Be.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,i){if(!this.ubo)this.uniforms[t]=new ye(e,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,i){return new ye(t,e,i)}static uboFrom(t,e){return new ye(t,e??!0,!0)}}class Le{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof ye?this.uniformGroup=e:this.uniformGroup=new ye(e):this.uniformGroup=new ye({}),this.disposeRunner=new _e("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const i in e.uniforms){const r=e.uniforms[i];if(r.group===!0&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,i){const r=Ke.from(t,e);return new Le(r,i)}}class y0{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const i=new Int32Array(t);for(let n=0;n<t;n++)i[n]=n;this.defaultGroupCache[t]=ye.from({uSamplers:i},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${t}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Ke(this.vertexSrc,r)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new lt,default:this.defaultGroupCache[t]};return new Le(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let i=0;i<t;i++)i>0&&(e+=`
else `),i<t-1&&(e+=`if(vTextureId < ${i}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Ba{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function v0(){return!Ye.apple.device}function x0(s){let t=!0;const e=k.ADAPTER.getNavigator();if(Ye.tablet||Ye.phone){if(Ye.apple.device){const i=e.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(Ye.android.device){const i=e.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?s:4}class oo{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var b0=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,T0=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Qr=class fe extends oo{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=Kc,this.vertexSize=6,this.state=He.for2d(),this.size=fe.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??x0(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??v0(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return Z("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return T0}static get defaultFragmentTemplate(){return b0}setShaderGenerator({vertex:t=fe.defaultVertexSrc,fragment:e=fe.defaultFragmentTemplate}={}){this.shaderGenerator=new y0(t,e)}contextChange(){const t=this.renderer.gl;k.PREFER_ENV===er.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),fe.defaultMaxTextures),this.maxTextures=Z_(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=fe,i=this.size/4,r=Math.floor(i/this.maxTextures)+1;for(;t.length<i;)t.push(new Ma);for(;e.length<r;)e.push(new Ba);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,i=fe._textureArrayPool,r=this.renderer.batch,n=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++j._globalBatch,h=0,l=i[0],u=0;r.copyBoundTextures(n,e);for(let c=0;c<this._bufferSize;++c){const d=t[c];t[c]=null,d._batchEnabled!==a&&(l.count>=e&&(r.boundArray(l,n,a,e),this.buildDrawCalls(l,u,c),u=c,l=i[++h],++a),d._batchEnabled=a,d.touched=o,l.elements[l.count++]=d)}l.count>0&&(r.boundArray(l,n,a,e),this.buildDrawCalls(l,u,this._bufferSize),++h,++a);for(let c=0;c<n.length;c++)n[c]=null;j._globalBatch=a}buildDrawCalls(t,e,i){const{_bufferedElements:r,_attributeBuffer:n,_indexBuffer:o,vertexSize:a}=this,h=fe._drawCallPool;let l=this._dcIndex,u=this._aIndex,c=this._iIndex,d=h[l];d.start=this._iIndex,d.texArray=t;for(let f=e;f<i;++f){const m=r[f],p=m._texture.baseTexture,g=Wc[p.alphaMode?1:0][m.blendMode];r[f]=null,e<f&&d.blend!==g&&(d.size=c-d.start,e=f,d=h[++l],d.texArray=t,d.start=c),this.packInterleavedGeometry(m,n,o,u,c),u+=m.vertexData.length/2*a,c+=m.indices.length,d.blend=g}e<i&&(d.size=c-d.start,++l),this._dcIndex=l,this._aIndex=u,this._iIndex=c}bindAndClearTexArray(t){const e=this.renderer.texture;for(let i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:i}=this;fe.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:i}=this.renderer,r=fe._drawCallPool;let n=null;for(let o=0;o<t;o++){const{texArray:a,type:h,size:l,start:u,blend:c}=r[o];n!==a&&(n=a,this.bindAndClearTexArray(a)),this.state.blendMode=c,i.set(this.state),e.drawElements(h,l,e.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),fe.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=Mn(Math.ceil(t/8)),i=tu(e),r=e*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new Pa(r*this.vertexSize*4)),n}getIndexBuffer(t){const e=Mn(Math.ceil(t/12)),i=tu(e),r=e*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n}packInterleavedGeometry(t,e,i,r,n){const{uint32View:o,float32View:a}=e,h=r/this.vertexSize,l=t.uvs,u=t.indices,c=t.vertexData,d=t._texture.baseTexture._batchLocation,f=Math.min(t.worldAlpha,1),m=ht.shared.setValue(t._tintRGB).toPremultiplied(f,t._texture.baseTexture.alphaMode>0);for(let p=0;p<c.length;p+=2)a[r++]=c[p],a[r++]=c[p+1],a[r++]=l[p],a[r++]=l[p+1],o[r++]=m,a[r++]=d;for(let p=0;p<u.length;p++)i[n++]=h+u[p]}};Qr.defaultBatchSize=4096,Qr.extension={name:"batch",type:B.RendererPlugin},Qr._drawCallPool=[],Qr._textureArrayPool=[];let Oi=Qr;H.add(Oi);var w0=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,A0=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const La=class Jr extends Le{constructor(t,e,i){const r=Ke.from(t||Jr.defaultVertexSrc,e||Jr.defaultFragmentSrc);super(r,i),this.padding=0,this.resolution=Jr.defaultResolution,this.multisample=Jr.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new He}apply(t,e,i,r,n){t.applyFilter(this,e,i,r)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return A0}static get defaultFragmentSrc(){return w0}};La.defaultResolution=1,La.defaultMultisample=At.NONE;let et=La;class On{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new ht(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:i,backgroundAlpha:r}=t,n=i??e;n!==void 0&&(this.color=n),this.alpha=r}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}On.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},On.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"background"};H.add(On);class id{constructor(t){this.renderer=t,this.emptyRenderer=new oo(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:i}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,i,r){const{elements:n,ids:o,count:a}=t;let h=0;for(let l=0;l<a;l++){const u=n[l],c=u._batchLocation;if(c>=0&&c<r&&e[c]===u){o[l]=c;continue}for(;h<r;){const d=e[h];if(d&&d._batchEnabled===i&&d._batchLocation===h){h++;continue}o[l]=h,u._batchLocation=h,e[h]=u;break}}}destroy(){this.renderer=null}}id.extension={type:B.RendererSystem,name:"batch"};H.add(id);let cu=0;class Bn{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=cu++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=cu++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let i;if(k.PREFER_ENV>=er.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc"),bptc:t.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Bn.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Bn.extension={type:B.RendererSystem,name:"context"};H.add(Bn);class ka{constructor(t,e){if(this.width=Math.round(t),this.height=Math.round(e),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new _e("disposeFramebuffer"),this.multisample=At.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new j(null,{scaleMode:ge.NEAREST,resolution:1,mipmap:Ue.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new j(null,{scaleMode:ge.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Ue.OFF,format:M.DEPTH_COMPONENT,type:V.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!t||!e)throw new Error("Framebuffer width and height must not be zero");if(!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class rd extends j{constructor(t={}){if(typeof t=="number"){const e=arguments[0],i=arguments[1],r=arguments[2],n=arguments[3];t={width:e,height:i,scaleMode:r,resolution:n}}t.width=t.width??100,t.height=t.height??100,t.multisample??(t.multisample=At.NONE),super(null,t),this.mipmap=Ue.OFF,this.valid=!0,this._clear=new ht([0,0,0,0]),this.framebuffer=new ka(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Je extends bs{constructor(t){const e=t,i=e.naturalWidth||e.videoWidth||e.displayWidth||e.width,r=e.naturalHeight||e.videoHeight||e.displayHeight||e.height;super(i,r),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,i){i===void 0&&!e.startsWith("data:")?t.crossOrigin=Y_(e):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,e,i,r){const n=t.gl,o=e.realWidth,a=e.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Vt.UNPACK),!this.noSubImage&&e.target===n.TEXTURE_2D&&i.width===o&&i.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,i.type,r):(i.width=o,i.height=a,n.texImage2D(e.target,0,i.internalFormat,e.format,i.type,r)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(e,i),super.update()}dispose(){this.source=null}}class sd extends Je{constructor(t,e){if(e=e||{},typeof t=="string"){const i=new Image;Je.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??k.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,i)=>{const r=this.source;this.url=r.src;const n=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?n():(r.onload=n,r.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(r=>r.blob()).then(r=>e(r,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Vt.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,i){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,i,this.bitmap),!this.preserveBitmap){let r=!0;const n=e._glTextures;for(const o in n){const a=n[o];if(a!==i&&a.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class kh{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,i){const r=e.width,n=e.height;if(i){const o=t.width/2/r,a=t.height/2/n,h=t.x/r+o,l=t.y/n+a;i=dt.add(i,dt.NW),this.x0=h+o*dt.uX(i),this.y0=l+a*dt.uY(i),i=dt.add(i,2),this.x1=h+o*dt.uX(i),this.y1=l+a*dt.uY(i),i=dt.add(i,2),this.x2=h+o*dt.uX(i),this.y2=l+a*dt.uY(i),i=dt.add(i,2),this.x3=h+o*dt.uX(i),this.y3=l+a*dt.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}kh.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const du=new kh;function Ks(s){s.destroy=function(){},s.on=function(){},s.once=function(){},s.emit=function(){}}class U extends Ms{constructor(t,e,i,r,n,o,a){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new q(0,0,1,1)),t instanceof U&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.destroyed=!1,this._uvs=du,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new K(o.x,o.y):new K(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&Ae[e.url]&&U.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,U.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var r;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),i=new U(this.baseTexture,!this.noFrame&&t,e,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===du&&(this._uvs=new kh),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},i=k.STRICT_TEXTURE_CACHE){const r=typeof t=="string";let n=null;if(r)n=t;else if(t instanceof j){if(!t.cacheId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${Zi()}`,j.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${Zi()}`}n=t._pixiId}let o=Ae[n];if(r&&i&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(t instanceof j)?(e.resolution||(e.resolution=Qe(t)),o=new U(new j(t,e)),o.baseTexture.cacheId=n,j.addToCache(o.baseTexture,n),U.addToCache(o,n)):!o&&t instanceof j&&(o=new U(t),U.addToCache(o,n)),o}static fromURL(t,e){const i=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),r=U.from(t,Object.assign({resourceOptions:i},e),!1),n=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):n.load().then(()=>Promise.resolve(r))}static fromBuffer(t,e,i,r){return new U(j.fromBuffer(t,e,i,r))}static fromLoader(t,e,i,r){const n=new j(t,Object.assign({scaleMode:j.defaultOptions.scaleMode,resolution:Qe(e)},r)),{resource:o}=n;o instanceof sd&&(o.url=e);const a=new U(n);return i||(i=e),j.addToCache(a.baseTexture,i),U.addToCache(a,i),i!==e&&(j.addToCache(a.baseTexture,e),U.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise(h=>{a.baseTexture.once("loaded",()=>h(a))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Ae[e]&&Ae[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),Ae[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Ae[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete Ae[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)Ae[t.textureCacheIds[e]]===t&&delete Ae[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:i,width:r,height:n}=t,o=e+r>this.baseTexture.width,a=i+n>this.baseTexture.height;if(o||a){const h=o&&a?"and":"or",l=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,u=`Y: ${i} + ${n} = ${i+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${l} ${h} ${u}`)}this.valid=r&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return U._EMPTY||(U._EMPTY=new U(new j),Ks(U._EMPTY),Ks(U._EMPTY.baseTexture)),U._EMPTY}static get WHITE(){if(!U._WHITE){const t=k.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),U._WHITE=new U(j.from(t)),Ks(U._WHITE),Ks(U._WHITE.baseTexture)}return U._WHITE}}class ke extends U{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,i=!0){const r=this.baseTexture.resolution,n=Math.round(t*r)/r,o=Math.round(e*r)/r;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new ke(new rd(t))}}class nd{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,i=At.NONE){const r=new rd(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new ke(r)}getOptimalTexture(t,e,i=1,r=At.NONE){let n;t=Math.max(Math.ceil(t*i-1e-6),1),e=Math.max(Math.ceil(e*i-1e-6),1),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Mn(t),e=Mn(e),n=((t&65535)<<16|e&65535)>>>0,r>1&&(n+=r*4294967296)):n=r>1?-r:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,e,r)),o.filterPoolKey=n,o.setResolution(i),o}getFilterTexture(t,e,i){const r=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||At.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const i=this.texturePool[e];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const i=this.texturePool[e];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}nd.SCREEN_KEY=-1;class E0 extends yi{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class od extends yi{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new xt(this.vertices),this.uvBuffer=new xt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class S0{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=At.NONE,this.sourceFrame=new q,this.destinationFrame=new q,this.bindingSourceFrame=new q,this.bindingDestinationFrame=new q,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Zs=[new K,new K,new K,new K],Go=new lt;class ad{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new nd,this.statePool=[],this.quad=new E0,this.quadUv=new od,this.tempRect=new q,this.activeState={},this.globalUniforms=new ye({outputFrame:new q,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new S0,o=i.renderTexture;let a,h;if(o.current){const g=o.current;a=g.resolution,h=g.multisample}else a=i.resolution,h=i.multisample;let l=e[0].resolution||a,u=e[0].multisample??h,c=e[0].padding,d=e[0].autoFit,f=e[0].legacy??!0;for(let g=1;g<e.length;g++){const y=e[g];l=Math.min(l,y.resolution||a),u=Math.min(u,y.multisample??h),c=this.useMaxPadding?Math.max(c,y.padding):c+y.padding,d=d&&y.autoFit,f=f||(y.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),r.push(n),n.resolution=l,n.multisample=u,n.legacy=f,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(c);const m=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(Go.copyFrom(i.projection.transform).invert(),m),d?(n.sourceFrame.fit(m),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(m)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,l,u),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=n.sourceFrame.width,p.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=i.projection.transform,i.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,p),i.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;const r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;const n=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*e.resolution),o[1]=Math.round(n[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=e.sourceFrame.width*n[2]-.5*o[2],a[3]=e.sourceFrame.height*n[3]-.5*o[3],e.legacy){const l=r.filterArea;l[0]=e.destinationFrame.width,l[1]=e.destinationFrame.height,l[2]=e.sourceFrame.x,l[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const h=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,e.renderTexture,h.renderTexture,Ie.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let l=e.renderTexture,u=this.getOptimalFilterTexture(l.width,l.height,e.resolution);u.filterFrame=l.filterFrame;let c=0;for(c=0;c<i.length-1;++c){c===1&&e.multisample>1&&(u=this.getOptimalFilterTexture(l.width,l.height,e.resolution),u.filterFrame=l.filterFrame),i[c].apply(this,l,u,Ie.CLEAR,e);const d=l;l=u,u=d}i[c].apply(this,l,h.renderTexture,Ie.BLEND,e),c>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(u)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=Ie.CLEAR){const{renderTexture:i,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t==null?void 0:t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,i.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=r.stateId&1||this.forceClear;(e===Ie.CLEAR||e===Ie.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,i,r){const n=this.renderer;n.state.set(t.state),this.bindAndClear(i,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Fe.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Fe.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:i,destinationFrame:r}=this.activeState,{orig:n}=e._texture,o=t.set(r.width,0,0,r.height,i.x,i.y),a=e.worldTransform.copyTo(lt.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(e.anchor.x,e.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,i=1,r=At.NONE){return this.texturePool.getOptimalTexture(t,e,i,r)}getFilterTexture(t,e,i){if(typeof t=="number"){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||At.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const i=Zs[0],r=Zs[1],n=Zs[2],o=Zs[3];i.set(e.left,e.top),r.set(e.left,e.bottom),n.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(i,i),t.apply(r,r),t.apply(n,n),t.apply(o,o);const a=Math.min(i.x,r.x,n.x,o.x),h=Math.min(i.y,r.y,n.y,o.y),l=Math.max(i.x,r.x,n.x,o.x),u=Math.max(i.y,r.y,n.y,o.y);e.x=a,e.y=h,e.width=l-a,e.height=u-h}roundFrame(t,e,i,r,n){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(n){const{a:o,b:a,c:h,d:l}=n;if((Math.abs(a)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(l)>1e-4))return}n=n?Go.copyFrom(n):Go.identity(),n.translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}ad.extension={type:B.RendererSystem,name:"filter"};H.add(ad);class C0{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=At.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const P0=new q;class hd{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new ka(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new q,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;k.PREFER_ENV===er.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=r=>e.drawBuffersWEBGL(r):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,i=0){const{gl:r}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=i),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const o=e.width>>i,a=e.height>>i,h=o/e.width;this.setViewport(e.x*h,e.y*h,o,a)}else{const o=t.width>>i,a=t.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,i,r){const n=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),r=Math.round(r),(n.width!==i||n.height!==r||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,i,r,n=ua.COLOR|ua.DEPTH){const{gl:o}=this;o.clearColor(t,e,i,r),o.clear(n)}initFramebuffer(t){const{gl:e}=this,i=new C0(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){const{gl:e}=this,i=t.glFramebuffers[this.CONTEXT_UID];if(i.stencil){e.bindRenderbuffer(e.RENDERBUFFER,i.stencil);let o;this.renderer.context.webGLVersion===1?o=e.DEPTH_STENCIL:t.depth&&t.stencil?o=e.DEPTH24_STENCIL8:t.depth?o=e.DEPTH_COMPONENT24:o=e.STENCIL_INDEX8,i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,o,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,o,t.width,t.height)}const r=t.colorTextures;let n=r.length;e.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){const a=r[o],h=a.parentTextureArray||a;this.renderer.texture.bind(h,0),o===0&&i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:i}=this,r=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let o=n.length;i.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||i.createRenderbuffer():r.msaaBuffer&&(i.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const a=[];for(let h=0;h<o;h++){const l=n[h],u=l.parentTextureArray||l;this.renderer.texture.bind(u,0),h===0&&r.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,r.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,r.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+h,l.target,u._glTextures[this.CONTEXT_UID].texture,e),a.push(i.COLOR_ATTACHMENT0+h))}if(a.length>1&&i.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const h=t.depthTexture;this.renderer.texture.bind(h,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,e)}if((t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)){r.stencil=r.stencil||i.createRenderbuffer();let h,l;this.renderer.context.webGLVersion===1?(h=i.DEPTH_STENCIL_ATTACHMENT,l=i.DEPTH_STENCIL):t.depth&&t.stencil?(h=i.DEPTH_STENCIL_ATTACHMENT,l=i.DEPTH24_STENCIL8):t.depth?(h=i.DEPTH_ATTACHMENT,l=i.DEPTH_COMPONENT24):(h=i.STENCIL_ATTACHMENT,l=i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,r.stencil),r.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,l,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,l,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,h,i.RENDERBUFFER,r.stencil)}else r.stencil&&(i.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let i=At.NONE;if(t<=1||e===null)return i;for(let r=0;r<e.length;r++)if(e[r]<=t){i=e[r];break}return i===1&&(i=At.NONE),i}blit(t,e,i){const{current:r,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!r)return;const h=r.glFramebuffers[a];if(!h)return;if(!t){if(!h.msaaBuffer)return;const u=r.colorTextures[0];if(!u)return;h.blitFramebuffer||(h.blitFramebuffer=new ka(r.width,r.height),h.blitFramebuffer.addColorTexture(0,u)),t=h.blitFramebuffer,t.colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||(e=P0,e.width=r.width,e.height=r.height),i||(i=e);const l=e.width===i.width&&e.height===i.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&r.deleteRenderbuffer(i.msaaBuffer),i.stencil&&r.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil&&t.stencil)return;t.stencil=!0;const i=t.width,r=t.height,n=this.gl,o=e.stencil=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o);let a,h;this.renderer.context.webGLVersion===1?(a=n.DEPTH_STENCIL_ATTACHMENT,h=n.DEPTH_STENCIL):t.depth?(a=n.DEPTH_STENCIL_ATTACHMENT,h=n.DEPTH24_STENCIL8):(a=n.STENCIL_ATTACHMENT,h=n.STENCIL_INDEX8),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,h,i,r):n.renderbufferStorage(n.RENDERBUFFER,h,i,r),n.framebufferRenderbuffer(n.FRAMEBUFFER,a,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new q}destroy(){this.renderer=null}}hd.extension={type:B.RendererSystem,name:"framebuffer"};H.add(hd);const zo={5126:4,5123:2,5121:1};class ld{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;k.PREFER_ENV===er.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=r=>i.bindVertexArrayOES(r),t.deleteVertexArray=r=>i.deleteVertexArrayOES(r)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(r,n)=>i.vertexAttribDivisorANGLE(r,n),t.drawElementsInstanced=(r,n,o,a,h)=>i.drawElementsInstancedANGLE(r,n,o,a,h),t.drawArraysInstanced=(r,n,o,a)=>i.drawArraysInstancedANGLE(r,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:i}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},n=!0);const o=r[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){const r=t.buffers[i];e.update(r)}}checkCompatibility(t,e){const i=t.attributes,r=e.attributeData;for(const n in r)if(!i[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,e){const i=t.attributes,r=e.attributeData,n=["g",t.id];for(const o in i)r[o]&&n.push(o,r[o].location);return n.join("-")}initGeometryVao(t,e,i=!0){const r=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=e.program;a.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);const h=this.getSignature(t,a),l=t.glVertexArrayObjects[this.CONTEXT_UID];let u=l[h];if(u)return l[a.id]=u,u;const c=t.buffers,d=t.attributes,f={},m={};for(const p in c)f[p]=0,m[p]=0;for(const p in d)!d[p].size&&a.attributeData[p]?d[p].size=a.attributeData[p].size:d[p].size||console.warn(`PIXI Geometry attribute '${p}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[p].buffer]+=d[p].size*zo[d[p].type];for(const p in d){const g=d[p],y=g.size;g.stride===void 0&&(f[g.buffer]===y*zo[g.type]?g.stride=0:g.stride=f[g.buffer]),g.start===void 0&&(g.start=m[g.buffer],m[g.buffer]+=y*zo[g.type])}u=r.createVertexArray(),r.bindVertexArray(u);for(let p=0;p<c.length;p++){const g=c[p];o.bind(g),i&&g._glBuffers[n].refCount++}return this.activateVao(t,a),l[a.id]=u,l[h]=u,r.bindVertexArray(null),o.unbind(Be.ARRAY_BUFFER),u}disposeGeometry(t,e){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!i){if(o)for(let h=0;h<n.length;h++){const l=n[h]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!e&&o.dispose(n[h],e))}if(!e){for(const h in i)if(h[0]==="g"){const l=i[h];this._activeVao===l&&this.unbind(),r.deleteVertexArray(l)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)}activateVao(t,e){const i=this.gl,r=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let h=null;for(const l in a){const u=a[l],c=o[u.buffer],d=c._glBuffers[r];if(e.attributeData[l]){h!==d&&(n.bind(c),h=d);const f=e.attributeData[l].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,u.size,u.type||i.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)i.vertexAttribDivisor(f,u.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,i,r){const{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,h=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,e||o.indexBuffer.data.length,h,(i||0)*a,r||1):n.drawElements(t,e||o.indexBuffer.data.length,h,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,i,e||o.getSize(),r||1):n.drawArrays(t,i,e||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}ld.extension={type:B.RendererSystem,name:"geometry"};H.add(ld);const fu=new lt;class ud{constructor(t,e){this._texture=t,this.mapCoord=new lt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];e[r]=n*i.a+o*i.c+i.tx,e[r+1]=n*i.b+o*i.d+i.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const r=e.orig,n=e.trim;n&&(fu.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(fu));const o=e.baseTexture,a=this.uClampFrame,h=this.clampMargin/o.resolution,l=this.clampOffset;return a[0]=(e._frame.x+h+l)/o.width,a[1]=(e._frame.y+h+l)/o.height,a[2]=(e._frame.x+e._frame.width-h+l)/o.width,a[3]=(e._frame.y+e._frame.height-h+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&e.rotate===0,!0}}var R0=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,I0=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Na extends et{constructor(t,e,i){let r=null;typeof t!="string"&&e===void 0&&i===void 0&&(r=t,t=void 0,e=void 0,i=void 0),super(t||I0,e||R0,i),this.maskSprite=r,this.maskMatrix=new lt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,i,r){const n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new ud(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,i,r))}}class M0{constructor(t=null){this.type=Ct.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=et.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Ct.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class cd{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let i=e;if(!i.isMaskData){const n=this.maskDataPool.pop()||new M0;n.pooled=!0,n.maskObject=e,i=n}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(r),i._colorMask=r?r._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==Ct.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case Ct.SCISSOR:this.renderer.scissor.push(i);break;case Ct.STENCIL:this.renderer.stencil.push(i);break;case Ct.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case Ct.COLOR:this.pushColorMask(i);break}i.type===Ct.SPRITE&&this.maskStack.push(i)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case Ct.SCISSOR:this.renderer.scissor.pop(e);break;case Ct.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Ct.SPRITE:this.popSpriteMask(e);break;case Ct.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===Ct.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=Ct.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Ct.SCISSOR:t.type=Ct.STENCIL:t.type=Ct.COLOR}pushSpriteMask(t){const{maskObject:e}=t,i=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new Na])),r[0].resolution=t.resolution,r[0].multisample=t.multisample,r[0].maskSprite=e;const n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,i=t._colorMask=e&t.colorMask;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){const e=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}cd.extension={type:B.RendererSystem,name:"mask"};H.add(cd);class dd{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,i=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==i&&(r===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const pu=new lt,mu=[],fd=class pn extends dd{constructor(t){super(t),this.glConst=k.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:i}=t,{renderer:r}=this,n=r.renderTexture,o=i.getBounds(!0,mu.pop()??new q);this.roundFrameToPixels(o,n.current?n.current.resolution:r.resolution,n.sourceFrame,n.destinationFrame,r.projection.transform),e&&o.fit(e),t._scissorRectLocal=o}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:i,c:r,d:n}=t;return(Math.abs(i)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||pn.isMatrixRotated(e.worldTransform)||pn.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const i=t._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(t,e,i,r,n){pn.isMatrixRotated(n)||(n=n?pu.copyFrom(n):pu.identity(),n.translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.renderer.filter.transformAABB(n,t),t.fit(r),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&mu.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};fd.extension={type:B.RendererSystem,name:"scissor"};let D0=fd;H.add(D0);class pd extends dd{constructor(t){super(t),this.glConst=k.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:i}=this.renderer,r=t._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,r,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(t._colorMask=n,i.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=i?i._colorMask:15;r!==0&&(i._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,r!==0&&(i._colorMask=r,e.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}pd.extension={type:B.RendererSystem,name:"stencil"};H.add(pd);class md{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Z("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return Z("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return Z("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}md.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"_plugin"};H.add(md);class gd{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new lt,this.transform=null}update(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,i,r){const n=this.projectionMatrix,o=r?-1:1;n.identity(),n.a=1/e.width*2,n.d=o*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-o-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}gd.extension={type:B.RendererSystem,name:"projection"};H.add(gd);const F0=new Lh,gu=new q;class _d{constructor(t){this.renderer=t,this._tempMatrix=new lt}generateTexture(t,e){const{region:i,...r}=e||{},n=(i==null?void 0:i.copyTo(gu))||t.getLocalBounds(gu,!0),o=r.resolution||this.renderer.resolution;n.width=Math.max(n.width,1/o),n.height=Math.max(n.height,1/o),r.width=n.width,r.height=n.height,r.resolution=o,r.multisample??(r.multisample=this.renderer.multisample);const a=ke.create(r);this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const h=t.transform;return t.transform=F0,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=h,a}destroy(){}}_d.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"textureGenerator"};H.add(_d);const Si=new q,qr=new q;class yd{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new q,this.destinationFrame=new q,this.viewportFrame=new q}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,i){const r=this.renderer;this.current=t;let n,o,a;t?(n=t.baseTexture,a=n.resolution,e||(Si.width=t.frame.width,Si.height=t.frame.height,e=Si),i||(qr.x=t.frame.x,qr.y=t.frame.y,qr.width=e.width,qr.height=e.height,i=qr),o=n.framebuffer):(a=r.resolution,e||(Si.width=r._view.screen.width,Si.height=r._view.screen.height,e=Si),i||(i=Si,i.width=e.width,i.height=e.height));const h=this.viewportFrame;h.x=i.x*a,h.y=i.y*a,h.width=i.width*a,h.height=i.height*a,t||(h.y=r.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(i,e,a,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)}clear(t,e){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=ht.shared.setValue(t||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);const n=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==o.width||n.height!==o.height;if(a){let{x:h,y:l,width:u,height:c}=this.viewportFrame;h=Math.round(h),l=Math.round(l),u=Math.round(u),c=Math.round(c),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,l,u,c)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}yd.extension={type:B.RendererSystem,name:"renderTexture"};H.add(yd);class O0{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function B0(s,t){const e={},i=t.getProgramParameter(s,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const n=t.getActiveAttrib(s,r);if(n.name.startsWith("gl_"))continue;const o=ed(t,n.type),a={type:o,name:n.name,size:td(o),location:t.getAttribLocation(s,n.name)};e[n.name]=a}return e}function L0(s,t){const e={},i=t.getProgramParameter(s,t.ACTIVE_UNIFORMS);for(let r=0;r<i;r++){const n=t.getActiveUniform(s,r),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),h=ed(t,n.type);e[o]={name:o,index:r,type:h,size:n.size,isArray:a,value:Qc(h,n.size)}}return e}function k0(s,t){var a;const e=au(s,s.VERTEX_SHADER,t.vertexSrc),i=au(s,s.FRAGMENT_SHADER,t.fragmentSrc),r=s.createProgram();s.attachShader(r,e),s.attachShader(r,i);const n=(a=t.extra)==null?void 0:a.transformFeedbackVaryings;if(n&&(typeof s.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):s.transformFeedbackVaryings(r,n.names,n.bufferMode==="separate"?s.SEPARATE_ATTRIBS:s.INTERLEAVED_ATTRIBS)),s.linkProgram(r),s.getProgramParameter(r,s.LINK_STATUS)||f0(s,r,e,i),t.attributeData=B0(r,s),t.uniformData=L0(r,s),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const h=Object.keys(t.attributeData);h.sort((l,u)=>l>u?1:-1);for(let l=0;l<h.length;l++)t.attributeData[h[l]].location=l,s.bindAttribLocation(r,l,h[l]);s.linkProgram(r)}s.deleteShader(e),s.deleteShader(i);const o={};for(const h in t.uniformData){const l=t.uniformData[h];o[h]={location:s.getUniformLocation(r,h),value:Qc(l.type,l.size)}}return new O0(r,o)}function N0(s,t,e,i,r){e.buffer.update(r)}const U0={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},vd={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function G0(s){const t=s.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let e=0,i=0,r=0;for(let n=0;n<t.length;n++){const o=t[n];if(e=vd[o.data.type],o.data.size>1&&(e=Math.max(e,16)*o.data.size),o.dataLen=e,i%e!==0&&i<16){const a=i%e%16;i+=a,r+=a}i+e>16?(r=Math.ceil(r/16)*16,o.offset=r,r+=e,i=e):(o.offset=r,i+=e,r+=e)}return r=Math.ceil(r/16)*16,{uboElements:t,size:r}}function z0(s,t){const e=[];for(const i in s)t[i]&&e.push(t[i]);return e.sort((i,r)=>i.index-r.index),e}function H0(s,t){if(!s.autoManage)return{size:0,syncFunc:N0};const e=z0(s.uniforms,t),{uboElements:i,size:r}=G0(e),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){const a=i[o],h=s.uniforms[a.data.name],l=a.data.name;let u=!1;for(let c=0;c<Sr.length;c++){const d=Sr[c];if(d.codeUbo&&d.test(a.data,h)){n.push(`offset = ${a.offset/4};`,Sr[c].codeUbo(a.data.name,h)),u=!0;break}}if(!u)if(a.data.size>1){const c=td(a.data.type),d=Math.max(vd[a.data.type]/16,1),f=c/d,m=(4-f%4)%4;n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{const c=U0[a.data.type];n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};
                ${c};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let $0=0;const Qs={textureCount:0,uboCount:0};class xd{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=$0++}systemCheck(){if(!m0())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),e||(Qs.textureCount=0,Qs.uboCount=0,this.syncUniformGroup(t.uniformGroup,Qs)),r}setUniforms(t){const e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,e){const i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))}syncUniforms(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=u0(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;const r=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),r(i.uniformData,t.uniforms,this.renderer,Qs,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])}createSyncBufferGroup(t,e,i){const{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=H0(t,this.shader.program.uniformData)),t.autoManage){const h=new Float32Array(a.size/4);t.buffer.update(h)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,i){const r=t.uniforms,n=[`${i}-`];for(const o in r)n.push(o),e[o]&&n.push(e[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,i=t.program,r=k0(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}xd.extension={type:B.RendererSystem,name:"shader"};H.add(xd);class Ln{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.4.2 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}Ln.defaultOptions={hello:!1},Ln.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"startup"};H.add(Ln);function X0(s,t=[]){return t[W.NORMAL]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.ADD]=[s.ONE,s.ONE],t[W.MULTIPLY]=[s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.SCREEN]=[s.ONE,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.OVERLAY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.DARKEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.LIGHTEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.COLOR_DODGE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.COLOR_BURN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.HARD_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.SOFT_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.DIFFERENCE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.EXCLUSION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.HUE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.SATURATION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.COLOR]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.LUMINOSITY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.NONE]=[0,0],t[W.NORMAL_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.ADD_NPM]=[s.SRC_ALPHA,s.ONE,s.ONE,s.ONE],t[W.SCREEN_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[W.SRC_IN]=[s.DST_ALPHA,s.ZERO],t[W.SRC_OUT]=[s.ONE_MINUS_DST_ALPHA,s.ZERO],t[W.SRC_ATOP]=[s.DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],t[W.DST_OVER]=[s.ONE_MINUS_DST_ALPHA,s.ONE],t[W.DST_IN]=[s.ZERO,s.SRC_ALPHA],t[W.DST_OUT]=[s.ZERO,s.ONE_MINUS_SRC_ALPHA],t[W.DST_ATOP]=[s.ONE_MINUS_DST_ALPHA,s.SRC_ALPHA],t[W.XOR]=[s.ONE_MINUS_DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],t[W.SUBTRACT]=[s.ONE,s.ONE,s.ONE,s.ONE,s.FUNC_REVERSE_SUBTRACT,s.FUNC_ADD],t}const V0=0,W0=1,j0=2,Y0=3,q0=4,K0=5,bd=class Ua{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=W.NONE,this._blendEq=!1,this.map=[],this.map[V0]=this.setBlend,this.map[W0]=this.setOffset,this.map[j0]=this.setCullFace,this.map[Y0]=this.setDepthTest,this.map[q0]=this.setFrontFace,this.map[K0]=this.setDepthMask,this.checks=[],this.defaultState=new He,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=X0(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,i=0;for(;e;)e&1&&this.map[i].call(this,!!(t.data&1<<i)),e=e>>1,i++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(Ua.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(Ua.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],i=this.gl;e.length===2?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const i=this.checks.indexOf(t);e&&i===-1?this.checks.push(t):!e&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};bd.extension={type:B.RendererSystem,name:"state"};let Z0=bd;H.add(Z0);class Q0 extends Ms{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(r=>t.systems[r]),i=[...e,...Object.keys(t.systems).filter(r=>!e.includes(r))];for(const r of i)this.addSystem(t.systems[r],r)}addRunners(...t){t.forEach(e=>{this.runners[e]=new _e(e)})}addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const r in this.runners)this.runners[r].add(i);return this}emitWithCustomOptions(t,e){const i=Object.keys(this._systemsHash);t.items.forEach(r=>{const n=i.find(o=>this._systemsHash[o]===r);r[t.name](e[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const ts=class mn{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=mn.defaultMaxIdle,this.checkCountMax=mn.defaultCheckCountMax,this.mode=mn.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Sh.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let i=!1;for(let r=0;r<e.length;r++){const n=e[r];n.resource&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[r]=null,i=!0)}if(i){let r=0;for(let n=0;n<e.length;n++)e[n]!==null&&(e[r++]=e[n]);e.length=r}}unload(t){const e=this.renderer.texture,i=t._texture;i&&!i.framebuffer&&e.destroyTexture(i);for(let r=t.children.length-1;r>=0;r--)this.unload(t.children[r])}destroy(){this.renderer=null}};ts.defaultMode=Sh.AUTO,ts.defaultMaxIdle=60*60,ts.defaultCheckCountMax=60*10,ts.extension={type:B.RendererSystem,name:"textureGC"};let Bi=ts;H.add(Bi);class Ho{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=V.UNSIGNED_BYTE,this.internalFormat=M.RGBA,this.samplerType=0}}function J0(s){let t;return"WebGL2RenderingContext"in globalThis&&s instanceof globalThis.WebGL2RenderingContext?t={[s.RGB]:N.FLOAT,[s.RGBA]:N.FLOAT,[s.ALPHA]:N.FLOAT,[s.LUMINANCE]:N.FLOAT,[s.LUMINANCE_ALPHA]:N.FLOAT,[s.R8]:N.FLOAT,[s.R8_SNORM]:N.FLOAT,[s.RG8]:N.FLOAT,[s.RG8_SNORM]:N.FLOAT,[s.RGB8]:N.FLOAT,[s.RGB8_SNORM]:N.FLOAT,[s.RGB565]:N.FLOAT,[s.RGBA4]:N.FLOAT,[s.RGB5_A1]:N.FLOAT,[s.RGBA8]:N.FLOAT,[s.RGBA8_SNORM]:N.FLOAT,[s.RGB10_A2]:N.FLOAT,[s.RGB10_A2UI]:N.FLOAT,[s.SRGB8]:N.FLOAT,[s.SRGB8_ALPHA8]:N.FLOAT,[s.R16F]:N.FLOAT,[s.RG16F]:N.FLOAT,[s.RGB16F]:N.FLOAT,[s.RGBA16F]:N.FLOAT,[s.R32F]:N.FLOAT,[s.RG32F]:N.FLOAT,[s.RGB32F]:N.FLOAT,[s.RGBA32F]:N.FLOAT,[s.R11F_G11F_B10F]:N.FLOAT,[s.RGB9_E5]:N.FLOAT,[s.R8I]:N.INT,[s.R8UI]:N.UINT,[s.R16I]:N.INT,[s.R16UI]:N.UINT,[s.R32I]:N.INT,[s.R32UI]:N.UINT,[s.RG8I]:N.INT,[s.RG8UI]:N.UINT,[s.RG16I]:N.INT,[s.RG16UI]:N.UINT,[s.RG32I]:N.INT,[s.RG32UI]:N.UINT,[s.RGB8I]:N.INT,[s.RGB8UI]:N.UINT,[s.RGB16I]:N.INT,[s.RGB16UI]:N.UINT,[s.RGB32I]:N.INT,[s.RGB32UI]:N.UINT,[s.RGBA8I]:N.INT,[s.RGBA8UI]:N.UINT,[s.RGBA16I]:N.INT,[s.RGBA16UI]:N.UINT,[s.RGBA32I]:N.INT,[s.RGBA32UI]:N.UINT,[s.DEPTH_COMPONENT16]:N.FLOAT,[s.DEPTH_COMPONENT24]:N.FLOAT,[s.DEPTH_COMPONENT32F]:N.FLOAT,[s.DEPTH_STENCIL]:N.FLOAT,[s.DEPTH24_STENCIL8]:N.FLOAT,[s.DEPTH32F_STENCIL8]:N.FLOAT}:t={[s.RGB]:N.FLOAT,[s.RGBA]:N.FLOAT,[s.ALPHA]:N.FLOAT,[s.LUMINANCE]:N.FLOAT,[s.LUMINANCE_ALPHA]:N.FLOAT,[s.DEPTH_STENCIL]:N.FLOAT},t}function ty(s){let t;return"WebGL2RenderingContext"in globalThis&&s instanceof globalThis.WebGL2RenderingContext?t={[V.UNSIGNED_BYTE]:{[M.RGBA]:s.RGBA8,[M.RGB]:s.RGB8,[M.RG]:s.RG8,[M.RED]:s.R8,[M.RGBA_INTEGER]:s.RGBA8UI,[M.RGB_INTEGER]:s.RGB8UI,[M.RG_INTEGER]:s.RG8UI,[M.RED_INTEGER]:s.R8UI,[M.ALPHA]:s.ALPHA,[M.LUMINANCE]:s.LUMINANCE,[M.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[V.BYTE]:{[M.RGBA]:s.RGBA8_SNORM,[M.RGB]:s.RGB8_SNORM,[M.RG]:s.RG8_SNORM,[M.RED]:s.R8_SNORM,[M.RGBA_INTEGER]:s.RGBA8I,[M.RGB_INTEGER]:s.RGB8I,[M.RG_INTEGER]:s.RG8I,[M.RED_INTEGER]:s.R8I},[V.UNSIGNED_SHORT]:{[M.RGBA_INTEGER]:s.RGBA16UI,[M.RGB_INTEGER]:s.RGB16UI,[M.RG_INTEGER]:s.RG16UI,[M.RED_INTEGER]:s.R16UI,[M.DEPTH_COMPONENT]:s.DEPTH_COMPONENT16},[V.SHORT]:{[M.RGBA_INTEGER]:s.RGBA16I,[M.RGB_INTEGER]:s.RGB16I,[M.RG_INTEGER]:s.RG16I,[M.RED_INTEGER]:s.R16I},[V.UNSIGNED_INT]:{[M.RGBA_INTEGER]:s.RGBA32UI,[M.RGB_INTEGER]:s.RGB32UI,[M.RG_INTEGER]:s.RG32UI,[M.RED_INTEGER]:s.R32UI,[M.DEPTH_COMPONENT]:s.DEPTH_COMPONENT24},[V.INT]:{[M.RGBA_INTEGER]:s.RGBA32I,[M.RGB_INTEGER]:s.RGB32I,[M.RG_INTEGER]:s.RG32I,[M.RED_INTEGER]:s.R32I},[V.FLOAT]:{[M.RGBA]:s.RGBA32F,[M.RGB]:s.RGB32F,[M.RG]:s.RG32F,[M.RED]:s.R32F,[M.DEPTH_COMPONENT]:s.DEPTH_COMPONENT32F},[V.HALF_FLOAT]:{[M.RGBA]:s.RGBA16F,[M.RGB]:s.RGB16F,[M.RG]:s.RG16F,[M.RED]:s.R16F},[V.UNSIGNED_SHORT_5_6_5]:{[M.RGB]:s.RGB565},[V.UNSIGNED_SHORT_4_4_4_4]:{[M.RGBA]:s.RGBA4},[V.UNSIGNED_SHORT_5_5_5_1]:{[M.RGBA]:s.RGB5_A1},[V.UNSIGNED_INT_2_10_10_10_REV]:{[M.RGBA]:s.RGB10_A2,[M.RGBA_INTEGER]:s.RGB10_A2UI},[V.UNSIGNED_INT_10F_11F_11F_REV]:{[M.RGB]:s.R11F_G11F_B10F},[V.UNSIGNED_INT_5_9_9_9_REV]:{[M.RGB]:s.RGB9_E5},[V.UNSIGNED_INT_24_8]:{[M.DEPTH_STENCIL]:s.DEPTH24_STENCIL8},[V.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[M.DEPTH_STENCIL]:s.DEPTH32F_STENCIL8}}:t={[V.UNSIGNED_BYTE]:{[M.RGBA]:s.RGBA,[M.RGB]:s.RGB,[M.ALPHA]:s.ALPHA,[M.LUMINANCE]:s.LUMINANCE,[M.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[V.UNSIGNED_SHORT_5_6_5]:{[M.RGB]:s.RGB},[V.UNSIGNED_SHORT_4_4_4_4]:{[M.RGBA]:s.RGBA},[V.UNSIGNED_SHORT_5_5_5_1]:{[M.RGBA]:s.RGBA}},t}class Td{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new j,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=ty(t),this.samplerTypes=J0(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};const i=new Ho(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Ho(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(t,e=0){const{gl:i}=this;if(t=t==null?void 0:t.castToBaseTexture(),(t==null?void 0:t.valid)&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<i.length;r++)i[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),i[r]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:i,CONTEXT_UID:r}=this;if(i)for(let n=t-1;n>=0;--n){const o=e[n];o&&o._glTextures[r].samplerType!==N.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const e=new Ho(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var i;e.internalFormat=((i=this.internalFormats[t.type])==null?void 0:i[t.format])??t.format,e.samplerType=this.samplerTypes[e.internalFormat]??N.FLOAT,this.webGLVersion===2&&t.type===V.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var r;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const i=this.renderer;if(this.initTextureType(t,e),(r=t.resource)==null?void 0:r.upload(i,t,e))e.samplerType!==N.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,o=t.realHeight,a=i.gl;(e.width!==n||e.height!==o||e.dirtyId<0)&&(e.width=n,e.height=o,a.texImage2D(t.target,0,e.internalFormat,n,o,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const r=this.managedTextures.indexOf(t);r!==-1&&Er(this.managedTextures,r,1)}}updateTextureStyle(t){var i;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===Ue.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=mi.CLAMP:e.wrapMode=t.wrapMode,(i=t.resource)!=null&&i.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const i=this.gl;if(e.mipmap&&t.mipmap!==Ue.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===ge.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===ge.LINEAR){const n=Math.min(t.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===ge.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===ge.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}Td.extension={type:B.RendererSystem,name:"texture"};H.add(Td);class wd{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,r=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:i,renderer:r}=this;e&&r.shader.bind(e),i.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:i,CONTEXT_UID:r}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[r]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(i.buffer.update(a),a._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const i=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const h=a._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&n.dispose(a,e))}i&&(e||r.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}wd.extension={type:B.RendererSystem,name:"transformFeedback"};H.add(wd);class kn{constructor(t){this.renderer=t}init(t){this.screen=new q(0,0,t.width,t.height),this.element=t.view||k.ADAPTER.createCanvas(),this.resolution=t.resolution||k.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const i=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=i,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",i,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}kn.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},kn.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"_view"};H.add(kn);k.PREFER_ENV=er.WEBGL2;k.STRICT_TEXTURE_CACHE=!1;k.RENDER_OPTIONS={...Bn.defaultOptions,...On.defaultOptions,...kn.defaultOptions,...Ln.defaultOptions};Object.defineProperties(k,{WRAP_MODE:{get(){return j.defaultOptions.wrapMode},set(s){Z("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),j.defaultOptions.wrapMode=s}},SCALE_MODE:{get(){return j.defaultOptions.scaleMode},set(s){Z("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),j.defaultOptions.scaleMode=s}},MIPMAP_TEXTURES:{get(){return j.defaultOptions.mipmap},set(s){Z("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),j.defaultOptions.mipmap=s}},ANISOTROPIC_LEVEL:{get(){return j.defaultOptions.anisotropicLevel},set(s){Z("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),j.defaultOptions.anisotropicLevel=s}},FILTER_RESOLUTION:{get(){return Z("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),et.defaultResolution},set(s){et.defaultResolution=s}},FILTER_MULTISAMPLE:{get(){return Z("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),et.defaultMultisample},set(s){et.defaultMultisample=s}},SPRITE_MAX_TEXTURES:{get(){return Oi.defaultMaxTextures},set(s){Z("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Oi.defaultMaxTextures=s}},SPRITE_BATCH_SIZE:{get(){return Oi.defaultBatchSize},set(s){Z("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Oi.defaultBatchSize=s}},CAN_UPLOAD_SAME_BUFFER:{get(){return Oi.canUploadSameBuffer},set(s){Z("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Oi.canUploadSameBuffer=s}},GC_MODE:{get(){return Bi.defaultMode},set(s){Z("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Bi.defaultMode=s}},GC_MAX_IDLE:{get(){return Bi.defaultMaxIdle},set(s){Z("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Bi.defaultMaxIdle=s}},GC_MAX_CHECK_COUNT:{get(){return Bi.defaultCheckCountMax},set(s){Z("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Bi.defaultCheckCountMax=s}},PRECISION_VERTEX:{get(){return Ke.defaultVertexPrecision},set(s){Z("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Ke.defaultVertexPrecision=s}},PRECISION_FRAGMENT:{get(){return Ke.defaultFragmentPrecision},set(s){Z("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Ke.defaultFragmentPrecision=s}}});var vi=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(vi||{});class $o{constructor(t,e=null,i=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Ad=class Qt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new $o(null,null,1/0),this.deltaMS=1/Qt.targetFPMS,this.elapsedMS=1/Qt.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=vi.NORMAL){return this._addListener(new $o(t,e,i))}addOnce(t,e,i=vi.NORMAL){return this._addListener(new $o(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Qt.targetFPMS;const i=this._head;let r=i.next;for(;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Qt.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!Qt._shared){const t=Qt._shared=new Qt;t.autoStart=!0,t._protected=!0}return Qt._shared}static get system(){if(!Qt._system){const t=Qt._system=new Qt;t.autoStart=!0,t._protected=!0}return Qt._system}};Ad.targetFPMS=.06;let Nt=Ad;Object.defineProperties(k,{TARGET_FPMS:{get(){return Nt.targetFPMS},set(s){Z("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Nt.targetFPMS=s}}});class Ed{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,vi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Nt.shared:new Nt,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Ed.extension=B.Application;H.add(Ed);const Sd=[];H.handleByList(B.Renderer,Sd);function ey(s){for(const t of Sd)if(t.test(s))return new t(s);throw new Error("Unable to auto-detect a suitable renderer.")}var iy=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ry=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const sy=iy,Cd=ry;class Pd{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{const i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}e>=At.HIGH?this.multisample=At.HIGH:e>=At.MEDIUM?this.multisample=At.MEDIUM:e>=At.LOW?this.multisample=At.LOW:this.multisample=At.NONE}destroy(){}}Pd.extension={type:B.RendererSystem,name:"_multisample"};H.add(Pd);class ny{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Rd{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,r=t._glBuffers[i]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:i,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,i){const{gl:r,CONTEXT_UID:n}=this;i=i||0;const o=t._glBuffers[n]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,o.buffer,i*256,256)}update(t){const{gl:e,CONTEXT_UID:i}=this,r=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:i}=this;return t._glBuffers[e]=new ny(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}Rd.extension={type:B.RendererSystem,name:"buffer"};H.add(Rd);class Id{constructor(t){this.renderer=t}render(t,e){const i=this.renderer;let r,n,o,a;if(e&&(r=e.renderTexture,n=e.clear,o=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!r,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(r||(this.lastObjectRendered=t),!a){const h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}i.renderTexture.bind(r),i.batch.currentRenderer.start(),(n??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),r&&(e.blit&&i.framebuffer.blit(),r.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Id.extension={type:B.RendererSystem,name:"objectRenderer"};H.add(Id);const gn=class Ga extends Q0{constructor(t){super(),this.type=_c.WEBGL,t=Object.assign({},k.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ye({projectionMatrix:new lt},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Ga.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(Z("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=Ga.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t!=null&&t.forceCanvas?!1:M_()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Z("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Z("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Z("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Z("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){Z("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return Z("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){Z("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return Z("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};gn.extension={type:B.Renderer,priority:1},gn.__plugins={},gn.__systems={};let Nh=gn;H.handleByMap(B.RendererPlugin,Nh.__plugins);H.handleByMap(B.RendererSystem,Nh.__systems);H.add(Nh);class Md extends bs{constructor(t,e){const{width:i,height:r}=e||{};super(i,r),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const o=new j;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof bs?this.addResourceAt(t[i],i):this.addResourceAt(qc(t[i],e),i))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load());return this._load=Promise.all(t).then(()=>{const{realWidth:e,realHeight:i}=this.items[0];return this.resize(e,i),this.update(),Promise.resolve(this)}),this._load}}class oy extends Md{constructor(t,e){const{width:i,height:r}=e||{};let n,o;Array.isArray(t)?(n=t,o=t.length):o=t,super(o,{width:i,height:r}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Tr.TEXTURE_2D_ARRAY}upload(t,e,i){const{length:r,itemDirtyIds:n,items:o}=this,{gl:a}=t;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,r,0,e.format,i.type,null);for(let h=0;h<r;h++){const l=o[h];n[h]<l.dirtyId&&(n[h]=l.dirtyId,l.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,l.resource.width,l.resource.height,1,e.format,i.type,l.resource.source))}return!0}}class ay extends Je{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Dd=class es extends Md{constructor(t,e){const{width:i,height:r,autoLoad:n,linkBaseTexture:o}=e||{};if(t&&t.length!==es.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:i,height:r});for(let a=0;a<es.SIDES;a++)this.items[a].target=Tr.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,t&&this.initFromArray(t,e),n!==!1&&this.load()}bind(t){super.bind(t),t.target=Tr.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=Tr.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,i){const r=this.itemDirtyIds;for(let n=0;n<es.SIDES;n++){const o=this.items[n];(r[n]<o.dirtyId||i.dirtyId<e.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(t,o,i),r[n]=o.dirtyId):r[n]<-1&&(t.gl.texImage2D(o.target,0,i.internalFormat,e.realWidth,e.realHeight,0,e.format,i.type,null),r[n]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===es.SIDES}};Dd.SIDES=6;let hy=Dd;class vr extends Je{constructor(t,e){e=e||{};let i,r,n;typeof t=="string"?(i=vr.EMPTY,r=t,n=!0):(i=t,r=null,n=!1),super(i),this.url=r,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.ownsImageBitmap=e.ownsImageBitmap??n,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const i=await k.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await i.blob();if(this.destroyed)return;const n=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Vt.UNPACK?"premultiply":"none"});if(this.destroyed){n.close();return}this.source=n,this.update(),t(this)}catch(i){if(this.destroyed)return;e(i),this.onError.emit(i)}}),this._load)}upload(t,e,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,i)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return vr._EMPTY=vr._EMPTY??k.ADAPTER.createCanvas(0,0),vr._EMPTY}}const za=class _n extends Je{constructor(t,e){e=e||{},super(k.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.update(),t(this)},_n.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const t=new Image;Je.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,i=t.height;if(!e||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let r=e*this.scale,n=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/i*e,n=this._overrideHeight||this._overrideWidth/e*i),r=Math.round(r),n=Math.round(n);const o=this.source;o.width=r,o.height=n,o._pixiId=`canvas_${Zi()}`,o.getContext("2d").drawImage(t,0,0,e,i,0,0,r,n),this._resolve(),this._resolve=null}}static getSize(t){const e=_n.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&_n.SVG_XML.test(t)}};za.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,za.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Ha=za;class ly extends Je{constructor(t){super(t)}static test(t){return!!globalThis.VideoFrame&&t instanceof globalThis.VideoFrame}}const $a=class Xa extends Je{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const i=document.createElement("video");e.autoLoad!==!1&&i.setAttribute("preload","auto"),e.playsinline!==!1&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),e.muted===!0&&(i.setAttribute("muted",""),i.muted=!0),e.loop===!0&&i.setAttribute("loop",""),e.autoPlay!==!1&&i.setAttribute("autoplay",""),typeof t=="string"&&(t=[t]);const r=t[0].src||t[0];Je.crossOrigin(i,r,e.crossorigin);for(let n=0;n<t.length;++n){const o=document.createElement("source");let{src:a,mime:h}=t[n];if(a=a||t[n],a.startsWith("data:"))h=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const l=a.split("?").shift().toLowerCase(),u=l.slice(l.lastIndexOf(".")+1);h=h||Xa.MIME_TYPES[u]||`video/${u}`}o.src=a,h&&(o.type=h),i.appendChild(o)}t=i}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){const e=Nt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e,i)=>{this.valid?e(this):(this._resolve=e,this._reject=i,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!e&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();const t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Nt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Nt.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Nt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||Xa.TYPES.includes(e)}};$a.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],$a.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Fd=$a;Ra.push(vr,sd,ay,Fd,ly,Ha,io,hy,oy);class Nn{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?q.EMPTY:(t=t||new q(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:i,b:r,c:n,d:o,tx:a,ty:h}=t,l=i*e.x+n*e.y+a,u=r*e.x+o*e.y+h;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)}addQuad(t){let e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,o=t[0],a=t[1];e=o<e?o:e,i=a<i?a:i,r=o>r?o:r,n=a>n?a:n,o=t[2],a=t[3],e=o<e?o:e,i=a<i?a:i,r=o>r?o:r,n=a>n?a:n,o=t[4],a=t[5],e=o<e?o:e,i=a<i?a:i,r=o>r?o:r,n=a>n?a:n,o=t[6],a=t[7],e=o<e?o:e,i=a<i?a:i,r=o>r?o:r,n=a>n?a:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n}addFrame(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)}addFrameMatrix(t,e,i,r,n){const o=t.a,a=t.b,h=t.c,l=t.d,u=t.tx,c=t.ty;let d=this.minX,f=this.minY,m=this.maxX,p=this.maxY,g=o*e+h*i+u,y=a*e+l*i+c;d=g<d?g:d,f=y<f?y:f,m=g>m?g:m,p=y>p?y:p,g=o*r+h*i+u,y=a*r+l*i+c,d=g<d?g:d,f=y<f?y:f,m=g>m?g:m,p=y>p?y:p,g=o*e+h*n+u,y=a*e+l*n+c,d=g<d?g:d,f=y<f?y:f,m=g>m?g:m,p=y>p?y:p,g=o*r+h*n+u,y=a*r+l*n+c,d=g<d?g:d,f=y<f?y:f,m=g>m?g:m,p=y>p?y:p,this.minX=d,this.minY=f,this.maxX=m,this.maxY=p}addVertexData(t,e,i){let r=this.minX,n=this.minY,o=this.maxX,a=this.maxY;for(let h=e;h<i;h+=2){const l=t[h],u=t[h+1];r=l<r?l:r,n=u<n?u:n,o=l>o?l:o,a=u>a?u:a}this.minX=r,this.minY=n,this.maxX=o,this.maxY=a}addVertices(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)}addVerticesMatrix(t,e,i,r,n=0,o=n){const a=t.a,h=t.b,l=t.c,u=t.d,c=t.tx,d=t.ty;let f=this.minX,m=this.minY,p=this.maxX,g=this.maxY;for(let y=i;y<r;y+=2){const x=e[y],_=e[y+1],v=a*x+l*_+c,b=u*_+h*x+d;f=Math.min(f,v-n),p=Math.max(p,v+n),m=Math.min(m,b-o),g=Math.max(g,b+o)}this.minX=f,this.minY=m,this.maxX=p,this.maxY=g}addBounds(t){const e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,e){const i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=o){const a=this.minX,h=this.minY,l=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=r<h?r:h,this.maxX=n>l?n:l,this.maxY=o>u?o:u}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=o){const a=this.minX,h=this.minY,l=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=r<h?r:h,this.maxX=n>l?n:l,this.maxY=o>u?o:u}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,i,r,n,o){t-=n,e-=o,i+=n,r+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r}}class gt extends Ms{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Lh,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Nn,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let i=0;i<e.length;++i){const r=e[i];Object.defineProperty(gt.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new q),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new q),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Nn);const e=this.transform,i=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(i==null?void 0:i.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-n,o}toGlobal(t,e,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,i=1,r=1,n=0,o=0,a=0,h=0,l=0){return this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=o,this.skew.y=a,this.pivot.x=h,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new uy),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*s0}set angle(t){this.transform.rotation=t*Ts}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class uy extends gt{constructor(){super(...arguments),this.sortDirty=null}}gt.prototype.displayObjectUpdateTransform=gt.prototype.updateTransform;const cy=new lt;function dy(s,t){return s.zIndex===t.zIndex?s._lastSortedIndex-t._lastSortedIndex:s.zIndex-t.zIndex}const Od=class Va extends gt{constructor(){super(),this.children=[],this.sortableChildren=Va.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(t);Er(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],i=this.children.indexOf(e);if(i===-1)return null;e.parent=null,e.transform._parentID=-1,Er(this.children,i,1),this._boundsID++,this.onChildrenChange(i),e.emit("removed",this),this.emit("childRemoved",e,this,i)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Er(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const i=t,r=e,n=r-i;let o;if(n>0&&n<=r){o=this.children.splice(i,n);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,i=this.children.length;e<i;++e){const r=this.children[e];r._lastSortedIndex=e,!t&&r.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(dy),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const i=this.children[t];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const i=super.getLocalBounds(t);if(!e)for(let r=0,n=this.children.length;r<n;++r){const o=this.children[r];o.visible&&o.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let i,r;this.cullArea?(i=this.cullArea,r=this.worldTransform):this._render!==Va.prototype._render&&(i=this.getBounds(!0));const n=t.projection.transform;if(n&&(r?(r=cy.copyFrom(r),r.prepend(n)):r=n),i&&e.intersects(i,r))this._render(t);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const h=this.children[o],l=h.cullable;h.cullable=l||!this.cullArea,h.render(t),h.cullable=l}}render(t){var e;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(e=this.filters)!=null&&e.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let i=0,r=this.children.length;i<r;++i)this.children[i].render(t)}}renderAdvanced(t){var n,o,a;const e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let h=0;h<e.length;h++)e[h].enabled&&this._enabledFilters.push(e[h])}const r=e&&((n=this._enabledFilters)==null?void 0:n.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==Ct.NONE));if(r&&t.batch.flush(),e&&((o=this._enabledFilters)!=null&&o.length)&&t.filter.push(this,this._enabledFilters),i&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let h=0,l=this.children.length;h<l;++h)this.children[h].render(t)}r&&t.batch.flush(),i&&t.mask.pop(this),e&&((a=this._enabledFilters)!=null&&a.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e=typeof t=="boolean"?t:t==null?void 0:t.children,i=this.removeChildren(0,this.children.length);if(e)for(let r=0;r<i.length;++r)i[r].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}};Od.defaultSortableChildren=!1;let nt=Od;nt.prototype.containerUpdateTransform=nt.prototype.updateTransform;Object.defineProperties(k,{SORTABLE_CHILDREN:{get(){return nt.defaultSortableChildren},set(s){Z("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),nt.defaultSortableChildren=s}}});const Kr=new K,fy=new Uint16Array([0,1,2,0,2,3]);class Dt extends nt{constructor(t){super(),this._anchor=new qe(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new ht(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=W.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||U.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=fy,this.pluginName="batch",this.isSprite=!0,this._roundPixels=k.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=ui(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=ui(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,o=e.d,a=e.tx,h=e.ty,l=this.vertexData,u=t.trim,c=t.orig,d=this._anchor;let f=0,m=0,p=0,g=0;if(u?(m=u.x-d._x*c.width,f=m+u.width,g=u.y-d._y*c.height,p=g+u.height):(m=-d._x*c.width,f=m+c.width,g=-d._y*c.height,p=g+c.height),l[0]=i*m+n*g+a,l[1]=o*g+r*m+h,l[2]=i*f+n*g+a,l[3]=o*g+r*f+h,l[4]=i*f+n*p+a,l[5]=o*p+r*f+h,l[6]=i*m+n*p+a,l[7]=o*p+r*m+h,this._roundPixels){const y=k.RESOLUTION;for(let x=0;x<l.length;++x)l[x]=Math.round(l[x]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,i=t.orig,r=this._anchor,n=this.transform.worldTransform,o=n.a,a=n.b,h=n.c,l=n.d,u=n.tx,c=n.ty,d=-r._x*i.width,f=d+i.width,m=-r._y*i.height,p=m+i.height;if(e[0]=o*d+h*m+u,e[1]=l*m+a*d+c,e[2]=o*f+h*m+u,e[3]=l*m+a*f+c,e[4]=o*f+h*p+u,e[5]=l*p+a*f+c,e[6]=o*d+h*p+u,e[7]=l*p+a*d+c,this._roundPixels){const g=k.RESOLUTION;for(let y=0;y<e.length;++y)e[y]=Math.round(e[y]*g)/g}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Nn),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new q),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Kr);const e=this._texture.orig.width,i=this._texture.orig.height,r=-e*this.anchor.x;let n=0;return Kr.x>=r&&Kr.x<r+e&&(n=-i*this.anchor.y,Kr.y>=n&&Kr.y<n+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const e=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const i=t instanceof U?t:U.from(t,e);return new Dt(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=ui(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=ui(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||U.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const Bd=new lt;gt.prototype._cacheAsBitmap=!1;gt.prototype._cacheData=null;gt.prototype._cacheAsBitmapResolution=null;gt.prototype._cacheAsBitmapMultisample=null;class py{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(gt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(s){s!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=s,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(s){s!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=s,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(s){if(this._cacheAsBitmap===s)return;this._cacheAsBitmap=s;let t;s?(this._cacheData||(this._cacheData=new py),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});gt.prototype._renderCached=function(s){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(s),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(s))};gt.prototype._initCachedDisplayObject=function(s){var d,f;if((d=this._cacheData)!=null&&d.sprite)return;const t=this.alpha;this.alpha=1,s.batch.flush();const e=this.getLocalBounds(new q,!0);if((f=this.filters)!=null&&f.length){const m=this.filters[0].padding;e.pad(m)}const i=this.cacheAsBitmapResolution||s.resolution;e.ceil(i),e.width=Math.max(e.width,1/i),e.height=Math.max(e.height,1/i);const r=s.renderTexture.current,n=s.renderTexture.sourceFrame.clone(),o=s.renderTexture.destinationFrame.clone(),a=s.projection.transform,h=ke.create({width:e.width,height:e.height,resolution:i,multisample:this.cacheAsBitmapMultisample??s.multisample}),l=`cacheAsBitmap_${Zi()}`;this._cacheData.textureCacheId=l,j.addToCache(h.baseTexture,l),U.addToCache(h,l);const u=this.transform.localTransform.copyTo(Bd).invert().translate(-e.x,-e.y);this.render=this._cacheData.originalRender,s.render(this,{renderTexture:h,clear:!0,transform:u,skipUpdateTransform:!1}),s.framebuffer.blit(),s.projection.transform=a,s.renderTexture.bind(r,n,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const c=new Dt(h);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(e.x/e.width),c.anchor.y=-(e.y/e.height),c.alpha=t,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)};gt.prototype._renderCachedCanvas=function(s){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(s),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(s))};gt.prototype._initCachedDisplayObjectCanvas=function(s){var u;if((u=this._cacheData)!=null&&u.sprite)return;const t=this.getLocalBounds(new q,!0),e=this.alpha;this.alpha=1;const i=s.canvasContext.activeContext,r=s._projTransform,n=this.cacheAsBitmapResolution||s.resolution;t.ceil(n),t.width=Math.max(t.width,1/n),t.height=Math.max(t.height,1/n);const o=ke.create({width:t.width,height:t.height,resolution:n}),a=`cacheAsBitmap_${Zi()}`;this._cacheData.textureCacheId=a,j.addToCache(o.baseTexture,a),U.addToCache(o,a);const h=Bd;this.transform.localTransform.copyTo(h),h.invert(),h.tx-=t.x,h.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,s.render(this,{renderTexture:o,clear:!0,transform:h,skipUpdateTransform:!1}),s.canvasContext.activeContext=i,s._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const l=new Dt(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-(t.x/t.width),l.anchor.y=-(t.y/t.height),l.alpha=e,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=s._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)};gt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};gt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};gt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,j.removeFromCache(this._cacheData.textureCacheId),U.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};gt.prototype._cacheAsBitmapDestroy=function(s){this.cacheAsBitmap=!1,this.destroy(s)};gt.prototype.name=null;nt.prototype.getChildByName=function(s,t){for(let e=0,i=this.children.length;e<i;e++)if(this.children[e].name===s)return this.children[e];if(t)for(let e=0,i=this.children.length;e<i;e++){const r=this.children[e];if(!r.getChildByName)continue;const n=r.getChildByName(s,!0);if(n)return n}return null};gt.prototype.getGlobalPosition=function(s=new K,t=!1){return this.parent?this.parent.toGlobal(this.position,s,t):(s.x=this.position.x,s.y=this.position.y),s};var my=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class Ld extends et{constructor(t=1){super(sy,my,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const gy={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},_y=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function yy(s){const t=gy[s],e=t.length;let i=_y,r="";const n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<s;a++){let h=n.replace("%index%",a.toString());o=a,a>=e&&(o=s-a-1),h=h.replace("%value%",t[o].toString()),r+=h,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",s.toString()),i}const vy=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function xy(s,t){const e=Math.ceil(s/2);let i=vy,r="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<s;o++){let a=n.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(e-1)}.0`),r+=a,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",s.toString()),i}class Wa extends et{constructor(t,e=8,i=4,r=et.defaultResolution,n=5){const o=xy(n,t),a=yy(n);super(o,a),this.horizontal=t,this.resolution=r,this._quality=0,this.quality=i,this.blur=e}apply(t,e,i,r){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/e.width):this.uniforms.strength=1/i.height*(i.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,i,r);else{const n=t.getFilterTexture(),o=t.renderer;let a=e,h=n;this.state.blend=!1,t.applyFilter(this,a,h,Ie.CLEAR);for(let l=1;l<this.passes-1;l++){t.bindAndClear(a,Ie.BLIT),this.uniforms.uSampler=h;const u=h;h=a,a=u,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,h,i,r),t.returnFilterTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class by extends et{constructor(t=8,e=4,i=et.defaultResolution,r=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Wa(!0,t,e,i,r),this.blurYFilter=new Wa(!1,t,e,i,r),this.resolution=i,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,i,r){const n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){const a=t.getFilterTexture();this.blurXFilter.apply(t,e,a,Ie.CLEAR),this.blurYFilter.apply(t,a,i,r),t.returnFilterTexture(a)}else o?this.blurYFilter.apply(t,e,i,r):this.blurXFilter.apply(t,e,i,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var Ty=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class ja extends et{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(Cd,Ty,t),this.alpha=1}_loadMatrix(t,e=!1){let i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}tint(t,e){const[i,r,n]=ht.shared.setValue(t).toArray(),o=[i,0,0,0,0,0,r,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(o,e)}greyscale(t,e){const i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const i=Math.cos(t),r=Math.sin(t),n=Math.sqrt,o=1/3,a=n(o),h=i+(1-i)*o,l=o*(1-i)-a*r,u=o*(1-i)+a*r,c=o*(1-i)+a*r,d=i+o*(1-i),f=o*(1-i)-a*r,m=o*(1-i)-a*r,p=o*(1-i)+a*r,g=i+o*(1-i),y=[h,l,u,0,0,c,d,f,0,0,m,p,g,0,0,0,0,0,1,0];this._loadMatrix(y,e)}contrast(t,e){const i=(t||0)+1,r=-.5*(i-1),n=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(n,e)}saturate(t=0,e){const i=t*2/3+1,r=(i-1)*-.5,n=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(n,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,i,r,n){t=t||.2,e=e||.15,i=i||16770432,r=r||3375104;const o=ht.shared,[a,h,l]=o.setValue(i).toArray(),[u,c,d]=o.setValue(r).toArray(),f=[.3,.59,.11,0,0,a,h,l,t,0,u,c,d,e,0,a-u,h-c,l-d,0,0];this._loadMatrix(f,n)}night(t,e){t=t||.1;const i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,e)}predator(t,e){const i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}ja.prototype.grayscale=ja.prototype.greyscale;var wy=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,Ay=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class Ey extends et{constructor(t,e){const i=new lt;t.renderable=!1,super(Ay,wy,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,e==null&&(e=20),this.scale=new K(e,e)}apply(t,e,i,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,e,i,r)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var Sy=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,Cy=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class Py extends et{constructor(){super(Cy,Sy)}}var Ry=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class Iy extends et{constructor(t=.5,e=Math.random()){super(Cd,Ry,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const _u={AlphaFilter:Ld,BlurFilter:by,BlurFilterPass:Wa,ColorMatrixFilter:ja,DisplacementFilter:Ey,FXAAFilter:Py,NoiseFilter:Iy};Object.entries(_u).forEach(([s,t])=>{Object.defineProperty(_u,s,{get(){return Z("7.1.0",`filters.${s} has moved to ${s}`),t}})});class My{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(Nt.system.add(this.tickerUpdate,this,vi.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Nt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const hi=new My;class Os{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Os.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new K,this.page=new K,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,i,r,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Un extends Os{constructor(){super(...arguments),this.client=new K,this.movement=new K,this.offset=new K,this.global=new K,this.screen=new K}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,r,n,o,a,h,l,u,c,d,f,m,p){throw new Error("Method not implemented.")}}class pe extends Un{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Cr extends Un{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Cr.DOM_DELTA_PIXEL=0,Cr.DOM_DELTA_LINE=1,Cr.DOM_DELTA_PAGE=2;const Dy=2048,Fy=new K,Xo=new K;class Oy{constructor(t){this.dispatch=new Ms,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((i,r)=>i.priority-r.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let i=0,r=e.length;i<r;i++)e[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){hi.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",r=this[i](this.rootTarget,this.rootTarget.eventMode,Fy.set(t,e),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(t,e){if(!t.target)return;const i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,n=i.length-1;r<n;r++)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,i=this._allInteractiveElements){if(i.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const r=Array.isArray(e)?e:[e];for(let n=i.length-1;n>=0;n--)r.forEach(o=>{t.currentTarget=i[n],this.notifyTarget(t,o)})}propagationPath(t){const e=[t];for(let i=0;i<Dy&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,i,r,n,o=!1){let a=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(hi.pauseUpdate=!1),t.interactiveChildren&&t.children){const u=t.children;for(let c=u.length-1;c>=0;c--){const d=u[c],f=this.hitTestMoveRecursive(d,this._isInteractive(e)?e:d.eventMode,i,r,n,o||n(t,i));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const m=t.isInteractive();(f.length>0||m)&&(m&&this._allInteractiveElements.push(t),f.push(t)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const h=this._isInteractive(e),l=t.isInteractive();return h&&l&&this._allInteractiveElements.push(t),o||this._hitElements.length>0?null:a?this._hitElements:h&&!n(t,i)&&r(t,i)?l?[t]:[]:null}hitTestRecursive(t,e,i,r,n){if(this._interactivePrune(t)||n(t,i))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(hi.pauseUpdate=!1),t.interactiveChildren&&t.children){const h=t.children;for(let l=h.length-1;l>=0;l--){const u=h[l],c=this.hitTestRecursive(u,this._isInteractive(e)?e:u.eventMode,i,r,n);if(c){if(c.length>0&&!c[c.length-1].parent)continue;const d=t.isInteractive();return(c.length>0||d)&&c.push(t),c}}}const o=this._isInteractive(e),a=t.isInteractive();return o&&r(t,i)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,e){var i;if(t.hitArea&&(t.worldTransform.applyInverse(e,Xo),!t.hitArea.contains(Xo.x,Xo.y)))return!0;if(t._mask){const r=t._mask.isMaskData?t._mask.maskObject:t._mask;if(r&&!((i=r.containsPoint)!=null&&i.call(r,e)))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var n,o;e=e??t.type;const i=`on${e}`;(o=(n=t.currentTarget)[i])==null||o.call(n,t);const r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof pe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const r=e.button===2;this.dispatchEvent(e,r?"rightdown":"mousedown")}const i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var h,l;if(!(t instanceof pe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const i=e.pointerType==="mouse"||e.pointerType==="pen",r=this.trackingData(t.pointerId),n=this.findMountedTarget(r.overTargets);if(((h=r.overTargets)==null?void 0:h.length)>0&&n!==e.target){const u=t.type==="mousemove"?"mouseout":"pointerout",c=this.createPointerEvent(t,u,n);if(this.dispatchEvent(c,"pointerout"),i&&this.dispatchEvent(c,"mouseout"),!e.composedPath().includes(n)){const d=this.createPointerEvent(t,"pointerleave",n);for(d.eventPhase=d.AT_TARGET;d.target&&!e.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),i&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(c)}if(n!==e.target){const u=t.type==="mousemove"?"mouseover":"pointerover",c=this.clonePointerEvent(e,u);this.dispatchEvent(c,"pointerover"),i&&this.dispatchEvent(c,"mouseover");let d=n==null?void 0:n.parent;for(;d&&d!==this.rootTarget.parent&&d!==e.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const f=this.clonePointerEvent(e,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==n&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),i&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(c)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(e,"pointermove"),a&&o.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),a&&o.push("globaltouchmove")),i&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(l=e.target)==null?void 0:l.cursor),o.length>0&&this.all(e,o),this._allInteractiveElements.length=0,this._hitElements.length=0,r.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var o;if(!(t instanceof pe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),i=this.createPointerEvent(t),r=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),r&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=(o=i.target)==null?void 0:o.cursor);const n=this.clonePointerEvent(i,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),r&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;e.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof pe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const i=t.pointerType==="mouse"||t.pointerType==="pen",r=this.findMountedTarget(e.overTargets),n=this.createPointerEvent(t,"pointerout",r);this.dispatchEvent(n),i&&this.dispatchEvent(n,"mouseout");const o=this.createPointerEvent(t,"pointerleave",r);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;e.overTargets=null,this.freeEvent(n),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof pe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}const r=this.trackingData(t.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[t.button]);let o=n;if(n&&!i.composedPath().includes(n)){let a=n;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const h=i.button===2;this.notifyTarget(i,h?"rightupoutside":"mouseupoutside")}a=a.parent}delete r.pressTargetsByButton[t.button],o=a}if(o){const a=this.clonePointerEvent(i,"click");a.target=o,a.path=null,r.clicksByButton[t.button]||(r.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:e});const h=r.clicksByButton[t.button];if(h.target===a.target&&e-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=a.target,h.timeStamp=e,a.detail=h.clickCount,a.pointerType==="mouse"){const l=a.button===2;this.dispatchEvent(a,l?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof pe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),i=this.findMountedTarget(e.pressTargetsByButton[t.button]),r=this.createPointerEvent(t);if(i){let n=i;for(;n;)r.currentTarget=n,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(r)}mapWheel(t){if(!(t instanceof Cr)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){const r=this.allocateEvent(pe);return this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=i??this.hitTest(r.global.x,r.global.y)??this._hitElements[0],typeof e=="string"&&(r.type=e),r}createWheelEvent(t){const e=this.allocateEvent(Cr);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const i=this.allocateEvent(pe);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=e??i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof pe&&e instanceof pe&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Un&&e instanceof Un&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const i=t.currentTarget._events[e];if(i&&t.currentTarget.isInteractive())if("fn"in i)i.once&&t.currentTarget.removeListener(e,i.fn,void 0,!0),i.fn.call(i.context,t);else for(let r=0,n=i.length;r<n&&!t.propagationImmediatelyStopped;r++)i[r].once&&t.currentTarget.removeListener(e,i[r].fn,void 0,!0),i[r].fn.call(i[r].context,t)}}const By=1,Ly={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Ya=class qa{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new Oy(null),hi.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new pe(null),this.rootWheelEvent=new Cr(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...qa.defaultEventFeatures},{set:(e,i,r)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=r),e[i]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:e,resolution:i}=this.renderer;this.setTargetElement(e),this.resolution=i,qa._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const i=this.cursorStyles[t];if(i)switch(typeof i){case"string":e&&(this.domElement.style.cursor=i);break;case"function":i(t);break;case"object":e&&Object.assign(this.domElement.style,i);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let i=0,r=e.length;i<r;i++){const n=e[i],o=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,hi.pointerMoved();const e=this.normalizeToPointerData(t);for(let i=0,r=e.length;i<r;i++){const n=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const i=e!==this.domElement?"outside":"",r=this.normalizeToPointerData(t);for(let n=0,o=r.length;n<o;n++){const a=this.bootstrapEvent(this.rootPointerEvent,r[n]);a.type+=i,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);for(let i=0,r=e.length;i<r;i++){const n=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,hi.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;hi.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;hi.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,i){const r=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},n=1/this.resolution;t.x=(e-r.left)*(this.domElement.width/r.width)*n,t.y=(i-r.top)*(this.domElement.height/r.height)*n}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let i=0,r=t.changedTouches.length;i<r;i++){const n=t.changedTouches[i];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=t.type,e.push(n)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const i=t;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=By),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,e.push(i)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=Ly[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};Ya.extension={name:"events",type:[B.RendererSystem,B.CanvasRendererSystem]},Ya.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let Ka=Ya;H.add(Ka);function yu(s){return s==="dynamic"||s==="static"}const ky={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??yu(Ka.defaultEventMode)},set interactive(s){Z("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=s,this.eventMode=s?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Ka.defaultEventMode},set eventMode(s){this._internalInteractive=yu(s),this._internalEventMode=s},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(s,t,e){const i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof e=="object"?e.signal:void 0,n=typeof e=="object"?e.once===!0:!1,o=typeof t=="function"?void 0:t;s=i?`${s}capture`:s;const a=typeof t=="function"?t:t.handleEvent,h=this;r&&r.addEventListener("abort",()=>{h.off(s,a,o)}),n?h.once(s,a,o):h.on(s,a,o)},removeEventListener(s,t,e){const i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof t=="function"?void 0:t;s=i?`${s}capture`:s,t=typeof t=="function"?t:t.handleEvent,this.off(s,t,r)},dispatchEvent(s){if(!(s instanceof Os))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return s.defaultPrevented=!1,s.path=null,s.target=this,s.manager.dispatchEvent(s),!s.defaultPrevented}};gt.mixin(ky);const Ny={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};gt.mixin(Ny);const Uy=9,Js=100,Gy=0,zy=0,vu=2,xu=1,Hy=-1e3,$y=-1e3,Xy=2;class kd{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Ye.tablet||Ye.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${Js}px`,e.style.height=`${Js}px`,e.style.position="absolute",e.style.top=`${Gy}px`,e.style.left=`${zy}px`,e.style.zIndex=vu.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${xu}px`,t.style.height=`${xu}px`,t.style.position="absolute",t.style.top=`${Hy}px`,t.style.left=`${$y}px`,t.style.zIndex=Xy.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let i=0;i<e.length;i++)this.updateAccessibleObjects(e[i])}update(){const t=performance.now();if(Ye.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:i,width:r,height:n}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:h}=this.renderer,l=r/o*h,u=n/a*h;let c=this.div;c.style.left=`${e}px`,c.style.top=`${i}px`,c.style.width=`${o}px`,c.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){const f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,Er(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{c=f._accessibleDiv;let m=f.hitArea;const p=f.worldTransform;f.hitArea?(c.style.left=`${(p.tx+m.x*p.a)*l}px`,c.style.top=`${(p.ty+m.y*p.d)*u}px`,c.style.width=`${m.width*p.a*l}px`,c.style.height=`${m.height*p.d*u}px`):(m=f.getBounds(),this.capHitArea(m),c.style.left=`${m.x*l}px`,c.style.top=`${m.y*u}px`,c.style.width=`${m.width*l}px`,c.style.height=`${m.height*u}px`,c.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(c.title=f.accessibleTitle),c.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&c.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==c.title||f.tabIndex!==c.tabIndex)&&(c.title=f.accessibleTitle,c.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(c))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:i}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${Js}px`,e.style.height=`${Js}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=vu.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:i}=t.target,r=this.renderer.events.rootBoundary,n=Object.assign(new Os(r),{target:i});r.rootTarget=this.renderer.lastObjectRendered,e.forEach(o=>r.dispatchEvent(n,o))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===Uy&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}kd.extension={name:"accessibility",type:[B.RendererPlugin,B.CanvasRendererPlugin]};H.add(kd);const Nd=class Za{constructor(t){this.stage=new nt,t=Object.assign({forceCanvas:!1},t),this.renderer=ey(t),Za._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){var t;return(t=this.renderer)==null?void 0:t.view}get screen(){var t;return(t=this.renderer)==null?void 0:t.screen}destroy(t,e){const i=Za._plugins.slice(0);i.reverse(),i.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Nd._plugins=[];let Ud=Nd;H.handleByList(B.Application,Ud._plugins);class Gd{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,i;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:n}=this._resizeTo;e=r,i=n}this.renderer.resize(e,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Gd.extension=B.Application;H.add(Gd);const bu={loader:B.LoadParser,resolver:B.ResolveParser,cache:B.CacheParser,detection:B.DetectionParser};H.handle(B.Asset,s=>{const t=s.ref;Object.entries(bu).filter(([e])=>!!t[e]).forEach(([e,i])=>H.add(Object.assign(t[e],{extension:t[e].extension??i})))},s=>{const t=s.ref;Object.keys(bu).filter(e=>!!t[e]).forEach(e=>H.remove(t[e]))});class Vy{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function Xr(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function Ai(s,t){const e=s.split("?")[0],i=Ft.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const me=(s,t,e=!1)=>(Array.isArray(s)||(s=[s]),t?s.map(i=>typeof i=="string"||e?t(i):i):s),Qa=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s};function zd(s,t,e,i,r){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?zd(s.replace(i[e],a),t,e+1,i,r):r.push(s.replace(i[e],a))}}function Wy(s){const t=/\{(.*?)\}/g,e=s.match(t),i=[];if(e){const r=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),zd(s,r,0,e,i)}else i.push(s);return i}const Gn=s=>!Array.isArray(s);class jy{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=me(t);let r;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(e)){r=h.getCacheableAssets(i,e);break}}r||(r={},i.forEach(a=>{r[a]=e}));const n=Object.keys(r),o={cacheKeys:n,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])}),e instanceof U){const a=e;i.forEach(h=>{a.baseTexture!==U.EMPTY.baseTexture&&j.addToCache(a.baseTexture,h),U.addToCache(a,h)})}}remove(t){if(!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(i=>{this._cache.delete(i)}),e.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const Ni=new jy;class Yy{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{var o,a;let r=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.load&&((o=l.test)!=null&&o.call(l,t,e,this))){n=l;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await n.load(t,e,this),i.parser=n;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];l.parse&&l.parse&&await((a=l.testParse)==null?void 0:a.call(l,r,e,this))&&(r=await l.parse(r,e,this)||r,i.parser=l)}return r})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const r={},n=Gn(t),o=me(t,l=>({alias:[l],src:l})),a=o.length,h=o.map(async l=>{const u=Ft.toAbsolute(l.src);if(!r[l.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,l)),r[l.src]=await this.promiseCache[u].promise,e&&e(++i/a)}catch(c){throw delete this.promiseCache[u],delete r[l.src],new Error(`[Loader.load] Failed to load ${u}.
${c}`)}});return await Promise.all(h),n?r[o[0].src]:r}async unload(t){const e=me(t,i=>({alias:[i],src:i})).map(async i=>{var o,a;const r=Ft.toAbsolute(i.src),n=this.promiseCache[r];if(n){const h=await n.promise;delete this.promiseCache[r],(a=(o=n.parser)==null?void 0:o.unload)==null||a.call(o,h,i,this)}});await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}}var ve=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(ve||{});const qy=".json",Ky="application/json",Zy={extension:{type:B.LoadParser,priority:ve.Low},name:"loadJson",test(s){return Xr(s,Ky)||Ai(s,qy)},async load(s){return await(await k.ADAPTER.fetch(s)).json()}};H.add(Zy);const Qy=".txt",Jy="text/plain",tv={name:"loadTxt",extension:{type:B.LoadParser,priority:ve.Low},test(s){return Xr(s,Jy)||Ai(s,Qy)},async load(s){return await(await k.ADAPTER.fetch(s)).text()}};H.add(tv);const ev=["normal","bold","100","200","300","400","500","600","700","800","900"],iv=[".ttf",".otf",".woff",".woff2"],rv=["font/ttf","font/otf","font/woff","font/woff2"],sv=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function nv(s){const t=Ft.extname(s),e=Ft.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1));let i=e.length>0;for(const n of e)if(!n.match(sv)){i=!1;break}let r=e.join(" ");return i||(r=`"${r.replace(/[\\"]/g,"\\$&")}"`),r}const ov=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function av(s){return ov.test(s)?s:encodeURI(s)}const hv={extension:{type:B.LoadParser,priority:ve.Low},name:"loadWebFont",test(s){return Xr(s,rv)||Ai(s,iv)},async load(s,t){var i,r,n;const e=k.ADAPTER.getFontFaceSet();if(e){const o=[],a=((i=t.data)==null?void 0:i.family)??nv(s),h=((n=(r=t.data)==null?void 0:r.weights)==null?void 0:n.filter(u=>ev.includes(u)))??["normal"],l=t.data??{};for(let u=0;u<h.length;u++){const c=h[u],d=new FontFace(a,`url(${av(s)})`,{...l,weight:c});await d.load(),e.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(t=>k.ADAPTER.getFontFaceSet().delete(t))}};H.add(hv);const lv=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let Pr=null,Ja=class{constructor(){Pr||(Pr=URL.createObjectURL(new Blob([lv],{type:"application/javascript"}))),this.worker=new Worker(Pr)}};Ja.revokeObjectURL=function(){Pr&&(URL.revokeObjectURL(Pr),Pr=null)};const uv=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let Rr=null;class Hd{constructor(){Rr||(Rr=URL.createObjectURL(new Blob([uv],{type:"application/javascript"}))),this.worker=new Worker(Rr)}}Hd.revokeObjectURL=function(){Rr&&(URL.revokeObjectURL(Rr),Rr=null)};let Tu=0,Vo;class cv{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new Ja;e.addEventListener("message",i=>{e.terminate(),Ja.revokeObjectURL(),t(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Vo===void 0&&(Vo=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Vo&&(this._createdWorkers++,t=new Hd().worker,t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((r,n)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:n})});return this.next(),i}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),i=e.id;this.resolveHash[Tu]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Tu++,id:i})}}const wu=new cv;function Bs(s,t,e){s.resource.internal=!0;const i=new U(s),r=()=>{delete t.promiseCache[e],Ni.has(e)&&Ni.remove(e)};return i.baseTexture.once("destroyed",()=>{e in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),r())}),i.once("destroyed",()=>{s.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),i}const dv=[".jpeg",".jpg",".png",".webp",".avif"],fv=["image/jpeg","image/png","image/webp","image/avif"];async function pv(s){const t=await k.ADAPTER.fetch(s);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const ao={name:"loadTextures",extension:{type:B.LoadParser,priority:ve.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return Xr(s,fv)||Ai(s,dv)},async load(s,t,e){var a;const i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let r;i?this.config.preferWorkers&&await wu.isImageBitmapSupported()?r=await wu.loadImageBitmap(s):r=await pv(s):r=await new Promise((h,l)=>{const u=new Image;u.crossOrigin=this.config.crossOrigin,u.src=s,u.complete?h(u):(u.onload=()=>h(u),u.onerror=c=>l(c))});const n={...t.data};n.resolution??(n.resolution=Qe(s)),i&&((a=n.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(n.resourceOptions={...n.resourceOptions},n.resourceOptions.ownsImageBitmap=!0);const o=new j(r,n);return o.resource.src=s,Bs(o,e,s)},unload(s){s.destroy(!0)}};H.add(ao);const mv=".svg",gv="image/svg+xml",_v={extension:{type:B.LoadParser,priority:ve.High},name:"loadSVG",test(s){return Xr(s,gv)||Ai(s,mv)},async testParse(s){return Ha.test(s)},async parse(s,t,e){var n;const i=new Ha(s,(n=t==null?void 0:t.data)==null?void 0:n.resourceOptions);await i.load();const r=new j(i,{resolution:Qe(s),...t==null?void 0:t.data});return r.resource.src=t.src,Bs(r,e,t.src)},async load(s,t){return(await k.ADAPTER.fetch(s)).text()},unload:ao.unload};H.add(_v);const yv=[".mp4",".m4v",".webm",".ogv"],vv=["video/mp4","video/webm","video/ogg"],xv={name:"loadVideo",extension:{type:B.LoadParser,priority:ve.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(s){return Xr(s,vv)||Ai(s,yv)},async load(s,t,e){var o;let i;const r=await(await k.ADAPTER.fetch(s)).blob(),n=URL.createObjectURL(r);try{const a={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=t==null?void 0:t.data)==null?void 0:o.resourceOptions,autoLoad:!0},h=new Fd(n,a);await h.load();const l=new j(h,{alphaMode:await I_(),resolution:Qe(s),...t==null?void 0:t.data});l.resource.src=s,i=Bs(l,e,s),i.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(n)})}catch(a){throw URL.revokeObjectURL(n),a}return i},unload(s){s.destroy(!0)}};H.add(xv);class bv{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}getAlias(t){const{alias:e,name:i,src:r,srcs:n}=t;return me(e||i||r||n,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];Array.isArray(e)?e.forEach(r=>{const n=r.src??r.srcs,o=r.alias??r.name;let a;if(typeof o=="string"){const h=this._createBundleAssetId(t,o);i.push(h),a=[o,h]}else{const h=o.map(l=>this._createBundleAssetId(t,l));i.push(...h),a=[...o,...h]}this.add({...r,alias:a,src:n})}):Object.keys(e).forEach(r=>{const n=[r,this._createBundleAssetId(t,r)];if(typeof e[r]=="string")this.add({alias:n,src:e[r]});else if(Array.isArray(e[r]))this.add({alias:n,src:e[r]});else{const o=e[r],a=o.src??o.srcs;this.add({...o,alias:n,src:Array.isArray(a)?a:[a]})}i.push(...n)}),this._bundles[t]=i}add(t,e,i,r,n){const o=[];typeof t=="string"||Array.isArray(t)&&typeof t[0]=="string"?(Z("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:t,src:e,data:i,format:r,loadParser:n})):Array.isArray(t)?o.push(...t):o.push(t);let a;a=h=>{this.hasKey(h)&&console.warn(`[Resolver] already has key: ${h} overwriting`)},me(o).forEach(h=>{const{src:l,srcs:u}=h;let{data:c,format:d,loadParser:f}=h;const m=me(l||u).map(y=>typeof y=="string"?Wy(y):Array.isArray(y)?y:[y]),p=this.getAlias(h);Array.isArray(p)?p.forEach(a):a(p);const g=[];m.forEach(y=>{y.forEach(x=>{let _={};if(typeof x!="object"){_.src=x;for(let v=0;v<this._parsers.length;v++){const b=this._parsers[v];if(b.test(x)){_=b.parse(x);break}}}else c=x.data??c,d=x.format??d,f=x.loadParser??f,_={..._,...x};if(!p)throw new Error(`[Resolver] alias is undefined for this asset: ${_.src}`);_=this.buildResolvedAsset(_,{aliases:p,data:c,format:d,loadParser:f}),g.push(_)})}),p.forEach(y=>{this._assetMap[y]=g})})}resolveBundle(t){const e=Gn(t);t=me(t);const i={};return t.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const h in o){const l=o[h];a[this._extractAssetIdFromBundle(r,h)]=l}i[r]=a}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const r in e)i[r]=e[r].src;return i}return e.src}resolve(t){const e=Gn(t);t=me(t);const i={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=n[0],a=this._getPreferredOrder(n);a==null||a.priority.forEach(h=>{a.params[h].forEach(l=>{const u=n.filter(c=>c[h]?c[h]===l:!1);u.length&&(n=u)})}),this._resolverHash[r]=n[0]??o}else this._resolverHash[r]=this.buildResolvedAsset({alias:[r],src:r},{});i[r]=this._resolverHash[r]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[0],r=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}buildResolvedAsset(t,e){const{aliases:i,data:r,loadParser:n,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=Ft.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=n??t.loadParser,t.format=o??t.format??Ft.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}}class Tv{constructor(){this._detections=[],this._initialized=!1,this.resolver=new bv,this.loader=new Yy,this.cache=Ni,this._backgroundLoader=new Vy(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let a=t.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,i=typeof e=="number"?[e]:e,r=await this._detectFormats({preferredFormats:(o=t.texturePreference)==null?void 0:o.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,i,r,n){this.resolver.add(t,e,i,r,n)}async load(t,e){this._initialized||await this.init();const i=Gn(t),r=me(t).map(a=>{if(typeof a!="string"){const h=this.resolver.getAlias(a);return h.some(l=>!this.resolver.hasKey(l))&&this.add(a),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),n=this.resolver.resolve(r),o=await this._mapLoadToResolve(n,e);return i?o[r[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},o=Object.keys(r);let a=0,h=0;const l=()=>{e==null||e(++a/h)},u=o.map(c=>{const d=r[c];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{n[c]=f})});return await Promise.all(u),i?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Ni.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=Ni.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(i,e);this._backgroundLoader.active=!0;const o={};return i.forEach((a,h)=>{const l=n[a.src],u=[a.src];a.alias&&u.push(...a.alias),o[r[h]]=l,Ni.set(u,l)}),o}async unload(t){this._initialized||await this.init();const e=me(t).map(r=>typeof r!="string"?r.src:r),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=me(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{Ni.remove(i.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const i of t.detections)t.skipDetections||await i.test()?e=await i.add(e):t.skipDetections||(e=await i.remove(e));return e=e.filter((i,r)=>e.indexOf(i)===r),e}get detections(){return this._detections}get preferWorkers(){return ao.config.preferWorkers}set preferWorkers(t){Z("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}}const is=new Tv;H.handleByList(B.LoadParser,is.loader.parsers).handleByList(B.ResolveParser,is.resolver.parsers).handleByList(B.CacheParser,is.cache.parsers).handleByList(B.DetectionParser,is.detections);const wv={extension:B.CacheParser,test:s=>Array.isArray(s)&&s.every(t=>t instanceof U),getCacheableAssets:(s,t)=>{const e={};return s.forEach(i=>{t.forEach((r,n)=>{e[i+(n===0?"":n+1)]=r})}),e}};H.add(wv);async function $d(s){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=s});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(s)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const Av={extension:{type:B.DetectionParser,priority:1},test:async()=>$d("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")};H.add(Av);const Ev={extension:{type:B.DetectionParser,priority:0},test:async()=>$d("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")};H.add(Ev);const Au=["png","jpg","jpeg"],Sv={extension:{type:B.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...Au],remove:async s=>s.filter(t=>!Au.includes(t))};H.add(Sv);const Cv="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Uh(s){return Cv?!1:document.createElement("video").canPlayType(s)!==""}const Pv={extension:{type:B.DetectionParser,priority:0},test:async()=>Uh("video/webm"),add:async s=>[...s,"webm"],remove:async s=>s.filter(t=>t!=="webm")};H.add(Pv);const Rv={extension:{type:B.DetectionParser,priority:0},test:async()=>Uh("video/mp4"),add:async s=>[...s,"mp4","m4v"],remove:async s=>s.filter(t=>t!=="mp4"&&t!=="m4v")};H.add(Rv);const Iv={extension:{type:B.DetectionParser,priority:0},test:async()=>Uh("video/ogg"),add:async s=>[...s,"ogv"],remove:async s=>s.filter(t=>t!=="ogv")};H.add(Iv);const Mv={extension:B.ResolveParser,test:ao.test,parse:s=>{var t;return{resolution:parseFloat(((t=k.RETINA_PREFIX.exec(s))==null?void 0:t[1])??"1"),format:Ft.extname(s).slice(1),src:s}}};H.add(Mv);var Lt=(s=>(s[s.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",s[s.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",s[s.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",s[s.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",s[s.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",s[s.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",s[s.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",s[s.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",s[s.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",s[s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",s[s.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",s[s.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",s[s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",s[s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",s[s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",s[s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",s[s.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",s[s.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",s[s.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",s[s.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",s[s.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",s[s.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",s[s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",s[s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",s[s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",s))(Lt||{});const zn={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Ee,pr;function Eu(){pr={bptc:Ee.getExtension("EXT_texture_compression_bptc"),astc:Ee.getExtension("WEBGL_compressed_texture_astc"),etc:Ee.getExtension("WEBGL_compressed_texture_etc"),s3tc:Ee.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Ee.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Ee.getExtension("WEBGL_compressed_texture_pvrtc")||Ee.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Ee.getExtension("WEBGL_compressed_texture_etc1"),atc:Ee.getExtension("WEBGL_compressed_texture_atc")}}const Dv={extension:{type:B.DetectionParser,priority:2},test:async()=>{const s=k.ADAPTER.createCanvas().getContext("webgl");return s?(Ee=s,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async s=>{pr||Eu();const t=[];for(const e in pr)pr[e]&&t.push(e);return[...t,...s]},remove:async s=>(pr||Eu(),s.filter(t=>!(t in pr)))};H.add(Dv);class Fv extends io{constructor(t,e={width:1,height:1,autoLoad:!0}){let i,r;typeof t=="string"?(i=t,r=new Uint8Array):(i=null,r=t),super(r,e),this.origin=i,this.buffer=r?new Pa(r):null,this._load=null,this.loaded=!1,this.origin!==null&&e.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new Pa(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class Vi extends Fv{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=Vi._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||Vi._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,i){const r=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;r.pixelStorei(r.UNPACK_ALIGNMENT,4);for(let n=0,o=this.levels;n<o;n++){const{levelID:a,levelWidth:h,levelHeight:l,levelBuffer:u}=this._levelBuffers[n];r.compressedTexImage2D(r.TEXTURE_2D,a,this.format,h,l,0,u)}return!0}onBlobLoaded(){this._levelBuffers=Vi._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=35916&&t<=35919)return"s3tc_sRGB";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t===36196)return"etc1";if(t===35986||t===35987||t===34798)return"atc";if(t>=36492&&t<=36495)return"bptc";if(t===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${t}`)}static _createLevelBuffers(t,e,i,r,n,o,a){const h=new Array(i);let l=t.byteOffset,u=o,c=a,d=u+r-1&~(r-1),f=c+n-1&~(n-1),m=d*f*zn[e];for(let p=0;p<i;p++)h[p]={levelID:p,levelWidth:i>1?u:d,levelHeight:i>1?c:f,levelBuffer:new Uint8Array(t.buffer,l,m)},l+=m,u=u>>1||1,c=c>>1||1,d=u+r-1&~(r-1),f=c+n-1&~(n-1),m=d*f*zn[e];return h}}const Wo=4,tn=124,Ov=32,Su=20,Bv=542327876,en={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},Lv={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},rn={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},kv=1,Nv=2,Uv=4,Gv=64,zv=512,Hv=131072,$v=827611204,Xv=861165636,Vv=894720068,Wv=808540228,jv=4,Yv={[$v]:Lt.COMPRESSED_RGBA_S3TC_DXT1_EXT,[Xv]:Lt.COMPRESSED_RGBA_S3TC_DXT3_EXT,[Vv]:Lt.COMPRESSED_RGBA_S3TC_DXT5_EXT},qv={70:Lt.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Lt.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Lt.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Lt.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Lt.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Lt.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:Lt.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:Lt.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:Lt.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:Lt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function Kv(s){const t=new Uint32Array(s);if(t[0]!==Bv)throw new Error("Invalid DDS file magic word");const e=new Uint32Array(s,0,tn/Uint32Array.BYTES_PER_ELEMENT),i=e[en.HEIGHT],r=e[en.WIDTH],n=e[en.MIPMAP_COUNT],o=new Uint32Array(s,en.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,Ov/Uint32Array.BYTES_PER_ELEMENT),a=o[kv];if(a&Uv){const h=o[Lv.FOURCC];if(h!==Wv){const x=Yv[h],_=Wo+tn,v=new Uint8Array(s,_);return[new Vi(v,{format:x,width:r,height:i,levels:n})]}const l=Wo+tn,u=new Uint32Array(t.buffer,l,Su/Uint32Array.BYTES_PER_ELEMENT),c=u[rn.DXGI_FORMAT],d=u[rn.RESOURCE_DIMENSION],f=u[rn.MISC_FLAG],m=u[rn.ARRAY_SIZE],p=qv[c];if(p===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${c}`);if(f===jv)throw new Error("DDSParser does not support cubemap textures");if(d===6)throw new Error("DDSParser does not supported 3D texture data");const g=new Array,y=Wo+tn+Su;if(m===1)g.push(new Uint8Array(s,y));else{const x=zn[p];let _=0,v=r,b=i;for(let w=0;w<n;w++){const T=Math.max(1,v+3&-4),E=Math.max(1,b+3&-4),I=T*E*x;_+=I,v=v>>>1,b=b>>>1}let S=y;for(let w=0;w<m;w++)g.push(new Uint8Array(s,S,_)),S+=_}return g.map(x=>new Vi(x,{format:p,width:r,height:i,levels:n}))}throw a&Gv?new Error("DDSParser does not support uncompressed texture data."):a&zv?new Error("DDSParser does not supported YUV uncompressed texture data."):a&Hv?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&Nv?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Cu=[171,75,84,88,32,49,49,187,13,10,26,10],Zv=67305985,de={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},th=64,Pu={[V.UNSIGNED_BYTE]:1,[V.UNSIGNED_SHORT]:2,[V.INT]:4,[V.UNSIGNED_INT]:4,[V.FLOAT]:4,[V.HALF_FLOAT]:8},Qv={[M.RGBA]:4,[M.RGB]:3,[M.RG]:2,[M.RED]:1,[M.LUMINANCE]:1,[M.LUMINANCE_ALPHA]:2,[M.ALPHA]:1},Jv={[V.UNSIGNED_SHORT_4_4_4_4]:2,[V.UNSIGNED_SHORT_5_5_5_1]:2,[V.UNSIGNED_SHORT_5_6_5]:2};function tx(s,t,e=!1){const i=new DataView(t);if(!ex(s,i))return null;const r=i.getUint32(de.ENDIANNESS,!0)===Zv,n=i.getUint32(de.GL_TYPE,r),o=i.getUint32(de.GL_FORMAT,r),a=i.getUint32(de.GL_INTERNAL_FORMAT,r),h=i.getUint32(de.PIXEL_WIDTH,r),l=i.getUint32(de.PIXEL_HEIGHT,r)||1,u=i.getUint32(de.PIXEL_DEPTH,r)||1,c=i.getUint32(de.NUMBER_OF_ARRAY_ELEMENTS,r)||1,d=i.getUint32(de.NUMBER_OF_FACES,r),f=i.getUint32(de.NUMBER_OF_MIPMAP_LEVELS,r),m=i.getUint32(de.BYTES_OF_KEY_VALUE_DATA,r);if(l===0||u!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(c!==1)throw new Error("WebGL does not support array textures");const p=4,g=4,y=h+3&-4,x=l+3&-4,_=new Array(c);let v=h*l;n===0&&(v=y*x);let b;if(n!==0?Pu[n]?b=Pu[n]*Qv[o]:b=Jv[n]:b=zn[a],b===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const S=e?rx(i,m,r):null;let w=v*b,T=h,E=l,I=y,z=x,R=th+m;for(let A=0;A<f;A++){const P=i.getUint32(R,r);let O=R+4;for(let G=0;G<c;G++){let L=_[G];L||(L=_[G]=new Array(f)),L[A]={levelID:A,levelWidth:f>1||n!==0?T:I,levelHeight:f>1||n!==0?E:z,levelBuffer:new Uint8Array(t,O,w)},O+=w}R+=P+4,R=R%4!==0?R+4-R%4:R,T=T>>1||1,E=E>>1||1,I=T+p-1&~(p-1),z=E+g-1&~(g-1),w=I*z*b}return n!==0?{uncompressed:_.map(A=>{let P=A[0].levelBuffer,O=!1;return n===V.FLOAT?P=new Float32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4):n===V.UNSIGNED_INT?(O=!0,P=new Uint32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)):n===V.INT&&(O=!0,P=new Int32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)),{resource:new io(P,{width:A[0].levelWidth,height:A[0].levelHeight}),type:n,format:O?ix(o):o}}),kvData:S}:{compressed:_.map(A=>new Vi(null,{format:a,width:h,height:l,levels:f,levelBuffers:A})),kvData:S}}function ex(s,t){for(let e=0;e<Cu.length;e++)if(t.getUint8(e)!==Cu[e])return console.error(`${s} is not a valid *.ktx file!`),!1;return!0}function ix(s){switch(s){case M.RGBA:return M.RGBA_INTEGER;case M.RGB:return M.RGB_INTEGER;case M.RG:return M.RG_INTEGER;case M.RED:return M.RED_INTEGER;default:return s}}function rx(s,t,e){const i=new Map;let r=0;for(;r<t;){const n=s.getUint32(th+r,e),o=th+r+4,a=3-(n+3)%4;if(n===0||n>t-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let h=0;for(;h<n&&s.getUint8(o+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const l=new TextDecoder().decode(new Uint8Array(s.buffer,o,h)),u=new DataView(s.buffer,o+h+1,n-h-1);i.set(l,u),r+=4+n+a}return i}const sx={extension:{type:B.LoadParser,priority:ve.High},name:"loadDDS",test(s){return Ai(s,".dds")},async load(s,t,e){const i=await(await k.ADAPTER.fetch(s)).arrayBuffer(),r=Kv(i).map(n=>{const o=new j(n,{mipmap:Ue.OFF,alphaMode:Vt.NO_PREMULTIPLIED_ALPHA,resolution:Qe(s),...t.data});return Bs(o,e,s)});return r.length===1?r[0]:r},unload(s){Array.isArray(s)?s.forEach(t=>t.destroy(!0)):s.destroy(!0)}};H.add(sx);const nx={extension:{type:B.LoadParser,priority:ve.High},name:"loadKTX",test(s){return Ai(s,".ktx")},async load(s,t,e){const i=await(await k.ADAPTER.fetch(s)).arrayBuffer(),{compressed:r,uncompressed:n,kvData:o}=tx(s,i),a=r??n,h={mipmap:Ue.OFF,alphaMode:Vt.NO_PREMULTIPLIED_ALPHA,resolution:Qe(s),...t.data},l=a.map(u=>{a===n&&Object.assign(h,{type:u.type,format:u.format});const c=u.resource??u,d=new j(c,h);return d.ktxKeyValueData=o,Bs(d,e,s)});return l.length===1?l[0]:l},unload(s){Array.isArray(s)?s.forEach(t=>t.destroy(!0)):s.destroy(!0)}};H.add(nx);const ox=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],ax={extension:B.ResolveParser,test:s=>{const t=Ft.extname(s).slice(1);return["basis","ktx","dds"].includes(t)},parse:s=>{var i,r;const t=s.split("."),e=t.pop();if(["ktx","dds"].includes(e)){const n=t.pop();if(ox.includes(n))return{resolution:parseFloat(((i=k.RETINA_PREFIX.exec(s))==null?void 0:i[1])??"1"),format:n,src:s}}return{resolution:parseFloat(((r=k.RETINA_PREFIX.exec(s))==null?void 0:r[1])??"1"),format:e,src:s}}};H.add(ax);const sn=new q,hx=4,Xd=class rs{constructor(t){this.renderer=t,this._rendererPremultipliedAlpha=!1}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}async image(t,e,i,r){const n=new Image;return n.src=await this.base64(t,e,i,r),n}async base64(t,e,i,r){const n=this.canvas(t,r);if(n.toBlob!==void 0)return new Promise((o,a)=>{n.toBlob(h=>{if(!h){a(new Error("ICanvas.toBlob failed!"));return}const l=new FileReader;l.onload=()=>o(l.result),l.onerror=a,l.readAsDataURL(h)},e,i)});if(n.toDataURL!==void 0)return n.toDataURL(e,i);if(n.convertToBlob!==void 0){const o=await n.convertToBlob({type:e,quality:i});return new Promise((a,h)=>{const l=new FileReader;l.onload=()=>a(l.result),l.onerror=h,l.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,e){const{pixels:i,width:r,height:n,flipY:o,premultipliedAlpha:a}=this._rawPixels(t,e);o&&rs._flipY(i,r,n),a&&rs._unpremultiplyAlpha(i);const h=new V_(r,n,1),l=new ImageData(new Uint8ClampedArray(i.buffer),r,n);return h.context.putImageData(l,0,0),h.canvas}pixels(t,e){const{pixels:i,width:r,height:n,flipY:o,premultipliedAlpha:a}=this._rawPixels(t,e);return o&&rs._flipY(i,r,n),a&&rs._unpremultiplyAlpha(i),i}_rawPixels(t,e){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let r,n=!1,o=!1,a,h=!1;t&&(t instanceof ke?a=t:(a=i.generateTexture(t,{region:e,resolution:i.resolution,multisample:i.multisample}),h=!0,e&&(sn.width=e.width,sn.height=e.height,e=sn)));const l=i.gl;if(a){if(r=a.baseTexture.resolution,e=e??a.frame,n=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===M.RGBA,!h){i.renderTexture.bind(a);const f=a.framebuffer.glFramebuffers[i.CONTEXT_UID];f.blitFramebuffer&&i.framebuffer.bind(f.blitFramebuffer)}}else r=i.resolution,e||(e=sn,e.width=i.width/r,e.height=i.height/r),n=!0,o=this._rendererPremultipliedAlpha,i.renderTexture.bind();const u=Math.max(Math.round(e.width*r),1),c=Math.max(Math.round(e.height*r),1),d=new Uint8Array(hx*u*c);return l.readPixels(Math.round(e.x*r),Math.round(e.y*r),u,c,l.RGBA,l.UNSIGNED_BYTE,d),h&&(a==null||a.destroy(!0)),{pixels:d,width:u,height:c,flipY:n,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(t,e,i){const r=e<<2,n=i>>1,o=new Uint8Array(r);for(let a=0;a<n;a++){const h=a*r,l=(i-a-1)*r;o.set(t.subarray(h,h+r)),t.copyWithin(h,l,l+r),t.set(o,l)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let i=0;i<e;i+=4){const r=t[i+3];if(r!==0){const n=255.001/r;t[i]=t[i]*n+.5,t[i+1]=t[i+1]*n+.5,t[i+2]=t[i+2]*n+.5}}}};Xd.extension={name:"extract",type:B.RendererSystem};let lx=Xd;H.add(lx);const Hn={build(s){const t=s.points;let e,i,r,n,o,a;if(s.type===kt.CIRC){const m=s.shape;e=m.x,i=m.y,o=a=m.radius,r=n=0}else if(s.type===kt.ELIP){const m=s.shape;e=m.x,i=m.y,o=m.width,a=m.height,r=n=0}else{const m=s.shape,p=m.width/2,g=m.height/2;e=m.x+p,i=m.y+g,o=a=Math.max(0,Math.min(m.radius,Math.min(p,g))),r=p-o,n=g-a}if(!(o>=0&&a>=0&&r>=0&&n>=0)){t.length=0;return}const h=Math.ceil(2.3*Math.sqrt(o+a)),l=h*8+(r?4:0)+(n?4:0);if(t.length=l,l===0)return;if(h===0){t.length=8,t[0]=t[6]=e+r,t[1]=t[3]=i+n,t[2]=t[4]=e-r,t[5]=t[7]=i-n;return}let u=0,c=h*4+(r?2:0)+2,d=c,f=l;{const m=r+o,p=n,g=e+m,y=e-m,x=i+p;if(t[u++]=g,t[u++]=x,t[--c]=x,t[--c]=y,n){const _=i-p;t[d++]=y,t[d++]=_,t[--f]=_,t[--f]=g}}for(let m=1;m<h;m++){const p=Math.PI/2*(m/h),g=r+Math.cos(p)*o,y=n+Math.sin(p)*a,x=e+g,_=e-g,v=i+y,b=i-y;t[u++]=x,t[u++]=v,t[--c]=v,t[--c]=_,t[d++]=_,t[d++]=b,t[--f]=b,t[--f]=x}{const m=r,p=n+a,g=e+m,y=e-m,x=i+p,_=i-p;t[u++]=g,t[u++]=x,t[--f]=_,t[--f]=g,r&&(t[u++]=y,t[u++]=x,t[--f]=_,t[--f]=y)}},triangulate(s,t){const e=s.points,i=t.points,r=t.indices;if(e.length===0)return;let n=i.length/2;const o=n;let a,h;if(s.type!==kt.RREC){const u=s.shape;a=u.x,h=u.y}else{const u=s.shape;a=u.x+u.width/2,h=u.y+u.height/2}const l=s.matrix;i.push(s.matrix?l.a*a+l.c*h+l.tx:a,s.matrix?l.b*a+l.d*h+l.ty:h),n++,i.push(e[0],e[1]);for(let u=2;u<e.length;u+=2)i.push(e[u],e[u+1]),r.push(n++,o,n);r.push(o+1,o,n)}};function Ru(s,t=!1){const e=s.length;if(e<6)return;let i=0;for(let r=0,n=s[e-2],o=s[e-1];r<e;r+=2){const a=s[r],h=s[r+1];i+=(a-n)*(h+o),n=a,o=h}if(!t&&i>0||t&&i<=0){const r=e/2;for(let n=r+r%2;n<e;n+=2){const o=e-n-2,a=e-n-1,h=n,l=n+1;[s[o],s[h]]=[s[h],s[o]],[s[a],s[l]]=[s[l],s[a]]}}}const Vd={build(s){s.points=s.shape.points.slice()},triangulate(s,t){let e=s.points;const i=s.holes,r=t.points,n=t.indices;if(e.length>=6){Ru(e,!1);const o=[];for(let l=0;l<i.length;l++){const u=i[l];Ru(u.points,!0),o.push(e.length/2),e=e.concat(u.points)}const a=Zp(e,o,2);if(!a)return;const h=r.length/2;for(let l=0;l<a.length;l+=3)n.push(a[l]+h),n.push(a[l+1]+h),n.push(a[l+2]+h);for(let l=0;l<e.length;l++)r.push(e[l])}}},ux={build(s){const t=s.shape,e=t.x,i=t.y,r=t.width,n=t.height,o=s.points;o.length=0,r>=0&&n>=0&&o.push(e,i,e+r,i,e+r,i+n,e,i+n)},triangulate(s,t){const e=s.points,i=t.points;if(e.length===0)return;const r=i.length/2;i.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},cx={build(s){Hn.build(s)},triangulate(s,t){Hn.triangulate(s,t)}};var ne=(s=>(s.MITER="miter",s.BEVEL="bevel",s.ROUND="round",s))(ne||{}),ci=(s=>(s.BUTT="butt",s.ROUND="round",s.SQUARE="square",s))(ci||{});const Lr={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(s,t=20){if(!this.adaptive||!s||isNaN(s))return t;let e=Math.ceil(s/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class Iu{static curveTo(t,e,i,r,n,o){const a=o[o.length-2],h=o[o.length-1]-e,l=a-t,u=r-e,c=i-t,d=Math.abs(h*c-l*u);if(d<1e-8||n===0)return(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e),null;const f=h*h+l*l,m=u*u+c*c,p=h*u+l*c,g=n*Math.sqrt(f)/d,y=n*Math.sqrt(m)/d,x=g*p/f,_=y*p/m,v=g*c+y*l,b=g*u+y*h,S=l*(y+x),w=h*(y+x),T=c*(g+_),E=u*(g+_),I=Math.atan2(w-b,S-v),z=Math.atan2(E-b,T-v);return{cx:v+t,cy:b+e,radius:n,startAngle:I,endAngle:z,anticlockwise:l*u>c*h}}static arc(t,e,i,r,n,o,a,h,l){const u=a-o,c=Lr._segmentsCount(Math.abs(u)*n,Math.ceil(Math.abs(u)/Fn)*40),d=u/(c*2),f=d*2,m=Math.cos(d),p=Math.sin(d),g=c-1,y=g%1/g;for(let x=0;x<=g;++x){const _=x+y*x,v=d+o+f*_,b=Math.cos(v),S=-Math.sin(v);l.push((m*b+p*S)*n+i,(m*-S+p*b)*n+r)}}}class dx{constructor(){this.reset()}begin(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Gh{static curveLength(t,e,i,r,n,o,a,h){let l=0,u=0,c=0,d=0,f=0,m=0,p=0,g=0,y=0,x=0,_=0,v=t,b=e;for(let S=1;S<=10;++S)u=S/10,c=u*u,d=c*u,f=1-u,m=f*f,p=m*f,g=p*t+3*m*u*i+3*f*c*n+d*a,y=p*e+3*m*u*r+3*f*c*o+d*h,x=v-g,_=b-y,v=g,b=y,l+=Math.sqrt(x*x+_*_);return l}static curveTo(t,e,i,r,n,o,a){const h=a[a.length-2],l=a[a.length-1];a.length-=2;const u=Lr._segmentsCount(Gh.curveLength(h,l,t,e,i,r,n,o));let c=0,d=0,f=0,m=0,p=0;a.push(h,l);for(let g=1,y=0;g<=u;++g)y=g/u,c=1-y,d=c*c,f=d*c,m=y*y,p=m*y,a.push(f*h+3*d*y*t+3*c*m*i+p*n,f*l+3*d*y*e+3*c*m*r+p*o)}}function Mu(s,t,e,i,r,n,o,a){const h=s-e*r,l=t-i*r,u=s+e*n,c=t+i*n;let d,f;o?(d=i,f=-e):(d=-i,f=e);const m=h+d,p=l+f,g=u+d,y=c+f;return a.push(m,p,g,y),2}function Ci(s,t,e,i,r,n,o,a){const h=e-s,l=i-t;let u=Math.atan2(h,l),c=Math.atan2(r-s,n-t);a&&u<c?u+=Math.PI*2:!a&&u>c&&(c+=Math.PI*2);let d=u;const f=c-u,m=Math.abs(f),p=Math.sqrt(h*h+l*l),g=(15*m*Math.sqrt(p)/Math.PI>>0)+1,y=f/g;if(d+=y,a){o.push(s,t,e,i);for(let x=1,_=d;x<g;x++,_+=y)o.push(s,t,s+Math.sin(_)*p,t+Math.cos(_)*p);o.push(s,t,r,n)}else{o.push(e,i,s,t);for(let x=1,_=d;x<g;x++,_+=y)o.push(s+Math.sin(_)*p,t+Math.cos(_)*p,s,t);o.push(r,n,s,t)}return g*2}function fx(s,t){const e=s.shape;let i=s.points||e.points.slice();const r=t.closePointEps;if(i.length===0)return;const n=s.lineStyle,o=new K(i[0],i[1]),a=new K(i[i.length-2],i[i.length-1]),h=e.type!==kt.POLY||e.closeStroke,l=Math.abs(o.x-a.x)<r&&Math.abs(o.y-a.y)<r;if(h){i=i.slice(),l&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));const L=(o.x+a.x)*.5,X=(a.y+o.y)*.5;i.unshift(L,X),i.push(L,X)}const u=t.points,c=i.length/2;let d=i.length;const f=u.length/2,m=n.width/2,p=m*m,g=n.miterLimit*n.miterLimit;let y=i[0],x=i[1],_=i[2],v=i[3],b=0,S=0,w=-(x-v),T=y-_,E=0,I=0,z=Math.sqrt(w*w+T*T);w/=z,T/=z,w*=m,T*=m;const R=n.alignment,A=(1-R)*2,P=R*2;h||(n.cap===ci.ROUND?d+=Ci(y-w*(A-P)*.5,x-T*(A-P)*.5,y-w*A,x-T*A,y+w*P,x+T*P,u,!0)+2:n.cap===ci.SQUARE&&(d+=Mu(y,x,w,T,A,P,!0,u))),u.push(y-w*A,x-T*A,y+w*P,x+T*P);for(let L=1;L<c-1;++L){y=i[(L-1)*2],x=i[(L-1)*2+1],_=i[L*2],v=i[L*2+1],b=i[(L+1)*2],S=i[(L+1)*2+1],w=-(x-v),T=y-_,z=Math.sqrt(w*w+T*T),w/=z,T/=z,w*=m,T*=m,E=-(v-S),I=_-b,z=Math.sqrt(E*E+I*I),E/=z,I/=z,E*=m,I*=m;const X=_-y,rt=x-v,D=_-b,F=S-v,Y=X*D+rt*F,it=rt*D-F*X,Q=it<0;if(Math.abs(it)<.001*Math.abs(Y)){u.push(_-w*A,v-T*A,_+w*P,v+T*P),Y>=0&&(n.join===ne.ROUND?d+=Ci(_,v,_-w*A,v-T*A,_-E*A,v-I*A,u,!1)+4:d+=2,u.push(_-E*P,v-I*P,_+E*A,v+I*A));continue}const ot=(-w+y)*(-T+v)-(-w+_)*(-T+x),bt=(-E+b)*(-I+v)-(-E+_)*(-I+S),Pt=(X*bt-D*ot)/it,Ut=(F*ot-rt*bt)/it,Zt=(Pt-_)*(Pt-_)+(Ut-v)*(Ut-v),Bt=_+(Pt-_)*A,ut=v+(Ut-v)*A,Tt=_-(Pt-_)*P,Et=v-(Ut-v)*P,xe=Math.min(X*X+rt*rt,D*D+F*F),be=Q?A:P,Vr=xe+be*be*p,Cp=Zt<=Vr;let ks=n.join;if(ks===ne.MITER&&Zt/p>g&&(ks=ne.BEVEL),Cp)switch(ks){case ne.MITER:{u.push(Bt,ut,Tt,Et);break}case ne.BEVEL:{Q?u.push(Bt,ut,_+w*P,v+T*P,Bt,ut,_+E*P,v+I*P):u.push(_-w*A,v-T*A,Tt,Et,_-E*A,v-I*A,Tt,Et),d+=2;break}case ne.ROUND:{Q?(u.push(Bt,ut,_+w*P,v+T*P),d+=Ci(_,v,_+w*P,v+T*P,_+E*P,v+I*P,u,!0)+4,u.push(Bt,ut,_+E*P,v+I*P)):(u.push(_-w*A,v-T*A,Tt,Et),d+=Ci(_,v,_-w*A,v-T*A,_-E*A,v-I*A,u,!1)+4,u.push(_-E*A,v-I*A,Tt,Et));break}}else{switch(u.push(_-w*A,v-T*A,_+w*P,v+T*P),ks){case ne.MITER:{Q?u.push(Tt,Et,Tt,Et):u.push(Bt,ut,Bt,ut),d+=2;break}case ne.ROUND:{Q?d+=Ci(_,v,_+w*P,v+T*P,_+E*P,v+I*P,u,!0)+2:d+=Ci(_,v,_-w*A,v-T*A,_-E*A,v-I*A,u,!1)+2;break}}u.push(_-E*A,v-I*A,_+E*P,v+I*P),d+=2}}y=i[(c-2)*2],x=i[(c-2)*2+1],_=i[(c-1)*2],v=i[(c-1)*2+1],w=-(x-v),T=y-_,z=Math.sqrt(w*w+T*T),w/=z,T/=z,w*=m,T*=m,u.push(_-w*A,v-T*A,_+w*P,v+T*P),h||(n.cap===ci.ROUND?d+=Ci(_-w*(A-P)*.5,v-T*(A-P)*.5,_-w*A,v-T*A,_+w*P,v+T*P,u,!1)+2:n.cap===ci.SQUARE&&(d+=Mu(_,v,w,T,A,P,!1,u)));const O=t.indices,G=Lr.epsilon*Lr.epsilon;for(let L=f;L<d+f-2;++L)y=u[L*2],x=u[L*2+1],_=u[(L+1)*2],v=u[(L+1)*2+1],b=u[(L+2)*2],S=u[(L+2)*2+1],!(Math.abs(y*(v-S)+_*(S-x)+b*(x-v))<G)&&O.push(L,L+1,L+2)}function px(s,t){let e=0;const i=s.shape,r=s.points||i.points,n=i.type!==kt.POLY||i.closeStroke;if(r.length===0)return;const o=t.points,a=t.indices,h=r.length/2,l=o.length/2;let u=l;for(o.push(r[0],r[1]),e=1;e<h;e++)o.push(r[e*2],r[e*2+1]),a.push(u,u+1),u++;n&&a.push(u,l)}function Du(s,t){s.lineStyle.native?px(s,t):fx(s,t)}class zh{static curveLength(t,e,i,r,n,o){const a=t-2*i+n,h=e-2*r+o,l=2*i-2*t,u=2*r-2*e,c=4*(a*a+h*h),d=4*(a*l+h*u),f=l*l+u*u,m=2*Math.sqrt(c+d+f),p=Math.sqrt(c),g=2*c*p,y=2*Math.sqrt(f),x=d/p;return(g*m+p*d*(m-y)+(4*f*c-d*d)*Math.log((2*p+x+m)/(x+y)))/(4*g)}static curveTo(t,e,i,r,n){const o=n[n.length-2],a=n[n.length-1],h=Lr._segmentsCount(zh.curveLength(o,a,t,e,i,r));let l=0,u=0;for(let c=1;c<=h;++c){const d=c/h;l=o+(t-o)*d,u=a+(e-a)*d,n.push(l+(t+(i-t)*d-l)*d,u+(e+(r-e)*d-u)*d)}}}const jo={[kt.POLY]:Vd,[kt.CIRC]:Hn,[kt.ELIP]:Hn,[kt.RECT]:ux,[kt.RREC]:cx},Fu=[],nn=[];class $n{constructor(t,e=null,i=null,r=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=r,this.type=t.type}clone(){return new $n(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const ar=new K,Wd=class jd extends Kc{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Nn,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),nn.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),Fu.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,i=null,r=null){const n=new $n(t,e,i,r);return this.graphicsData.push(n),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const i=new $n(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let i=0;i<e.length;++i){const r=e[i];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(t,ar):ar.copyFrom(t),r.shape.contains(ar.x,ar.y))){let n=!1;if(r.holes){for(let o=0;o<r.holes.length;o++)if(r.holes[o].shape.contains(ar.x,ar.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let i=null,r=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],r=i.style);for(let h=this.shapeIndex;h<e.length;h++){this.shapeIndex++;const l=e[h],u=l.fillStyle,c=l.lineStyle;jo[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(u.visible||c.visible)&&this.processHoles(l.holes);for(let d=0;d<2;d++){const f=d===0?u:c;if(!f.visible)continue;const m=f.texture.baseTexture,p=this.indices.length,g=this.points.length/2;m.wrapMode=mi.REPEAT,d===0?this.processFill(l):this.processLine(l);const y=this.points.length/2-g;y!==0&&(i&&!this._compareStyles(r,f)&&(i.end(p,g),i=null),i||(i=Fu.pop()||new dx,i.begin(f,p,g),this.batches.push(i),r=f),this.addUvs(this.points,t,f.texture,g,y,f.matrix))}}const n=this.indices.length,o=this.points.length/2;if(i&&i.end(n,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const i=this.graphicsData[t],r=i.fillStyle,n=i.lineStyle;if(r&&!r.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,i=t.length;e<i;e++){const r=t[e];for(let n=0;n<r.size;n++){const o=r.start+n;this.indicesUint16[o]=this.indicesUint16[o]-r.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<jd.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++j._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),nn.push(this.drawCalls[c]);this.drawCalls.length=0;const e=this.colors,i=this.textureIds;let r=nn.pop();r||(r=new Ma,r.texArray=new Ba),r.texArray.count=0,r.start=0,r.size=0,r.type=Fe.TRIANGLES;let n=0,o=null,a=0,h=!1,l=Fe.TRIANGLES,u=0;this.drawCalls.push(r);for(let c=0;c<this.batches.length;c++){const d=this.batches[c],f=8,m=d.style,p=m.texture.baseTexture;h!==!!m.native&&(h=!!m.native,l=h?Fe.LINES:Fe.TRIANGLES,o=null,n=f,t++),o!==p&&(o=p,p._batchEnabled!==t&&(n===f&&(t++,n=0,r.size>0&&(r=nn.pop(),r||(r=new Ma,r.texArray=new Ba),this.drawCalls.push(r)),r.start=u,r.size=0,r.texArray.count=0,r.type=l),p.touched=1,p._batchEnabled=t,p._batchLocation=n,p.wrapMode=mi.REPEAT,r.texArray.elements[r.texArray.count++]=p,n++)),r.size+=d.size,u+=d.size,a=p._batchLocation,this.addColors(e,m.color,m.alpha,d.attribSize,d.attribStart),this.addTextureIds(i,a,d.attribSize,d.attribStart)}j._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,i=this.colors,r=this.textureIds,n=new ArrayBuffer(t.length*3*4),o=new Float32Array(n),a=new Uint32Array(n);let h=0;for(let l=0;l<t.length/2;l++)o[h++]=t[l*2],o[h++]=t[l*2+1],o[h++]=e[l*2],o[h++]=e[l*2+1],a[h++]=i[l],o[h++]=r[l];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?Vd.triangulate(t,this):jo[t.type].triangulate(t,this)}processLine(t){Du(t,this);for(let e=0;e<t.holes.length;e++)Du(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const i=t[e];jo[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let i=0;i<t.length/2;i++){const r=t[i*2],n=t[i*2+1];t[i*2]=e.a*r+e.c*n+e.tx,t[i*2+1]=e.b*r+e.d*n+e.ty}}addColors(t,e,i,r,n=0){const o=ht.shared.setValue(e).toLittleEndianNumber(),a=ht.shared.setValue(o).toPremultiplied(i);t.length=Math.max(t.length,n+r);for(let h=0;h<r;h++)t[n+h]=a}addTextureIds(t,e,i,r=0){t.length=Math.max(t.length,r+i);for(let n=0;n<i;n++)t[r+n]=e}addUvs(t,e,i,r,n,o=null){let a=0;const h=e.length,l=i.frame;for(;a<n;){let c=t[(r+a)*2],d=t[(r+a)*2+1];if(o){const f=o.a*c+o.c*d+o.tx;d=o.b*c+o.d*d+o.ty,c=f}a++,e.push(c/l.width,d/l.height)}const u=i.baseTexture;(l.width<u.width||l.height<u.height)&&this.adjustUvs(e,i,h,n)}adjustUvs(t,e,i,r){const n=e.baseTexture,o=1e-6,a=i+r*2,h=e.frame,l=h.width/n.width,u=h.height/n.height;let c=h.x/h.width,d=h.y/h.height,f=Math.floor(t[i]+o),m=Math.floor(t[i+1]+o);for(let p=i+2;p<a;p+=2)f=Math.min(f,Math.floor(t[p]+o)),m=Math.min(m,Math.floor(t[p+1]+o));c-=f,d-=m;for(let p=i;p<a;p+=2)t[p]=(t[p]+c)*l,t[p+1]=(t[p+1]+d)*u}};Wd.BATCHABLE_SIZE=100;let mx=Wd;class ho{constructor(){this.color=16777215,this.alpha=1,this.texture=U.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new ho;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=U.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Hh extends ho{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=ci.BUTT,this.join=ne.MITER,this.miterLimit=10}clone(){const t=new Hh;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=ci.BUTT,this.join=ne.MITER,this.miterLimit=10}}const Yo={},eh=class yn extends nt{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new ho,this._lineStyle=new Hh,this._matrix=null,this._holeMode=!1,this.state=He.for2d(),this._geometry=t||new mx,this._geometry.refCount++,this._transformID=-1,this._tintColor=new ht(16777215),this.blendMode=W.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new yn(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,i,r=.5,n=!1){return typeof t=="number"&&(t={width:t,color:e,alpha:i,alignment:r,native:n}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:U.WHITE,color:t!=null&&t.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:ci.BUTT,join:ne.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const i=t.width>0&&t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:i},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Xi,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Xi,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,r=i[i.length-2],n=i[i.length-1];return(r!==t||n!==e)&&i.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,i,r){this._initCurve();const n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),zh.curveTo(t,e,i,r,n),this}bezierCurveTo(t,e,i,r,n,o){return this._initCurve(),Gh.curveTo(t,e,i,r,n,o,this.currentPath.points),this}arcTo(t,e,i,r,n){this._initCurve(t,e);const o=this.currentPath.points,a=Iu.curveTo(t,e,i,r,n,o);if(a){const{cx:h,cy:l,radius:u,startAngle:c,endAngle:d,anticlockwise:f}=a;this.arc(h,l,u,c,d,f)}return this}arc(t,e,i,r,n,o=!1){if(r===n)return this;if(!o&&n<=r?n+=Fn:o&&r<=n&&(r+=Fn),n-r===0)return this;const a=t+Math.cos(r)*i,h=e+Math.sin(r)*i,l=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const c=Math.abs(u[u.length-2]-a),d=Math.abs(u[u.length-1]-h);c<l&&d<l||u.push(a,h)}else this.moveTo(a,h),u=this.currentPath.points;return Iu.arc(a,h,t,e,i,r,n,o,u),this}beginFill(t=0,e){return this.beginTextureFill({texture:U.WHITE,color:t,alpha:e})}normalizeColor(t){const e=ht.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){const e={texture:U.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const i=t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:i},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,i,r){return this.drawShape(new q(t,e,i,r))}drawRoundedRect(t,e,i,r,n){return this.drawShape(new no(t,e,i,r,n))}drawCircle(t,e,i){return this.drawShape(new ro(t,e,i))}drawEllipse(t,e,i,r){return this.drawShape(new so(t,e,i,r))}drawPolygon(...t){let e,i=!0;const r=t[0];r.points?(i=r.closeStroke,e=r.points):Array.isArray(t[0])?e=t[0]:e=t;const n=new Xi(e);return n.closeStroke=i,this.drawShape(n),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===kt.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(let r=0;r<i;r++){const n=t.batches[r],o=n.style.color,a=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),h=new Float32Array(t.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),l=new Uint16Array(t.indicesUint16.buffer,n.start*2,n.size),u={vertexData:a,blendMode:e,indices:l,uvs:h,_batchRGB:ht.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[r]=u}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,i=this.batches.length;e<i;e++){const r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}}_renderDirect(t){const e=this._resolveDirectShader(t),i=this._geometry,r=this.worldAlpha,n=e.uniforms,o=i.drawCalls;n.translationMatrix=this.transform.worldTransform,ht.shared.setValue(this._tintColor).premultiply(r).toArray(n.tint),t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(let a=0,h=o.length;a<h;a++)this._renderDrawCallDirect(t,i.drawCalls[a])}_renderDrawCallDirect(t,e){const{texArray:i,type:r,size:n,start:o}=e,a=i.count;for(let h=0;h<a;h++)t.texture.bind(i.elements[h],h);t.geometry.draw(r,n,o)}_resolveDirectShader(t){let e=this.shader;const i=this.pluginName;if(!e){if(!Yo[i]){const{maxTextures:r}=t.plugins[i],n=new Int32Array(r);for(let h=0;h<r;h++)n[h]=h;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new lt,default:ye.from({uSamplers:n},!0)},a=t.plugins[i]._shader.program;Yo[i]=new Le(a,o)}e=Yo[i]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:i,maxX:r,maxY:n}=t.bounds;this._bounds.addFrame(this.transform,e,i,r,n)}containsPoint(t){return this.worldTransform.applyInverse(t,yn._TEMP_POINT),this._geometry.containsPoint(yn._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=ht.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,o=e.d,a=e.tx,h=e.ty,l=this._geometry.points,u=this.vertexData;let c=0;for(let d=0;d<l.length;d+=2){const f=l[d],m=l[d+1];u[c++]=i*f+n*m+a,u[c++]=o*m+r*f+h}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};eh.curves=Lr,eh._TEMP_POINT=new K;let je=eh;class gx{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const qo=new K,Ou=new Xi,Yd=class qd extends nt{constructor(t,e,i,r=Fe.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=i||He.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=k.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Fe.TRIANGLES&&e.length<qd.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const r=this.transform.worldTransform,n=r.a,o=r.b,a=r.c,h=r.d,l=r.tx,u=r.ty,c=this.vertexData;for(let d=0;d<c.length/2;d++){const f=e[d*2],m=e[d*2+1];c[d*2]=n*f+a*m+l,c[d*2+1]=o*f+h*m+u}if(this._roundPixels){const d=k.RESOLUTION;for(let f=0;f<c.length;++f)c[f]=Math.round(c[f]*d)/d}this.vertexDirty=i}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new gx(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,qo);const e=this.geometry.getBuffer("aVertexPosition").data,i=Ou.points,r=this.geometry.getIndex().data,n=r.length,o=this.drawMode===4?3:1;for(let a=0;a+2<n;a+=o){const h=r[a]*2,l=r[a+1]*2,u=r[a+2]*2;if(i[0]=e[h],i[1]=e[h+1],i[2]=e[l],i[3]=e[l+1],i[4]=e[u],i[5]=e[u+1],Ou.contains(qo.x,qo.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};Yd.BATCHABLE_SIZE=100;let Bu=Yd;class _x extends yi{constructor(t,e,i){super();const r=new xt(t),n=new xt(e,!0),o=new xt(i,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,V.FLOAT).addAttribute("aTextureCoord",n,2,!1,V.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var yx=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,vx=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Lu extends Le{constructor(t,e){const i={uSampler:t,alpha:1,uTextureMatrix:lt.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(i,e.uniforms),super(e.program||Ke.from(vx,yx),i),this._colorDirty=!1,this.uvMatrix=new ud(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this._tintColor=new ht(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;ht.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class ku{constructor(t,e,i){this.geometry=new yi,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<t.length;++r){let n=t[r];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||V.FLOAT,offset:n.offset},e[r]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new xt($_(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=e,e+=a.size,this.dynamicStride+=a.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new xt(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=r,r+=a.size,this.staticStride+=a.size}const n=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new xt(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===V.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===V.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(t,e,i){for(let r=0;r<this.dynamicProperties.length;r++){const n=this.dynamicProperties[r];n.uploadFunction(t,e,i,n.type===V.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,i){for(let r=0;r<this.staticProperties.length;r++){const n=this.staticProperties[r];n.uploadFunction(t,e,i,n.type===V.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var xx=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,bx=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Kd extends oo{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new lt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:V.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Le.from(bx,xx,{}),this.state=He.for2d()}render(t){const e=t.children,i=t._maxSize,r=t._batchSize,n=this.renderer;let o=e.length;if(o===0)return;o>i&&!t.autoResize&&(o=i);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));const h=e[0]._texture.baseTexture,l=h.alphaMode>0;this.state.blendMode=jc(t.blendMode,l),n.state.set(this.state);const u=n.gl,c=t.worldTransform.copyTo(this.tempMatrix);c.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=c.toArray(!0),this.shader.uniforms.uColor=ht.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,l).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);let d=!1;for(let f=0,m=0;f<o;f+=r,m+=1){let p=o-f;p>r&&(p=r),m>=a.length&&a.push(this._generateOneMoreBuffer(t));const g=a[m];g.uploadDynamic(e,f,p);const y=t._bufferUpdateIDs[m]||0;d=d||g._updateID<y,d&&(g._updateID=t._updateID,g.uploadStatic(e,f,p)),n.geometry.bind(g.geometry),u.drawElements(u.TRIANGLES,p*6,u.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],i=t._maxSize,r=t._batchSize,n=t._properties;for(let o=0;o<i;o+=r)e.push(new ku(this.properties,n,r));return e}_generateOneMoreBuffer(t){const e=t._batchSize,i=t._properties;return new ku(this.properties,i,e)}uploadVertices(t,e,i,r,n,o){let a=0,h=0,l=0,u=0;for(let c=0;c<i;++c){const d=t[e+c],f=d._texture,m=d.scale.x,p=d.scale.y,g=f.trim,y=f.orig;g?(h=g.x-d.anchor.x*y.width,a=h+g.width,u=g.y-d.anchor.y*y.height,l=u+g.height):(a=y.width*(1-d.anchor.x),h=y.width*-d.anchor.x,l=y.height*(1-d.anchor.y),u=y.height*-d.anchor.y),r[o]=h*m,r[o+1]=u*p,r[o+n]=a*m,r[o+n+1]=u*p,r[o+n*2]=a*m,r[o+n*2+1]=l*p,r[o+n*3]=h*m,r[o+n*3+1]=l*p,o+=n*4}}uploadPosition(t,e,i,r,n,o){for(let a=0;a<i;a++){const h=t[e+a].position;r[o]=h.x,r[o+1]=h.y,r[o+n]=h.x,r[o+n+1]=h.y,r[o+n*2]=h.x,r[o+n*2+1]=h.y,r[o+n*3]=h.x,r[o+n*3+1]=h.y,o+=n*4}}uploadRotation(t,e,i,r,n,o){for(let a=0;a<i;a++){const h=t[e+a].rotation;r[o]=h,r[o+n]=h,r[o+n*2]=h,r[o+n*3]=h,o+=n*4}}uploadUvs(t,e,i,r,n,o){for(let a=0;a<i;++a){const h=t[e+a]._texture._uvs;h?(r[o]=h.x0,r[o+1]=h.y0,r[o+n]=h.x1,r[o+n+1]=h.y1,r[o+n*2]=h.x2,r[o+n*2+1]=h.y2,r[o+n*3]=h.x3,r[o+n*3+1]=h.y3,o+=n*4):(r[o]=0,r[o+1]=0,r[o+n]=0,r[o+n+1]=0,r[o+n*2]=0,r[o+n*2+1]=0,r[o+n*3]=0,r[o+n*3+1]=0,o+=n*4)}}uploadTint(t,e,i,r,n,o){for(let a=0;a<i;++a){const h=t[e+a],l=ht.shared.setValue(h._tintRGB).toPremultiplied(h.alpha,h.texture.baseTexture.alphaMode>0);r[o]=l,r[o+n]=l,r[o+n*2]=l,r[o+n*3]=l,o+=n*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Kd.extension={name:"particle",type:B.RendererPlugin};H.add(Kd);var lo=(s=>(s[s.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",s[s.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",s))(lo||{});const on={willReadFrequently:!0},Se=class ${static get experimentalLetterSpacingSupported(){let t=$._experimentalLetterSpacingSupported;if(t!==void 0){const e=k.ADAPTER.getCanvasRenderingContext2D().prototype;t=$._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,r,n,o,a,h,l){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=n,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=h,this.fontProperties=l}static measureText(t,e,i,r=$._canvas){i=i??e.wordWrap;const n=e.toFontString(),o=$.measureFont(n);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const a=r.getContext("2d",on);a.font=n;const h=(i?$.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),l=new Array(h.length);let u=0;for(let m=0;m<h.length;m++){const p=$._measureText(h[m],e.letterSpacing,a);l[m]=p,u=Math.max(u,p)}let c=u+e.strokeThickness;e.dropShadow&&(c+=e.dropShadowDistance);const d=e.lineHeight||o.fontSize+e.strokeThickness;let f=Math.max(d,o.fontSize+e.strokeThickness*2)+e.leading+(h.length-1)*(d+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new $(t,e,c,f,h,l,d+e.leading,u,o)}static _measureText(t,e,i){let r=!1;$.experimentalLetterSpacingSupported&&($.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,r=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let n=i.measureText(t).width;return n>0&&(r?n-=e:n+=($.graphemeSegmenter(t).length-1)*e),n}static wordWrap(t,e,i=$._canvas){const r=i.getContext("2d",on);let n=0,o="",a="";const h=Object.create(null),{letterSpacing:l,whiteSpace:u}=e,c=$.collapseSpaces(u),d=$.collapseNewlines(u);let f=!c;const m=e.wordWrapWidth+l,p=$.tokenize(t);for(let g=0;g<p.length;g++){let y=p[g];if($.isNewline(y)){if(!d){a+=$.addLine(o),f=!c,o="",n=0;continue}y=" "}if(c){const _=$.isBreakingSpace(y),v=$.isBreakingSpace(o[o.length-1]);if(_&&v)continue}const x=$.getFromCache(y,l,h,r);if(x>m)if(o!==""&&(a+=$.addLine(o),o="",n=0),$.canBreakWords(y,e.breakWords)){const _=$.wordWrapSplit(y);for(let v=0;v<_.length;v++){let b=_[v],S=b,w=1;for(;_[v+w];){const E=_[v+w];if(!$.canBreakChars(S,E,y,v,e.breakWords))b+=E;else break;S=E,w++}v+=w-1;const T=$.getFromCache(b,l,h,r);T+n>m&&(a+=$.addLine(o),f=!1,o="",n=0),o+=b,n+=T}}else{o.length>0&&(a+=$.addLine(o),o="",n=0);const _=g===p.length-1;a+=$.addLine(y,!_),f=!1,o="",n=0}else x+n>m&&(f=!1,a+=$.addLine(o),o="",n=0),(o.length>0||!$.isBreakingSpace(y)||f)&&(o+=y,n+=x)}return a+=$.addLine(o,!1),a}static addLine(t,e=!0){return t=$.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,i,r){let n=i[t];return typeof n!="number"&&(n=$._measureText(t,e,r)+e,i[t]=n),n}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!$.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:$._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:$._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let i="";if(typeof t!="string")return e;for(let r=0;r<t.length;r++){const n=t[r],o=t[r+1];if($.isBreakingSpace(n,o)||$.isNewline(n)){i!==""&&(e.push(i),i=""),e.push(n);continue}i+=n}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,r,n){return!0}static wordWrapSplit(t){return $.graphemeSegmenter(t)}static measureFont(t){if($._fonts[t])return $._fonts[t];const e={ascent:0,descent:0,fontSize:0},i=$._canvas,r=$._context;r.font=t;const n=$.METRICS_STRING+$.BASELINE_SYMBOL,o=Math.ceil(r.measureText(n).width);let a=Math.ceil(r.measureText($.BASELINE_SYMBOL).width);const h=Math.ceil($.HEIGHT_MULTIPLIER*a);if(a=a*$.BASELINE_MULTIPLIER|0,o===0||h===0)return $._fonts[t]=e,e;i.width=o,i.height=h,r.fillStyle="#f00",r.fillRect(0,0,o,h),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(n,0,a);const l=r.getImageData(0,0,o,h).data,u=l.length,c=o*4;let d=0,f=0,m=!1;for(d=0;d<a;++d){for(let p=0;p<c;p+=4)if(l[f+p]!==255){m=!0;break}if(!m)f+=c;else break}for(e.ascent=a-d,f=u-c,m=!1,d=h;d>a;--d){for(let p=0;p<c;p+=4)if(l[f+p]!==255){m=!0;break}if(!m)f-=c;else break}return e.descent=d-a,e.fontSize=e.ascent+e.descent,$._fonts[t]=e,e}static clearMetrics(t=""){t?delete $._fonts[t]:$._fonts={}}static get _canvas(){var t;if(!$.__canvas){let e;try{const i=new OffscreenCanvas(0,0);if((t=i.getContext("2d",on))!=null&&t.measureText)return $.__canvas=i,i;e=k.ADAPTER.createCanvas()}catch{e=k.ADAPTER.createCanvas()}e.width=e.height=10,$.__canvas=e}return $.__canvas}static get _context(){return $.__context||($.__context=$._canvas.getContext("2d",on)),$.__context}};Se.METRICS_STRING="|ÉqÅ",Se.BASELINE_SYMBOL="M",Se.BASELINE_MULTIPLIER=1.4,Se.HEIGHT_MULTIPLIER=2,Se.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>[...s.segment(t)].map(e=>e.segment)}return s=>[...s]})(),Se.experimentalLetterSpacing=!1,Se._fonts={},Se._newlines=[10,13],Se._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let ai=Se;const Tx=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Zd=class ss{constructor(t){this.styleID=0,this.reset(),Zo(this,t,t)}clone(){const t={};return Zo(t,this,ss.defaultStyle),new ss(t)}reset(){Zo(this,ss.defaultStyle,ss.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=Ko(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=Ko(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){wx(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=Ko(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let r=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!Tx.includes(r)&&(r=`"${r}"`),e[i]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};Zd.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:lo.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ge=Zd;function Ko(s){const t=ht.shared,e=i=>{const r=t.setValue(i);return r.alpha===1?r.toHex():r.toRgbaString()};return Array.isArray(s)?s.map(e):e(s)}function wx(s,t){if(!Array.isArray(s)||!Array.isArray(t)||s.length!==t.length)return!1;for(let e=0;e<s.length;++e)if(s[e]!==t[e])return!1;return!0}function Zo(s,t,e){for(const i in e)Array.isArray(t[i])?s[i]=t[i].slice():s[i]=t[i]}const Ax={texture:!0,children:!1,baseTexture:!0},Qd=class ih extends Dt{constructor(t,e,i){let r=!1;i||(i=k.ADAPTER.createCanvas(),r=!0),i.width=3,i.height=3;const n=U.from(i);n.orig=new q,n.trim=new q,super(n),this._ownCanvas=r,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=ih.defaultResolution??k.RESOLUTION,this._autoResolution=ih.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return ai.experimentalLetterSpacing}static set experimentalLetterSpacing(t){Z("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),ai.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const i=this.context,r=ai.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=r.width,o=r.height,a=r.lines,h=r.lineHeight,l=r.lineWidths,u=r.maxLineWidth,c=r.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+e.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;let d,f;const m=e.dropShadow?2:1;for(let p=0;p<m;++p){const g=e.dropShadow&&p===0,y=g?Math.ceil(Math.max(1,o)+e.padding*2):0,x=y*this._resolution;if(g){i.fillStyle="black",i.strokeStyle="black";const v=e.dropShadowColor,b=e.dropShadowBlur*this._resolution,S=e.dropShadowDistance*this._resolution;i.shadowColor=ht.shared.setValue(v).setAlpha(e.dropShadowAlpha).toRgbaString(),i.shadowBlur=b,i.shadowOffsetX=Math.cos(e.dropShadowAngle)*S,i.shadowOffsetY=Math.sin(e.dropShadowAngle)*S+x}else i.fillStyle=this._generateFillStyle(e,a,r),i.strokeStyle=e.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let _=(h-c.fontSize)/2;h-c.fontSize<0&&(_=0);for(let v=0;v<a.length;v++)d=e.strokeThickness/2,f=e.strokeThickness/2+v*h+c.ascent+_,e.align==="right"?d+=u-l[v]:e.align==="center"&&(d+=(u-l[v])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(a[v],d+e.padding,f+e.padding-y,!0),e.fill&&this.drawLetterSpacing(a[v],d+e.padding,f+e.padding-y)}this.updateTexture()}drawLetterSpacing(t,e,i,r=!1){const n=this._style.letterSpacing;let o=!1;if(ai.experimentalLetterSpacingSupported&&(ai.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),n===0||o){r?this.context.strokeText(t,e,i):this.context.fillText(t,e,i);return}let a=e;const h=ai.graphemeSegmenter(t);let l=this.context.measureText(t).width,u=0;for(let c=0;c<h.length;++c){const d=h[c];r?this.context.strokeText(d,a,i):this.context.fillText(d,a,i);let f="";for(let m=c+1;m<h.length;++m)f+=h[m];u=this.context.measureText(f).width,a+=l-u+n,l=u}}updateTexture(){const t=this.canvas;if(this._style.trim){const o=j_(t);o.data&&(t.width=o.width,t.height=o.height,this.context.putImageData(o.data,0,0))}const e=this._texture,i=this._style,r=i.trim?0:i.padding,n=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-r,e.trim.y=-r,e.orig.width=e._frame.width-r*2,e.orig.height=e._frame.height-r*2,this._onTextureUpdate(),n.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,i){const r=t.fill;if(Array.isArray(r)){if(r.length===1)return r[0]}else return r;let n;const o=t.dropShadow?t.dropShadowDistance:0,a=t.padding||0,h=this.canvas.width/this._resolution-o-a*2,l=this.canvas.height/this._resolution-o-a*2,u=r.slice(),c=t.fillGradientStops.slice();if(!c.length){const d=u.length+1;for(let f=1;f<d;++f)c.push(f/d)}if(u.unshift(r[0]),c.unshift(0),u.push(r[r.length-1]),c.push(1),t.fillGradientType===lo.LINEAR_VERTICAL){n=this.context.createLinearGradient(h/2,a,h/2,l+a);const d=i.fontProperties.fontSize+t.strokeThickness;for(let f=0;f<e.length;f++){const m=i.lineHeight*(f-1)+d,p=i.lineHeight*f;let g=p;f>0&&m>p&&(g=(p+m)/2);const y=p+d,x=i.lineHeight*(f+1);let _=y;f+1<e.length&&x<y&&(_=(y+x)/2);const v=(_-g)/l;for(let b=0;b<u.length;b++){let S=0;typeof c[b]=="number"?S=c[b]:S=b/u.length;let w=Math.min(1,Math.max(0,g/l+S*v));w=Number(w.toFixed(5)),n.addColorStop(w,u[b])}}}else{n=this.context.createLinearGradient(a,l/2,h+a,l/2);const d=u.length+1;let f=1;for(let m=0;m<u.length;m++){let p;typeof c[m]=="number"?p=c[m]:p=f/d,n.addColorStop(p,u[m]),f++}}return n}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},Ax,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=ui(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=ui(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof Ge?this._style=t:this._style=new Ge(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};Qd.defaultAutoResolution=!0;let Ui=Qd;class Ex{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function Sx(s,t){var i;let e=!1;if((i=s==null?void 0:s._textures)!=null&&i.length){for(let r=0;r<s._textures.length;r++)if(s._textures[r]instanceof U){const n=s._textures[r].baseTexture;t.includes(n)||(t.push(n),e=!0)}}return e}function Cx(s,t){if(s.baseTexture instanceof j){const e=s.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function Px(s,t){if(s._texture&&s._texture instanceof U){const e=s._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function Rx(s,t){return t instanceof Ui?(t.updateText(!0),!0):!1}function Ix(s,t){if(t instanceof Ge){const e=t.toFontString();return ai.measureFont(e),!0}return!1}function Mx(s,t){if(s instanceof Ui){t.includes(s.style)||t.push(s.style),t.includes(s)||t.push(s);const e=s._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function Dx(s,t){return s instanceof Ge?(t.includes(s)||t.push(s),!0):!1}const Jd=class tf{constructor(t){this.limiter=new Ex(tf.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(Mx),this.registerFindHook(Dx),this.registerFindHook(Sx),this.registerFindHook(Cx),this.registerFindHook(Px),this.registerUploadHook(Rx),this.registerUploadHook(Ix)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,Nt.system.addOnce(this.tick,this,vi.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed){for(let i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)Nt.system.addOnce(this.tick,this,vi.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,i=t.length;e<i;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof nt)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&Nt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};Jd.uploadsPerFrame=4;let rh=Jd;Object.defineProperties(k,{UPLOADS_PER_FRAME:{get(){return rh.uploadsPerFrame},set(s){Z("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),rh.uploadsPerFrame=s}}});function ef(s,t){return t instanceof j?(t._glTextures[s.CONTEXT_UID]||s.texture.bind(t),!0):!1}function Fx(s,t){if(!(t instanceof je))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:i}=e;for(let r=0;r<i.length;r++){const{texture:n}=i[r].style;n&&ef(s,n.baseTexture)}return e.batchable||s.geometry.bind(e,t._resolveDirectShader(s)),!0}function Ox(s,t){return s instanceof je?(t.push(s),!0):!1}class rf extends rh{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(Ox),this.registerUploadHook(ef),this.registerUploadHook(Fx)}}rf.extension={name:"prepare",type:B.RendererSystem};H.add(rf);class ws extends Dt{constructor(t,e=!0){super(t[0]instanceof U?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=e,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Nt.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Nt.shared.add(this.update,this,vi.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=this.animationSpeed*t,i=this.currentFrame;if(this._durations!==null){let r=this._currentTime%1*this._durations[this.currentFrame];for(r+=e/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];const n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let i=0;i<t.length;++i)e.push(U.from(t[i]));return new ws(e)}static fromImages(t){const e=[];for(let i=0;i<t.length;++i)e.push(U.from(t[i]));return new ws(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof U)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Nt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Nt.shared.add(this.update,this),this._isConnectedToTicker=!0))}}var Bx=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,Lx=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,kx=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,Nu=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,Nx=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const an=new lt;class sf extends oo{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new od,this.state=He.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Le.from(Nu,Nx,e),this.shader=t.context.webGLVersion>1?Le.from(Lx,Bx,e):Le.from(Nu,kx,e)}render(t){const e=this.renderer,i=this.quad;let r=i.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y);const n=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;r=i.uvs,r[0]=r[6]=-n,r[1]=r[3]=-o,r[2]=r[4]=1-n,r[5]=r[7]=1-o,i.invalidate();const a=t._texture,h=a.baseTexture,l=h.alphaMode>0,u=t.tileTransform.localTransform,c=t.uvMatrix;let d=h.isPowerOfTwo&&a.frame.width===h.width&&a.frame.height===h.height;d&&(h._glTextures[e.CONTEXT_UID]?d=h.wrapMode!==mi.CLAMP:h.wrapMode===mi.CLAMP&&(h.wrapMode=mi.REPEAT));const f=d?this.simpleShader:this.shader,m=a.width,p=a.height,g=t._width,y=t._height;an.set(u.a*m/g,u.b*m/y,u.c*p/g,u.d*p/y,u.tx/g,u.ty/y),an.invert(),d?an.prepend(c.mapCoord):(f.uniforms.uMapCoord=c.mapCoord.toArray(!0),f.uniforms.uClampFrame=c.uClampFrame,f.uniforms.uClampOffset=c.uClampOffset),f.uniforms.uTransform=an.toArray(!0),f.uniforms.uColor=ht.shared.setValue(t.tint).premultiply(t.worldAlpha,l).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,e.shader.bind(f),e.geometry.bind(i),this.state.blendMode=jc(t.blendMode,l),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}sf.extension={name:"tilingSprite",type:B.RendererPlugin};H.add(sf);const nf=class ns{constructor(t,e,i){this.linkedSheets=[],(t instanceof j||t instanceof U)&&(t={texture:t,data:e,resolutionFilename:i});const{texture:r,data:n,resolutionFilename:o=null,cachePrefix:a=""}=t;this.cachePrefix=a,this._texture=r instanceof U?r:null,this.baseTexture=r instanceof j?r:this._texture.baseTexture,this.textures={},this.animations={},this.data=n;const h=this.baseTexture.resource;this.resolution=this._updateResolution(o||(h?h.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let i=Qe(t,null);return i===null&&(i=typeof e=="number"?e:parseFloat(e??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=ns.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const i=ns.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const r=this._frameKeys[e],n=this._frames[r],o=n.frame;if(o){let a=null,h=null;const l=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,u=new q(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);n.rotated?a=new q(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new q(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(h=new q(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new U(this.baseTexture,a,u,h,n.rotated?2:0,n.anchor,n.borders),U.addToCache(this.textures[r],this.cachePrefix+r.toString())}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const r=t[e][i];this.animations[e].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ns.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ns.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};nf.BATCH_SIZE=1e3;let Uu=nf;const Ux=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function of(s,t,e){const i={};if(s.forEach(r=>{i[r]=t}),Object.keys(t.textures).forEach(r=>{i[`${t.cachePrefix}${r}`]=t.textures[r]}),!e){const r=Ft.dirname(s[0]);t.linkedSheets.forEach((n,o)=>{Object.assign(i,of([`${r}/${t.data.meta.related_multi_packs[o]}`],n,!0))})}return i}const Gx={extension:B.Asset,cache:{test:s=>s instanceof Uu,getCacheableAssets:(s,t)=>of(s,t,!1)},resolver:{test:s=>{const t=s.split("?")[0].split("."),e=t.pop(),i=t.pop();return e==="json"&&Ux.includes(i)},parse:s=>{var e;const t=s.split(".");return{resolution:parseFloat(((e=k.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",extension:{type:B.LoadParser,priority:ve.Normal},async testParse(s,t){return Ft.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){var u,c;const{texture:i,imageFilename:r,cachePrefix:n}=(t==null?void 0:t.data)??{};let o=Ft.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(i&&i.baseTexture)a=i;else{const d=Qa(o+(r??s.meta.image),t.src);a=(await e.load([d]))[d]}const h=new Uu({texture:a.baseTexture,data:s,resolutionFilename:t.src,cachePrefix:n});await h.parse();const l=(u=s==null?void 0:s.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(l)){const d=[];for(const m of l){if(typeof m!="string")continue;let p=o+m;(c=t.data)!=null&&c.ignoreMultiPack||(p=Qa(p,t.src),d.push(e.load({src:p,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(d);h.linkedSheets=f,f.forEach(m=>{m.linkedSheets=[h].concat(h.linkedSheets.filter(p=>p!==m))})}return h},unload(s){s.destroy(!0)}}};H.add(Gx);class Xn{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class vn{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const n in e){const o=e[n].match(/^[a-z]+/gm)[0],a=e[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),h={};for(const l in a){const u=a[l].split("="),c=u[0],d=u[1].replace(/"/gm,""),f=parseFloat(d),m=isNaN(f)?d:f;h[c]=m}i[o].push(h)}const r=new Xn;return i.info.forEach(n=>r.info.push({face:n.face,size:parseInt(n.size,10)})),i.common.forEach(n=>r.common.push({lineHeight:parseInt(n.lineHeight,10)})),i.page.forEach(n=>r.page.push({id:parseInt(n.id,10),file:n.file})),i.char.forEach(n=>r.char.push({id:parseInt(n.id,10),page:parseInt(n.page,10),x:parseInt(n.x,10),y:parseInt(n.y,10),width:parseInt(n.width,10),height:parseInt(n.height,10),xoffset:parseInt(n.xoffset,10),yoffset:parseInt(n.yoffset,10),xadvance:parseInt(n.xadvance,10)})),i.kerning.forEach(n=>r.kerning.push({first:parseInt(n.first,10),second:parseInt(n.second,10),amount:parseInt(n.amount,10)})),i.distanceField.forEach(n=>r.distanceField.push({distanceRange:parseInt(n.distanceRange,10),fieldType:n.fieldType})),r}}class sh{static test(t){const e=t;return typeof t!="string"&&"getElementsByTagName"in t&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new Xn,i=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),h=t.getElementsByTagName("distanceField");for(let l=0;l<i.length;l++)e.info.push({face:i[l].getAttribute("face"),size:parseInt(i[l].getAttribute("size"),10)});for(let l=0;l<r.length;l++)e.common.push({lineHeight:parseInt(r[l].getAttribute("lineHeight"),10)});for(let l=0;l<n.length;l++)e.page.push({id:parseInt(n[l].getAttribute("id"),10)||0,file:n[l].getAttribute("file")});for(let l=0;l<o.length;l++){const u=o[l];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(let l=0;l<a.length;l++)e.kerning.push({first:parseInt(a[l].getAttribute("first"),10),second:parseInt(a[l].getAttribute("second"),10),amount:parseInt(a[l].getAttribute("amount"),10)});for(let l=0;l<h.length;l++)e.distanceField.push({fieldType:h[l].getAttribute("fieldType"),distanceRange:parseInt(h[l].getAttribute("distanceRange"),10)});return e}}class nh{static test(t){return typeof t=="string"&&t.includes("<font>")?sh.test(k.ADAPTER.parseXML(t)):!1}static parse(t){return sh.parse(k.ADAPTER.parseXML(t))}}const Qo=[vn,sh,nh];function zx(s){for(let t=0;t<Qo.length;t++)if(Qo[t].test(s))return Qo[t];return null}function Hx(s,t,e,i,r,n){const o=e.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const h=e.dropShadow?e.dropShadowDistance:0,l=e.padding||0,u=s.width/i-h-l*2,c=s.height/i-h-l*2,d=o.slice(),f=e.fillGradientStops.slice();if(!f.length){const m=d.length+1;for(let p=1;p<m;++p)f.push(p/m)}if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),e.fillGradientType===lo.LINEAR_VERTICAL){a=t.createLinearGradient(u/2,l,u/2,c+l);let m=0;const p=(n.fontProperties.fontSize+e.strokeThickness)/c;for(let g=0;g<r.length;g++){const y=n.lineHeight*g;for(let x=0;x<d.length;x++){let _=0;typeof f[x]=="number"?_=f[x]:_=x/d.length;const v=y/c+_*p;let b=Math.max(m,v);b=Math.min(b,1),a.addColorStop(b,d[x]),m=b}}}else{a=t.createLinearGradient(l,c/2,u+l,c/2);const m=d.length+1;let p=1;for(let g=0;g<d.length;g++){let y;typeof f[g]=="number"?y=f[g]:y=p/m,a.addColorStop(y,d[g]),p++}}return a}function $x(s,t,e,i,r,n,o){const a=e.text,h=e.fontProperties;t.translate(i,r),t.scale(n,n);const l=o.strokeThickness/2,u=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=Hx(s,t,o,n,[a],e),t.strokeStyle=o.stroke,o.dropShadow){const c=o.dropShadowColor,d=o.dropShadowBlur*n,f=o.dropShadowDistance*n;t.shadowColor=ht.shared.setValue(c).setAlpha(o.dropShadowAlpha).toRgbaString(),t.shadowBlur=d,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(a,l,u+e.lineHeight-h.descent),o.fill&&t.fillText(a,l,u+e.lineHeight-h.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function xn(s){return s.codePointAt?s.codePointAt(0):s.charCodeAt(0)}function af(s){return Array.from?Array.from(s):s.split("")}function Xx(s){typeof s=="string"&&(s=[s]);const t=[];for(let e=0,i=s.length;e<i;e++){const r=s[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const n=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,h=o;a<=h;a++)t.push(String.fromCharCode(a))}else t.push(...af(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const ri=class Ce{constructor(t,e,i){var u;const[r]=t.info,[n]=t.common,[o]=t.page,[a]=t.distanceField,h=Qe(o.file),l={};this._ownsTextures=i,this.font=r.face,this.size=r.size,this.lineHeight=n.lineHeight/h,this.chars={},this.pageTextures=l;for(let c=0;c<t.page.length;c++){const{id:d,file:f}=t.page[c];l[d]=e instanceof Array?e[c]:e[f],a!=null&&a.fieldType&&a.fieldType!=="none"&&(l[d].baseTexture.alphaMode=Vt.NO_PREMULTIPLIED_ALPHA,l[d].baseTexture.mipmap=Ue.OFF)}for(let c=0;c<t.char.length;c++){const{id:d,page:f}=t.char[c];let{x:m,y:p,width:g,height:y,xoffset:x,yoffset:_,xadvance:v}=t.char[c];m/=h,p/=h,g/=h,y/=h,x/=h,_/=h,v/=h;const b=new q(m+l[f].frame.x/h,p+l[f].frame.y/h,g,y);this.chars[d]={xOffset:x,yOffset:_,xAdvance:v,kerning:{},texture:new U(l[f].baseTexture,b),page:f}}for(let c=0;c<t.kerning.length;c++){let{first:d,second:f,amount:m}=t.kerning[c];d/=h,f/=h,m/=h,this.chars[f]&&(this.chars[f].kerning[d]=m)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((u=a==null?void 0:a.fieldType)==null?void 0:u.toLowerCase())??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,i){let r;if(t instanceof Xn)r=t;else{const o=zx(t);if(!o)throw new Error("Unrecognized data format for font.");r=o.parse(t)}e instanceof U&&(e=[e]);const n=new Ce(r,e,i);return Ce.available[n.font]=n,n}static uninstall(t){const e=Ce.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete Ce.available[t]}static from(t,e,i){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:r,padding:n,resolution:o,textureWidth:a,textureHeight:h,...l}=Object.assign({},Ce.defaultOptions,i),u=Xx(r),c=e instanceof Ge?e:new Ge(e),d=a,f=new Xn;f.info[0]={face:c.fontFamily,size:c.fontSize},f.common[0]={lineHeight:c.fontSize};let m=0,p=0,g,y,x,_=0;const v=[];for(let S=0;S<u.length;S++){g||(g=k.ADAPTER.createCanvas(),g.width=a,g.height=h,y=g.getContext("2d"),x=new j(g,{resolution:o,...l}),v.push(new U(x)),f.page.push({id:v.length-1,file:""}));const w=u[S],T=ai.measureText(w,c,!1,g),E=T.width,I=Math.ceil(T.height),z=Math.ceil((c.fontStyle==="italic"?2:1)*E);if(p>=h-I*o){if(p===0)throw new Error(`[BitmapFont] textureHeight ${h}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${w}')`);--S,g=null,y=null,x=null,p=0,m=0,_=0;continue}if(_=Math.max(I+T.fontProperties.descent,_),z*o+m>=d){if(m===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${w}')`);--S,p+=_*o,p=Math.ceil(p),m=0,_=0;continue}$x(g,y,T,m,p,o,c);const R=xn(T.text);f.char.push({id:R,page:v.length-1,x:m/o,y:p/o,width:z,height:I,xoffset:0,yoffset:0,xadvance:E-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),m+=(z+2*n)*o,m=Math.ceil(m)}if(!(i!=null&&i.skipKerning))for(let S=0,w=u.length;S<w;S++){const T=u[S];for(let E=0;E<w;E++){const I=u[E],z=y.measureText(T).width,R=y.measureText(I).width,A=y.measureText(T+I).width-(z+R);A&&f.kerning.push({first:xn(T),second:xn(I),amount:A})}}const b=new Ce(f,v,!0);return Ce.available[t]!==void 0&&Ce.uninstall(t),Ce.available[t]=b,b}};ri.ALPHA=[["a","z"],["A","Z"]," "],ri.NUMERIC=[["0","9"]],ri.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],ri.ASCII=[[" ","~"]],ri.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:ri.ALPHANUMERIC},ri.available={};let si=ri;var Vx=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,Wx=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const Gu=[],zu=[],Hu=[],jx=class hf extends nt{constructor(t,e={}){super();const{align:i,tint:r,maxWidth:n,letterSpacing:o,fontName:a,fontSize:h}=Object.assign({},hf.styleDefaults,e);if(!si.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new ht(r),this._font=void 0,this._fontName=a,this._fontSize=h,this.text=t,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new qe(()=>{this.dirty=!0},this,0,0),this._roundPixels=k.ROUND_PIXELS,this.dirty=!0,this._resolution=k.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var z;const t=si.available[this._fontName],e=this.fontSize,i=e/t.size,r=new K,n=[],o=[],a=[],h=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",l=af(h),u=this._maxWidth*t.size/e,c=t.distanceFieldType==="none"?Gu:zu;let d=null,f=0,m=0,p=0,g=-1,y=0,x=0,_=0,v=0;for(let R=0;R<l.length;R++){const A=l[R],P=xn(A);if(/(?:\s)/.test(A)&&(g=R,y=f,v++),A==="\r"||A===`
`){o.push(f),a.push(-1),m=Math.max(m,f),++p,++x,r.x=0,r.y+=t.lineHeight,d=null,v=0;continue}const O=t.chars[P];if(!O)continue;d&&O.kerning[d]&&(r.x+=O.kerning[d]);const G=Hu.pop()||{texture:U.EMPTY,line:0,charCode:0,prevSpaces:0,position:new K};G.texture=O.texture,G.line=p,G.charCode=P,G.position.x=Math.round(r.x+O.xOffset+this._letterSpacing/2),G.position.y=Math.round(r.y+O.yOffset),G.prevSpaces=v,n.push(G),f=G.position.x+Math.max(O.xAdvance-O.xOffset,O.texture.orig.width),r.x+=O.xAdvance+this._letterSpacing,_=Math.max(_,O.yOffset+O.texture.height),d=P,g!==-1&&u>0&&r.x>u&&(++x,Er(n,1+g-x,1+R-g),R=g,g=-1,o.push(y),a.push(n.length>0?n[n.length-1].prevSpaces:0),m=Math.max(m,y),p++,r.x=0,r.y+=t.lineHeight,d=null,v=0)}const b=l[l.length-1];b!=="\r"&&b!==`
`&&(/(?:\s)/.test(b)&&(f=y),o.push(f),m=Math.max(m,f),a.push(-1));const S=[];for(let R=0;R<=p;R++){let A=0;this._align==="right"?A=m-o[R]:this._align==="center"?A=(m-o[R])/2:this._align==="justify"&&(A=a[R]<0?0:(m-o[R])/a[R]),S.push(A)}const w=n.length,T={},E=[],I=this._activePagesMeshData;c.push(...I);for(let R=0;R<w;R++){const A=n[R].texture,P=A.baseTexture.uid;if(!T[P]){let O=c.pop();if(!O){const L=new _x;let X,rt;t.distanceFieldType==="none"?(X=new Lu(U.EMPTY),rt=W.NORMAL):(X=new Lu(U.EMPTY,{program:Ke.from(Wx,Vx),uniforms:{uFWidth:0}}),rt=W.NORMAL_NPM);const D=new Bu(L,X);D.blendMode=rt,O={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:D,vertices:null,uvs:null,indices:null}}O.index=0,O.indexCount=0,O.vertexCount=0,O.uvsCount=0,O.total=0;const{_textureCache:G}=this;G[P]=G[P]||new U(A.baseTexture),O.mesh.texture=G[P],O.mesh.tint=this._tintColor.value,E.push(O),T[P]=O}T[P].total++}for(let R=0;R<I.length;R++)E.includes(I[R])||this.removeChild(I[R].mesh);for(let R=0;R<E.length;R++)E[R].mesh.parent!==this&&this.addChild(E[R].mesh);this._activePagesMeshData=E;for(const R in T){const A=T[R],P=A.total;if(!(((z=A.indices)==null?void 0:z.length)>6*P)||A.vertices.length<Bu.BATCHABLE_SIZE*2)A.vertices=new Float32Array(4*2*P),A.uvs=new Float32Array(4*2*P),A.indices=new Uint16Array(6*P);else{const O=A.total,G=A.vertices;for(let L=O*4*2;L<G.length;L++)G[L]=0}A.mesh.size=6*P}for(let R=0;R<w;R++){const A=n[R];let P=A.position.x+S[A.line]*(this._align==="justify"?A.prevSpaces:1);this._roundPixels&&(P=Math.round(P));const O=P*i,G=A.position.y*i,L=A.texture,X=T[L.baseTexture.uid],rt=L.frame,D=L._uvs,F=X.index++;X.indices[F*6+0]=0+F*4,X.indices[F*6+1]=1+F*4,X.indices[F*6+2]=2+F*4,X.indices[F*6+3]=0+F*4,X.indices[F*6+4]=2+F*4,X.indices[F*6+5]=3+F*4,X.vertices[F*8+0]=O,X.vertices[F*8+1]=G,X.vertices[F*8+2]=O+rt.width*i,X.vertices[F*8+3]=G,X.vertices[F*8+4]=O+rt.width*i,X.vertices[F*8+5]=G+rt.height*i,X.vertices[F*8+6]=O,X.vertices[F*8+7]=G+rt.height*i,X.uvs[F*8+0]=D.x0,X.uvs[F*8+1]=D.y0,X.uvs[F*8+2]=D.x1,X.uvs[F*8+3]=D.y1,X.uvs[F*8+4]=D.x2,X.uvs[F*8+5]=D.y2,X.uvs[F*8+6]=D.x3,X.uvs[F*8+7]=D.y3}this._textWidth=m*i,this._textHeight=(r.y+t.lineHeight)*i;for(const R in T){const A=T[R];if(this.anchor.x!==0||this.anchor.y!==0){let L=0;const X=this._textWidth*this.anchor.x,rt=this._textHeight*this.anchor.y;for(let D=0;D<A.total;D++)A.vertices[L++]-=X,A.vertices[L++]-=rt,A.vertices[L++]-=X,A.vertices[L++]-=rt,A.vertices[L++]-=X,A.vertices[L++]-=rt,A.vertices[L++]-=X,A.vertices[L++]-=rt}this._maxLineHeight=_*i;const P=A.mesh.geometry.getBuffer("aVertexPosition"),O=A.mesh.geometry.getBuffer("aTextureCoord"),G=A.mesh.geometry.getIndex();P.data=A.vertices,O.data=A.uvs,G.data=A.indices,P.update(),O.update(),G.update()}for(let R=0;R<n.length;R++)Hu.push(n[R]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:i,size:r}=si.available[this._fontName];if(i!=="none"){const{a:n,b:o,c:a,d:h}=this.worldTransform,l=Math.sqrt(n*n+o*o),u=Math.sqrt(a*a+h*h),c=(Math.abs(l)+Math.abs(u))/2,d=this.fontSize/r,f=t._view.resolution;for(const m of this._activePagesMeshData)m.mesh.shader.uniforms.uFWidth=c*e*d*f}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=si.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!si.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??si.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,i=si.available[this._fontName].distanceFieldType==="none"?Gu:zu;i.push(...this._activePagesMeshData);for(const r of this._activePagesMeshData)this.removeChild(r.mesh);this._activePagesMeshData=[],i.filter(r=>e[r.mesh.texture.baseTexture.uid]).forEach(r=>{r.mesh.texture=U.EMPTY});for(const r in e)e[r].destroy(),delete e[r];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};jx.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const Yx=[".xml",".fnt"],qx={extension:{type:B.LoadParser,priority:ve.Normal},name:"loadBitmapFont",test(s){return Yx.includes(Ft.extname(s).toLowerCase())},async testParse(s){return vn.test(s)||nh.test(s)},async parse(s,t,e){const i=vn.test(s)?vn.parse(s):nh.parse(s),{src:r}=t,{page:n}=i,o=[];for(let l=0;l<n.length;++l){const u=n[l].file;let c=Ft.join(Ft.dirname(r),u);c=Qa(c,r),o.push(c)}const a=await e.load(o),h=o.map(l=>a[l]);return si.install(i,h,!0)},async load(s,t){return(await k.ADAPTER.fetch(s)).text()},unload(s){s.destroy()}};H.add(qx);const oh=class mr extends Ge{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new mr(Object.keys(mr.defaultOptions).reduce((e,i)=>({...e,[i]:t[i]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,t.refs===0&&(t.fontFace&&document.fonts.delete(t.fontFace),delete mr.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){const{availableFonts:i}=mr;if(i[t]){const r=i[t];return this._fonts.push(r),r.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return k.ADAPTER.fetch(t).then(r=>r.blob()).then(async r=>new Promise((n,o)=>{const a=URL.createObjectURL(r),h=new FileReader;h.onload=()=>n([a,h.result]),h.onerror=o,h.readAsDataURL(r)})).then(async([r,n])=>{const o=Object.assign({family:Ft.basename(t,Ft.extname(t)),weight:"normal",style:"normal",display:"auto",src:r,dataSrc:n,refs:1,originalUrl:t,fontFace:null},e);i[t]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...t){const e=t.filter(i=>!this._overrides.includes(i));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter(i=>this._overrides.includes(i));e.length>0&&(this._overrides=this._overrides.filter(i=>!e.includes(i)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,e)=>`${t}
            @font-face {
                font-family: "${e.family}";
                src: url('${e.dataSrc}');
                font-weight: ${e.weight};
                font-style: ${e.style};
                font-display: ${e.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=eo(t)),typeof t=="number"?z_(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),r=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(e*255|0).toString(16).padStart(2,"0"));const n=`${i}px ${r}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${n} ${t}`}reset(){Object.assign(this,mr.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){const{userAgent:t}=k.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};oh.availableFonts={},oh.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Jo=oh;const hn=class gr extends Dt{constructor(t="",e={}){super(U.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const i=new Image,r=U.from(i,{scaleMode:k.SCALE_MODE,resourceOptions:{autoLoad:!1}});r.orig=new q,r.trim=new q,this.texture=r;const n="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(n,"svg"),h=document.createElementNS(n,"foreignObject"),l=document.createElementNS(o,"div"),u=document.createElementNS(o,"style");h.setAttribute("width","10000"),h.setAttribute("height","10000"),h.style.overflow="hidden",a.appendChild(h),this.maxWidth=gr.defaultMaxWidth,this.maxHeight=gr.defaultMaxHeight,this._domElement=l,this._styleElement=u,this._svgRoot=a,this._foreignObject=h,this._foreignObject.appendChild(u),this._foreignObject.appendChild(l),this._image=i,this._loadImage=new Image,this._autoResolution=gr.defaultAutoResolution,this._resolution=gr.defaultResolution??k.RESOLUTION,this.text=t,this.style=e}measureText(t){var u,c;const{text:e,style:i,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:i.toCSS(r)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const n=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=n;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const h=Math.min(this.maxWidth,Math.ceil(o)),l=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",h.toString()),this._svgRoot.setAttribute("height",l.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:(u=this._style)==null?void 0:u.toCSS(r)}),this._styleElement.textContent=(c=this._style)==null?void 0:c.toGlobalCSS()),{width:h+i.padding*2,height:l+i.padding*2}}async updateText(t=!0){const{style:e,_image:i,_loadImage:r}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:n,height:o}=this.measureText();i.width=r.width=Math.ceil(Math.max(1,n)),i.height=r.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(h=>{r.onload=async()=>{if(a<this._updateID){h();return}await e.onBeforeDraw(),i.src=r.src,r.onload=null,r.src="",this.updateTexture(),h()};const l=new XMLSerializer().serializeToString(this._svgRoot);r.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(l)}`})}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:i,resolution:r}=this,{padding:n}=t,{baseTexture:o}=e;e.trim.width=e._frame.width=i.width/r,e.trim.height=e._frame.height=i.height/r,e.trim.x=-n,e.trim.y=-n,e.orig.width=e._frame.width-n*2,e.orig.height=e._frame.height-n*2,this._onTextureUpdate(),o.setRealSize(i.width,i.height,r),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){var i,r,n,o,a;typeof t=="boolean"&&(t={children:t}),t=Object.assign({},gr.defaultDestroyOptions,t),super.destroy(t);const e=null;this.ownsStyle&&((i=this._style)==null||i.cleanFonts()),this._style=e,(r=this._svgRoot)==null||r.remove(),this._svgRoot=e,(n=this._domElement)==null||n.remove(),this._domElement=e,(o=this._foreignObject)==null||o.remove(),this._foreignObject=e,(a=this._styleElement)==null||a.remove(),this._styleElement=e,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=e,this._image.src="",this._image=e}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=ui(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=ui(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&(t=t||{},t instanceof Jo?(this.ownsStyle=!1,this._style=t):t instanceof Ge?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Jo.from(t)):(this.ownsStyle=!0,this._style=new Jo(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(t===""||t===null||t===void 0?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};hn.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},hn.defaultMaxWidth=2024,hn.defaultMaxHeight=2024,hn.defaultAutoResolution=!0;function Ve(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function lf(s,t){s.prototype=Object.create(t.prototype),s.prototype.constructor=s,s.__proto__=t}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var ie={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},kr={duration:.5,overwrite:!1,delay:0},$h,zt,ct,he=1e8,at=1/he,ah=Math.PI*2,Kx=ah/4,Zx=0,uf=Math.sqrt,Qx=Math.cos,Jx=Math.sin,Ot=function(t){return typeof t=="string"},yt=function(t){return typeof t=="function"},ti=function(t){return typeof t=="number"},Xh=function(t){return typeof t>"u"},ze=function(t){return typeof t=="object"},Wt=function(t){return t!==!1},Vh=function(){return typeof window<"u"},ln=function(t){return yt(t)||Ot(t)},cf=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Ht=Array.isArray,hh=/(?:-?\.?\d|\.)+/gi,df=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,xr=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ta=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,ff=/[+-]=-?[.\d]+/,pf=/[^,'"\[\]\s]+/gi,t1=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ft,Re,lh,Wh,re={},Vn={},mf,gf=function(t){return(Vn=Qi(t,re))&&Kt},jh=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},As=function(t,e){return!e&&console.warn(t)},_f=function(t,e){return t&&(re[t]=e)&&Vn&&(Vn[t]=e)||re},Es=function(){return 0},e1={suppressEvents:!0,isStart:!0,kill:!1},bn={suppressEvents:!0,kill:!1},i1={suppressEvents:!0},Yh={},gi=[],uh={},yf,Jt={},ea={},$u=30,Tn=[],qh="",Kh=function(t){var e=t[0],i,r;if(ze(e)||yt(e)||(t=[t]),!(i=(e._gsap||{}).harness)){for(r=Tn.length;r--&&!Tn[r].targetTest(e););i=Tn[r]}for(r=t.length;r--;)t[r]&&(t[r]._gsap||(t[r]._gsap=new Hf(t[r],i)))||t.splice(r,1);return t},Wi=function(t){return t._gsap||Kh(le(t))[0]._gsap},vf=function(t,e,i){return(i=t[e])&&yt(i)?t[e]():Xh(i)&&t.getAttribute&&t.getAttribute(e)||i},jt=function(t,e){return(t=t.split(",")).forEach(e)||t},vt=function(t){return Math.round(t*1e5)/1e5||0},Mt=function(t){return Math.round(t*1e7)/1e7||0},Ir=function(t,e){var i=e.charAt(0),r=parseFloat(e.substr(2));return t=parseFloat(t),i==="+"?t+r:i==="-"?t-r:i==="*"?t*r:t/r},r1=function(t,e){for(var i=e.length,r=0;t.indexOf(e[r])<0&&++r<i;);return r<i},Wn=function(){var t=gi.length,e=gi.slice(0),i,r;for(uh={},gi.length=0,i=0;i<t;i++)r=e[i],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},xf=function(t,e,i,r){gi.length&&!zt&&Wn(),t.render(e,i,zt&&e<0&&(t._initted||t._startAt)),gi.length&&!zt&&Wn()},bf=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(pf).length<2?e:Ot(t)?t.trim():t},Tf=function(t){return t},ue=function(t,e){for(var i in e)i in t||(t[i]=e[i]);return t},s1=function(t){return function(e,i){for(var r in i)r in e||r==="duration"&&t||r==="ease"||(e[r]=i[r])}},Qi=function(t,e){for(var i in e)t[i]=e[i];return t},Xu=function s(t,e){for(var i in e)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(t[i]=ze(e[i])?s(t[i]||(t[i]={}),e[i]):e[i]);return t},jn=function(t,e){var i={},r;for(r in t)r in e||(i[r]=t[r]);return i},fs=function(t){var e=t.parent||ft,i=t.keyframes?s1(Ht(t.keyframes)):ue;if(Wt(t.inherit))for(;e;)i(t,e.vars.defaults),e=e.parent||e._dp;return t},n1=function(t,e){for(var i=t.length,r=i===e.length;r&&i--&&t[i]===e[i];);return i<0},wf=function(t,e,i,r,n){var o=t[r],a;if(n)for(a=e[n];o&&o[n]>a;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[i],t[i]=e),e._next?e._next._prev=e:t[r]=e,e._prev=o,e.parent=e._dp=t,e},uo=function(t,e,i,r){i===void 0&&(i="_first"),r===void 0&&(r="_last");var n=e._prev,o=e._next;n?n._next=o:t[i]===e&&(t[i]=o),o?o._prev=n:t[r]===e&&(t[r]=n),e._next=e._prev=e.parent=null},xi=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},ji=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var i=t;i;)i._dirty=1,i=i.parent;return t},o1=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},ch=function(t,e,i,r){return t._startAt&&(zt?t._startAt.revert(bn):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,r))},a1=function s(t){return!t||t._ts&&s(t.parent)},Vu=function(t){return t._repeat?Nr(t._tTime,t=t.duration()+t._rDelay)*t:0},Nr=function(t,e){var i=Math.floor(t/=e);return t&&i===t?i-1:i},Yn=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},co=function(t){return t._end=Mt(t._start+(t._tDur/Math.abs(t._ts||t._rts||at)||0))},fo=function(t,e){var i=t._dp;return i&&i.smoothChildTiming&&t._ts&&(t._start=Mt(i._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),co(t),i._dirty||ji(i,t)),t},Af=function(t,e){var i;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(i=Yn(t.rawTime(),e),(!e._dur||Ls(0,e.totalDuration(),i)-e._tTime>at)&&e.render(i,!0)),ji(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(i=t;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;t._zTime=-at}},De=function(t,e,i,r){return e.parent&&xi(e),e._start=Mt((ti(i)?i:i||t!==ft?se(t,i,e):t._time)+e._delay),e._end=Mt(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),wf(t,e,"_first","_last",t._sort?"_start":0),dh(e)||(t._recent=e),r||Af(t,e),t._ts<0&&fo(t,t._tTime),t},Ef=function(t,e){return(re.ScrollTrigger||jh("scrollTrigger",e))&&re.ScrollTrigger.create(e,t)},Sf=function(t,e,i,r,n){if(Qh(t,e,n),!t._initted)return 1;if(!i&&t._pt&&!zt&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&yf!==te.frame)return gi.push(t),t._lazy=[n,r],1},h1=function s(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||s(e))},dh=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},l1=function(t,e,i,r){var n=t.ratio,o=e<0||!e&&(!t._start&&h1(t)&&!(!t._initted&&dh(t))||(t._ts<0||t._dp._ts<0)&&!dh(t))?0:1,a=t._rDelay,h=0,l,u,c;if(a&&t._repeat&&(h=Ls(0,t._tDur,e),u=Nr(h,a),t._yoyo&&u&1&&(o=1-o),u!==Nr(t._tTime,a)&&(n=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),o!==n||zt||r||t._zTime===at||!e&&t._zTime){if(!t._initted&&Sf(t,e,r,i,h))return;for(c=t._zTime,t._zTime=e||(i?at:0),i||(i=e&&!c),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=h,l=t._pt;l;)l.r(o,l.d),l=l._next;e<0&&ch(t,e,i,!0),t._onUpdate&&!i&&ee(t,"onUpdate"),h&&t._repeat&&!i&&t.parent&&ee(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===o&&(o&&xi(t,1),!i&&!zt&&(ee(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},u1=function(t,e,i){var r;if(i>e)for(r=t._first;r&&r._start<=i;){if(r.data==="isPause"&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=i;){if(r.data==="isPause"&&r._start<e)return r;r=r._prev}},Ur=function(t,e,i,r){var n=t._repeat,o=Mt(e)||0,a=t._tTime/t._tDur;return a&&!r&&(t._time*=o/t._dur),t._dur=o,t._tDur=n?n<0?1e10:Mt(o*(n+1)+t._rDelay*n):o,a>0&&!r&&fo(t,t._tTime=t._tDur*a),t.parent&&co(t),i||ji(t.parent,t),t},Wu=function(t){return t instanceof Xt?ji(t):Ur(t,t._dur)},c1={_start:0,endTime:Es,totalDuration:Es},se=function s(t,e,i){var r=t.labels,n=t._recent||c1,o=t.duration()>=he?n.endTime(!1):t._dur,a,h,l;return Ot(e)&&(isNaN(e)||e in r)?(h=e.charAt(0),l=e.substr(-1)==="%",a=e.indexOf("="),h==="<"||h===">"?(a>=0&&(e=e.replace(/=/,"")),(h==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(e.substr(1))||0)*(l?(a<0?n:i).totalDuration()/100:1)):a<0?(e in r||(r[e]=o),r[e]):(h=parseFloat(e.charAt(a-1)+e.substr(a+1)),l&&i&&(h=h/100*(Ht(i)?i[0]:i).totalDuration()),a>1?s(t,e.substr(0,a-1),i)+h:o+h)):e==null?o:+e},ps=function(t,e,i){var r=ti(e[1]),n=(r?2:1)+(t<2?0:1),o=e[n],a,h;if(r&&(o.duration=e[1]),o.parent=i,t){for(a=o,h=i;h&&!("immediateRender"in a);)a=h.vars.defaults||{},h=Wt(h.vars.inherit)&&h.parent;o.immediateRender=Wt(a.immediateRender),t<2?o.runBackwards=1:o.startAt=e[n-1]}return new wt(e[0],o,e[n+1])},Ei=function(t,e){return t||t===0?e(t):e},Ls=function(t,e,i){return i<t?t:i>e?e:i},Gt=function(t,e){return!Ot(t)||!(e=t1.exec(t))?"":e[1]},d1=function(t,e,i){return Ei(i,function(r){return Ls(t,e,r)})},fh=[].slice,Cf=function(t,e){return t&&ze(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&ze(t[0]))&&!t.nodeType&&t!==Re},f1=function(t,e,i){return i===void 0&&(i=[]),t.forEach(function(r){var n;return Ot(r)&&!e||Cf(r,1)?(n=i).push.apply(n,le(r)):i.push(r)})||i},le=function(t,e,i){return ct&&!e&&ct.selector?ct.selector(t):Ot(t)&&!i&&(lh||!Gr())?fh.call((e||Wh).querySelectorAll(t),0):Ht(t)?f1(t,i):Cf(t)?fh.call(t,0):t?[t]:[]},ph=function(t){return t=le(t)[0]||As("Invalid scope")||{},function(e){var i=t.current||t.nativeElement||t;return le(e,i.querySelectorAll?i:i===t?As("Invalid scope")||Wh.createElement("div"):t)}},Pf=function(t){return t.sort(function(){return .5-Math.random()})},Rf=function(t){if(yt(t))return t;var e=ze(t)?t:{each:t},i=Yi(e.ease),r=e.from||0,n=parseFloat(e.base)||0,o={},a=r>0&&r<1,h=isNaN(r)||a,l=e.axis,u=r,c=r;return Ot(r)?u=c={center:.5,edges:.5,end:1}[r]||0:!a&&h&&(u=r[0],c=r[1]),function(d,f,m){var p=(m||e).length,g=o[p],y,x,_,v,b,S,w,T,E;if(!g){if(E=e.grid==="auto"?0:(e.grid||[1,he])[1],!E){for(w=-he;w<(w=m[E++].getBoundingClientRect().left)&&E<p;);E<p&&E--}for(g=o[p]=[],y=h?Math.min(E,p)*u-.5:r%E,x=E===he?0:h?p*c/E-.5:r/E|0,w=0,T=he,S=0;S<p;S++)_=S%E-y,v=x-(S/E|0),g[S]=b=l?Math.abs(l==="y"?v:_):uf(_*_+v*v),b>w&&(w=b),b<T&&(T=b);r==="random"&&Pf(g),g.max=w-T,g.min=T,g.v=p=(parseFloat(e.amount)||parseFloat(e.each)*(E>p?p-1:l?l==="y"?p/E:E:Math.max(E,p/E))||0)*(r==="edges"?-1:1),g.b=p<0?n-p:n,g.u=Gt(e.amount||e.each)||0,i=i&&p<0?Uf(i):i}return p=(g[d]-g.min)/g.max||0,Mt(g.b+(i?i(p):p)*g.v)+g.u}},mh=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(i){var r=Mt(Math.round(parseFloat(i)/t)*t*e);return(r-r%1)/e+(ti(i)?0:Gt(i))}},If=function(t,e){var i=Ht(t),r,n;return!i&&ze(t)&&(r=i=t.radius||he,t.values?(t=le(t.values),(n=!ti(t[0]))&&(r*=r)):t=mh(t.increment)),Ei(e,i?yt(t)?function(o){return n=t(o),Math.abs(n-o)<=r?n:o}:function(o){for(var a=parseFloat(n?o.x:o),h=parseFloat(n?o.y:0),l=he,u=0,c=t.length,d,f;c--;)n?(d=t[c].x-a,f=t[c].y-h,d=d*d+f*f):d=Math.abs(t[c]-a),d<l&&(l=d,u=c);return u=!r||l<=r?t[u]:o,n||u===o||ti(o)?u:u+Gt(o)}:mh(t))},Mf=function(t,e,i,r){return Ei(Ht(t)?!e:i===!0?!!(i=0):!r,function(){return Ht(t)?t[~~(Math.random()*t.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((t-i/2+Math.random()*(e-t+i*.99))/i)*i*r)/r})},p1=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(r){return e.reduce(function(n,o){return o(n)},r)}},m1=function(t,e){return function(i){return t(parseFloat(i))+(e||Gt(i))}},g1=function(t,e,i){return Ff(t,e,0,1,i)},Df=function(t,e,i){return Ei(i,function(r){return t[~~e(r)]})},_1=function s(t,e,i){var r=e-t;return Ht(t)?Df(t,s(0,t.length),e):Ei(i,function(n){return(r+(n-t)%r)%r+t})},y1=function s(t,e,i){var r=e-t,n=r*2;return Ht(t)?Df(t,s(0,t.length-1),e):Ei(i,function(o){return o=(n+(o-t)%n)%n||0,t+(o>r?n-o:o)})},Ss=function(t){for(var e=0,i="",r,n,o,a;~(r=t.indexOf("random(",e));)o=t.indexOf(")",r),a=t.charAt(r+7)==="[",n=t.substr(r+7,o-r-7).match(a?pf:hh),i+=t.substr(e,r-e)+Mf(a?n:+n[0],a?0:+n[1],+n[2]||1e-5),e=o+1;return i+t.substr(e,t.length-e)},Ff=function(t,e,i,r,n){var o=e-t,a=r-i;return Ei(n,function(h){return i+((h-t)/o*a||0)})},v1=function s(t,e,i,r){var n=isNaN(t+e)?0:function(f){return(1-f)*t+f*e};if(!n){var o=Ot(t),a={},h,l,u,c,d;if(i===!0&&(r=1)&&(i=null),o)t={p:t},e={p:e};else if(Ht(t)&&!Ht(e)){for(u=[],c=t.length,d=c-2,l=1;l<c;l++)u.push(s(t[l-1],t[l]));c--,n=function(m){m*=c;var p=Math.min(d,~~m);return u[p](m-p)},i=e}else r||(t=Qi(Ht(t)?[]:{},t));if(!u){for(h in e)Zh.call(a,t,h,"get",e[h]);n=function(m){return el(m,a)||(o?t.p:t)}}}return Ei(i,n)},ju=function(t,e,i){var r=t.labels,n=he,o,a,h;for(o in r)a=r[o]-e,a<0==!!i&&a&&n>(a=Math.abs(a))&&(h=o,n=a);return h},ee=function(t,e,i){var r=t.vars,n=r[e],o=ct,a=t._ctx,h,l,u;if(n)return h=r[e+"Params"],l=r.callbackScope||t,i&&gi.length&&Wn(),a&&(ct=a),u=h?n.apply(l,h):n.call(l),ct=o,u},os=function(t){return xi(t),t.scrollTrigger&&t.scrollTrigger.kill(!!zt),t.progress()<1&&ee(t,"onInterrupt"),t},br,Of=[],Bf=function(t){if(t)if(t=!t.name&&t.default||t,Vh()||t.headless){var e=t.name,i=yt(t),r=e&&!i&&t.init?function(){this._props=[]}:t,n={init:Es,render:el,add:Zh,kill:B1,modifier:O1,rawVars:0},o={targetTest:0,get:0,getSetter:tl,aliases:{},register:0};if(Gr(),t!==r){if(Jt[e])return;ue(r,ue(jn(t,n),o)),Qi(r.prototype,Qi(n,jn(t,o))),Jt[r.prop=e]=r,t.targetTest&&(Tn.push(r),Yh[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}_f(e,r),t.register&&t.register(Kt,r,Yt)}else Of.push(t)},st=255,as={aqua:[0,st,st],lime:[0,st,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,st],navy:[0,0,128],white:[st,st,st],olive:[128,128,0],yellow:[st,st,0],orange:[st,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[st,0,0],pink:[st,192,203],cyan:[0,st,st],transparent:[st,st,st,0]},ia=function(t,e,i){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(i-e)*t*6:t<.5?i:t*3<2?e+(i-e)*(2/3-t)*6:e)*st+.5|0},Lf=function(t,e,i){var r=t?ti(t)?[t>>16,t>>8&st,t&st]:0:as.black,n,o,a,h,l,u,c,d,f,m;if(!r){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),as[t])r=as[t];else if(t.charAt(0)==="#"){if(t.length<6&&(n=t.charAt(1),o=t.charAt(2),a=t.charAt(3),t="#"+n+n+o+o+a+a+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return r=parseInt(t.substr(1,6),16),[r>>16,r>>8&st,r&st,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),r=[t>>16,t>>8&st,t&st]}else if(t.substr(0,3)==="hsl"){if(r=m=t.match(hh),!e)h=+r[0]%360/360,l=+r[1]/100,u=+r[2]/100,o=u<=.5?u*(l+1):u+l-u*l,n=u*2-o,r.length>3&&(r[3]*=1),r[0]=ia(h+1/3,n,o),r[1]=ia(h,n,o),r[2]=ia(h-1/3,n,o);else if(~t.indexOf("="))return r=t.match(df),i&&r.length<4&&(r[3]=1),r}else r=t.match(hh)||as.transparent;r=r.map(Number)}return e&&!m&&(n=r[0]/st,o=r[1]/st,a=r[2]/st,c=Math.max(n,o,a),d=Math.min(n,o,a),u=(c+d)/2,c===d?h=l=0:(f=c-d,l=u>.5?f/(2-c-d):f/(c+d),h=c===n?(o-a)/f+(o<a?6:0):c===o?(a-n)/f+2:(n-o)/f+4,h*=60),r[0]=~~(h+.5),r[1]=~~(l*100+.5),r[2]=~~(u*100+.5)),i&&r.length<4&&(r[3]=1),r},kf=function(t){var e=[],i=[],r=-1;return t.split(_i).forEach(function(n){var o=n.match(xr)||[];e.push.apply(e,o),i.push(r+=o.length+1)}),e.c=i,e},Yu=function(t,e,i){var r="",n=(t+r).match(_i),o=e?"hsla(":"rgba(",a=0,h,l,u,c;if(!n)return t;if(n=n.map(function(d){return(d=Lf(d,e,1))&&o+(e?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),i&&(u=kf(t),h=i.c,h.join(r)!==u.c.join(r)))for(l=t.replace(_i,"1").split(xr),c=l.length-1;a<c;a++)r+=l[a]+(~h.indexOf(a)?n.shift()||o+"0,0,0,0)":(u.length?u:n.length?n:i).shift());if(!l)for(l=t.split(_i),c=l.length-1;a<c;a++)r+=l[a]+n[a];return r+l[c]},_i=function(){var s="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in as)s+="|"+t+"\\b";return new RegExp(s+")","gi")}(),x1=/hsl[a]?\(/,Nf=function(t){var e=t.join(" "),i;if(_i.lastIndex=0,_i.test(e))return i=x1.test(e),t[1]=Yu(t[1],i),t[0]=Yu(t[0],i,kf(t[1])),!0},Cs,te=function(){var s=Date.now,t=500,e=33,i=s(),r=i,n=1e3/240,o=n,a=[],h,l,u,c,d,f,m=function p(g){var y=s()-r,x=g===!0,_,v,b,S;if((y>t||y<0)&&(i+=y-e),r+=y,b=r-i,_=b-o,(_>0||x)&&(S=++c.frame,d=b-c.time*1e3,c.time=b=b/1e3,o+=_+(_>=n?4:n-_),v=1),x||(h=l(p)),v)for(f=0;f<a.length;f++)a[f](b,d,S,g)};return c={time:0,frame:0,tick:function(){m(!0)},deltaRatio:function(g){return d/(1e3/(g||60))},wake:function(){mf&&(!lh&&Vh()&&(Re=lh=window,Wh=Re.document||{},re.gsap=Kt,(Re.gsapVersions||(Re.gsapVersions=[])).push(Kt.version),gf(Vn||Re.GreenSockGlobals||!Re.gsap&&Re||{}),Of.forEach(Bf)),u=typeof requestAnimationFrame<"u"&&requestAnimationFrame,h&&c.sleep(),l=u||function(g){return setTimeout(g,o-c.time*1e3+1|0)},Cs=1,m(2))},sleep:function(){(u?cancelAnimationFrame:clearTimeout)(h),Cs=0,l=Es},lagSmoothing:function(g,y){t=g||1/0,e=Math.min(y||33,t)},fps:function(g){n=1e3/(g||240),o=c.time*1e3+n},add:function(g,y,x){var _=y?function(v,b,S,w){g(v,b,S,w),c.remove(_)}:g;return c.remove(g),a[x?"unshift":"push"](_),Gr(),_},remove:function(g,y){~(y=a.indexOf(g))&&a.splice(y,1)&&f>=y&&f--},_listeners:a},c}(),Gr=function(){return!Cs&&te.wake()},tt={},b1=/^[\d.\-M][\d.\-,\s]/,T1=/["']/g,w1=function(t){for(var e={},i=t.substr(1,t.length-3).split(":"),r=i[0],n=1,o=i.length,a,h,l;n<o;n++)h=i[n],a=n!==o-1?h.lastIndexOf(","):h.length,l=h.substr(0,a),e[r]=isNaN(l)?l.replace(T1,"").trim():+l,r=h.substr(a+1).trim();return e},A1=function(t){var e=t.indexOf("(")+1,i=t.indexOf(")"),r=t.indexOf("(",e);return t.substring(e,~r&&r<i?t.indexOf(")",i+1):i)},E1=function(t){var e=(t+"").split("("),i=tt[e[0]];return i&&e.length>1&&i.config?i.config.apply(null,~t.indexOf("{")?[w1(e[1])]:A1(t).split(",").map(bf)):tt._CE&&b1.test(t)?tt._CE("",t):i},Uf=function(t){return function(e){return 1-t(1-e)}},Gf=function s(t,e){for(var i=t._first,r;i;)i instanceof Xt?s(i,e):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==e&&(i.timeline?s(i.timeline,e):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=e)),i=i._next},Yi=function(t,e){return t&&(yt(t)?t:tt[t]||E1(t))||e},ir=function(t,e,i,r){i===void 0&&(i=function(h){return 1-e(1-h)}),r===void 0&&(r=function(h){return h<.5?e(h*2)/2:1-e((1-h)*2)/2});var n={easeIn:e,easeOut:i,easeInOut:r},o;return jt(t,function(a){tt[a]=re[a]=n,tt[o=a.toLowerCase()]=i;for(var h in n)tt[o+(h==="easeIn"?".in":h==="easeOut"?".out":".inOut")]=tt[a+"."+h]=n[h]}),n},zf=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},ra=function s(t,e,i){var r=e>=1?e:1,n=(i||(t?.3:.45))/(e<1?e:1),o=n/ah*(Math.asin(1/r)||0),a=function(u){return u===1?1:r*Math.pow(2,-10*u)*Jx((u-o)*n)+1},h=t==="out"?a:t==="in"?function(l){return 1-a(1-l)}:zf(a);return n=ah/n,h.config=function(l,u){return s(t,l,u)},h},sa=function s(t,e){e===void 0&&(e=1.70158);var i=function(o){return o?--o*o*((e+1)*o+e)+1:0},r=t==="out"?i:t==="in"?function(n){return 1-i(1-n)}:zf(i);return r.config=function(n){return s(t,n)},r};jt("Linear,Quad,Cubic,Quart,Quint,Strong",function(s,t){var e=t<5?t+1:t;ir(s+",Power"+(e-1),t?function(i){return Math.pow(i,e)}:function(i){return i},function(i){return 1-Math.pow(1-i,e)},function(i){return i<.5?Math.pow(i*2,e)/2:1-Math.pow((1-i)*2,e)/2})});tt.Linear.easeNone=tt.none=tt.Linear.easeIn;ir("Elastic",ra("in"),ra("out"),ra());(function(s,t){var e=1/t,i=2*e,r=2.5*e,n=function(a){return a<e?s*a*a:a<i?s*Math.pow(a-1.5/t,2)+.75:a<r?s*(a-=2.25/t)*a+.9375:s*Math.pow(a-2.625/t,2)+.984375};ir("Bounce",function(o){return 1-n(1-o)},n)})(7.5625,2.75);ir("Expo",function(s){return s?Math.pow(2,10*(s-1)):0});ir("Circ",function(s){return-(uf(1-s*s)-1)});ir("Sine",function(s){return s===1?1:-Qx(s*Kx)+1});ir("Back",sa("in"),sa("out"),sa());tt.SteppedEase=tt.steps=re.SteppedEase={config:function(t,e){t===void 0&&(t=1);var i=1/t,r=t+(e?0:1),n=e?1:0,o=1-at;return function(a){return((r*Ls(0,o,a)|0)+n)*i}}};kr.ease=tt["quad.out"];jt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(s){return qh+=s+","+s+"Params,"});var Hf=function(t,e){this.id=Zx++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:vf,this.set=e?e.getSetter:tl},Ps=function(){function s(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,Ur(this,+e.duration,1,1),this.data=e.data,ct&&(this._ctx=ct,ct.data.push(this)),Cs||te.wake()}var t=s.prototype;return t.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},t.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},t.totalDuration=function(i){return arguments.length?(this._dirty=0,Ur(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(i,r){if(Gr(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(fo(this,i),!n._dp||n.parent||Af(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&De(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===at||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),xf(this,i,r)),this},t.time=function(i,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+Vu(this))%(this._dur+this._rDelay)||(i?this._dur:0),r):this._time},t.totalProgress=function(i,r){return arguments.length?this.totalTime(this.totalDuration()*i,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},t.progress=function(i,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+Vu(this),r):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(i,r){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*n,r):this._repeat?Nr(this._tTime,n)+1:1},t.timeScale=function(i,r){if(!arguments.length)return this._rts===-at?0:this._rts;if(this._rts===i)return this;var n=this.parent&&this._ts?Yn(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-at?0:this._rts,this.totalTime(Ls(-Math.abs(this._delay),this._tDur,n),r!==!1),co(this),o1(this)},t.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Gr(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==at&&(this._tTime-=at)))),this):this._ps},t.startTime=function(i){if(arguments.length){this._start=i;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&De(r,this,i-this._delay),this}return this._start},t.endTime=function(i){return this._start+(Wt(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(i){var r=this.parent||this._dp;return r?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Yn(r.rawTime(i),this):this._tTime:this._tTime},t.revert=function(i){i===void 0&&(i=i1);var r=zt;return zt=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),zt=r,this},t.globalTime=function(i){for(var r=this,n=arguments.length?i:r.rawTime();r;)n=r._start+n/(Math.abs(r._ts)||1),r=r._dp;return!this.parent&&this._sat?this._sat.globalTime(i):n},t.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,Wu(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(i){if(arguments.length){var r=this._time;return this._rDelay=i,Wu(this),r?this.time(r):this}return this._rDelay},t.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},t.seek=function(i,r){return this.totalTime(se(this,i),Wt(r))},t.restart=function(i,r){return this.play().totalTime(i?-this._delay:0,Wt(r))},t.play=function(i,r){return i!=null&&this.seek(i,r),this.reversed(!1).paused(!1)},t.reverse=function(i,r){return i!=null&&this.seek(i||this.totalDuration(),r),this.reversed(!0).paused(!1)},t.pause=function(i,r){return i!=null&&this.seek(i,r),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-at:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-at,this},t.isActive=function(){var i=this.parent||this._dp,r=this._start,n;return!!(!i||this._ts&&this._initted&&i.isActive()&&(n=i.rawTime(!0))>=r&&n<this.endTime(!0)-at)},t.eventCallback=function(i,r,n){var o=this.vars;return arguments.length>1?(r?(o[i]=r,n&&(o[i+"Params"]=n),i==="onUpdate"&&(this._onUpdate=r)):delete o[i],this):o[i]},t.then=function(i){var r=this;return new Promise(function(n){var o=yt(i)?i:Tf,a=function(){var l=r.then;r.then=null,yt(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=l),n(o),r.then=l};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},t.kill=function(){os(this)},s}();ue(Ps.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-at,_prom:0,_ps:!1,_rts:1});var Xt=function(s){lf(t,s);function t(i,r){var n;return i===void 0&&(i={}),n=s.call(this,i)||this,n.labels={},n.smoothChildTiming=!!i.smoothChildTiming,n.autoRemoveChildren=!!i.autoRemoveChildren,n._sort=Wt(i.sortChildren),ft&&De(i.parent||ft,Ve(n),r),i.reversed&&n.reverse(),i.paused&&n.paused(!0),i.scrollTrigger&&Ef(Ve(n),i.scrollTrigger),n}var e=t.prototype;return e.to=function(r,n,o){return ps(0,arguments,this),this},e.from=function(r,n,o){return ps(1,arguments,this),this},e.fromTo=function(r,n,o,a){return ps(2,arguments,this),this},e.set=function(r,n,o){return n.duration=0,n.parent=this,fs(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new wt(r,n,se(this,o),1),this},e.call=function(r,n,o){return De(this,wt.delayedCall(0,r,n),o)},e.staggerTo=function(r,n,o,a,h,l,u){return o.duration=n,o.stagger=o.stagger||a,o.onComplete=l,o.onCompleteParams=u,o.parent=this,new wt(r,o,se(this,h)),this},e.staggerFrom=function(r,n,o,a,h,l,u){return o.runBackwards=1,fs(o).immediateRender=Wt(o.immediateRender),this.staggerTo(r,n,o,a,h,l,u)},e.staggerFromTo=function(r,n,o,a,h,l,u,c){return a.startAt=o,fs(a).immediateRender=Wt(a.immediateRender),this.staggerTo(r,n,a,h,l,u,c)},e.render=function(r,n,o){var a=this._time,h=this._dirty?this.totalDuration():this._tDur,l=this._dur,u=r<=0?0:Mt(r),c=this._zTime<0!=r<0&&(this._initted||!l),d,f,m,p,g,y,x,_,v,b,S,w;if(this!==ft&&u>h&&r>=0&&(u=h),u!==this._tTime||o||c){if(a!==this._time&&l&&(u+=this._time-a,r+=this._time-a),d=u,v=this._start,_=this._ts,y=!_,c&&(l||(a=this._zTime),(r||!n)&&(this._zTime=r)),this._repeat){if(S=this._yoyo,g=l+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(g*100+r,n,o);if(d=Mt(u%g),u===h?(p=this._repeat,d=l):(p=~~(u/g),p&&p===u/g&&(d=l,p--),d>l&&(d=l)),b=Nr(this._tTime,g),!a&&this._tTime&&b!==p&&this._tTime-b*g-this._dur<=0&&(b=p),S&&p&1&&(d=l-d,w=1),p!==b&&!this._lock){var T=S&&b&1,E=T===(S&&p&1);if(p<b&&(T=!T),a=T?0:u%l?l:u,this._lock=1,this.render(a||(w?0:Mt(p*g)),n,!l)._lock=0,this._tTime=u,!n&&this.parent&&ee(this,"onRepeat"),this.vars.repeatRefresh&&!w&&(this.invalidate()._lock=1),a&&a!==this._time||y!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,h=this._tDur,E&&(this._lock=2,a=T?l:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!w&&this.invalidate()),this._lock=0,!this._ts&&!y)return this;Gf(this,w)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(x=u1(this,Mt(a),Mt(d)),x&&(u-=d-(d=x._start))),this._tTime=u,this._time=d,this._act=!_,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&d&&!n&&!p&&(ee(this,"onStart"),this._tTime!==u))return this;if(d>=a&&r>=0)for(f=this._first;f;){if(m=f._next,(f._act||d>=f._start)&&f._ts&&x!==f){if(f.parent!==this)return this.render(r,n,o);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,n,o),d!==this._time||!this._ts&&!y){x=0,m&&(u+=this._zTime=-at);break}}f=m}else{f=this._last;for(var I=r<0?r:d;f;){if(m=f._prev,(f._act||I<=f._end)&&f._ts&&x!==f){if(f.parent!==this)return this.render(r,n,o);if(f.render(f._ts>0?(I-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(I-f._start)*f._ts,n,o||zt&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!y){x=0,m&&(u+=this._zTime=I?-at:at);break}}f=m}}if(x&&!n&&(this.pause(),x.render(d>=a?0:-at)._zTime=d>=a?1:-1,this._ts))return this._start=v,co(this),this.render(r,n,o);this._onUpdate&&!n&&ee(this,"onUpdate",!0),(u===h&&this._tTime>=this.totalDuration()||!u&&a)&&(v===this._start||Math.abs(_)!==Math.abs(this._ts))&&(this._lock||((r||!l)&&(u===h&&this._ts>0||!u&&this._ts<0)&&xi(this,1),!n&&!(r<0&&!a)&&(u||a||!h)&&(ee(this,u===h&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<h&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(r,n){var o=this;if(ti(n)||(n=se(this,n,r)),!(r instanceof Ps)){if(Ht(r))return r.forEach(function(a){return o.add(a,n)}),this;if(Ot(r))return this.addLabel(r,n);if(yt(r))r=wt.delayedCall(0,r);else return this}return this!==r?De(this,r,n):this},e.getChildren=function(r,n,o,a){r===void 0&&(r=!0),n===void 0&&(n=!0),o===void 0&&(o=!0),a===void 0&&(a=-he);for(var h=[],l=this._first;l;)l._start>=a&&(l instanceof wt?n&&h.push(l):(o&&h.push(l),r&&h.push.apply(h,l.getChildren(!0,n,o)))),l=l._next;return h},e.getById=function(r){for(var n=this.getChildren(1,1,1),o=n.length;o--;)if(n[o].vars.id===r)return n[o]},e.remove=function(r){return Ot(r)?this.removeLabel(r):yt(r)?this.killTweensOf(r):(uo(this,r),r===this._recent&&(this._recent=this._last),ji(this))},e.totalTime=function(r,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Mt(te.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),s.prototype.totalTime.call(this,r,n),this._forcing=0,this):this._tTime},e.addLabel=function(r,n){return this.labels[r]=se(this,n),this},e.removeLabel=function(r){return delete this.labels[r],this},e.addPause=function(r,n,o){var a=wt.delayedCall(0,n||Es,o);return a.data="isPause",this._hasPause=1,De(this,a,se(this,r))},e.removePause=function(r){var n=this._first;for(r=se(this,r);n;)n._start===r&&n.data==="isPause"&&xi(n),n=n._next},e.killTweensOf=function(r,n,o){for(var a=this.getTweensOf(r,o),h=a.length;h--;)di!==a[h]&&a[h].kill(r,n);return this},e.getTweensOf=function(r,n){for(var o=[],a=le(r),h=this._first,l=ti(n),u;h;)h instanceof wt?r1(h._targets,a)&&(l?(!di||h._initted&&h._ts)&&h.globalTime(0)<=n&&h.globalTime(h.totalDuration())>n:!n||h.isActive())&&o.push(h):(u=h.getTweensOf(a,n)).length&&o.push.apply(o,u),h=h._next;return o},e.tweenTo=function(r,n){n=n||{};var o=this,a=se(o,r),h=n,l=h.startAt,u=h.onStart,c=h.onStartParams,d=h.immediateRender,f,m=wt.to(o,ue({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale())||at,onStart:function(){if(o.pause(),!f){var g=n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale());m._dur!==g&&Ur(m,g,0,1).render(m._time,!0,!0),f=1}u&&u.apply(m,c||[])}},n));return d?m.render(0):m},e.tweenFromTo=function(r,n,o){return this.tweenTo(n,ue({startAt:{time:se(this,r)}},o))},e.recent=function(){return this._recent},e.nextLabel=function(r){return r===void 0&&(r=this._time),ju(this,se(this,r))},e.previousLabel=function(r){return r===void 0&&(r=this._time),ju(this,se(this,r),1)},e.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+at)},e.shiftChildren=function(r,n,o){o===void 0&&(o=0);for(var a=this._first,h=this.labels,l;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(n)for(l in h)h[l]>=o&&(h[l]+=r);return ji(this)},e.invalidate=function(r){var n=this._first;for(this._lock=0;n;)n.invalidate(r),n=n._next;return s.prototype.invalidate.call(this,r)},e.clear=function(r){r===void 0&&(r=!0);for(var n=this._first,o;n;)o=n._next,this.remove(n),n=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),ji(this)},e.totalDuration=function(r){var n=0,o=this,a=o._last,h=he,l,u,c;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(c=o.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>h&&o._sort&&a._ts&&!o._lock?(o._lock=1,De(o,a,u-a._delay,1)._lock=0):h=u,u<0&&a._ts&&(n-=u,(!c&&!o._dp||c&&c.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),h=0),a._end>n&&a._ts&&(n=a._end),a=l;Ur(o,o===ft&&o._time>n?o._time:n,1,1),o._dirty=0}return o._tDur},t.updateRoot=function(r){if(ft._ts&&(xf(ft,Yn(r,ft)),yf=te.frame),te.frame>=$u){$u+=ie.autoSleep||120;var n=ft._first;if((!n||!n._ts)&&ie.autoSleep&&te._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||te.sleep()}}},t}(Ps);ue(Xt.prototype,{_lock:0,_hasPause:0,_forcing:0});var S1=function(t,e,i,r,n,o,a){var h=new Yt(this._pt,t,e,0,1,Yf,null,n),l=0,u=0,c,d,f,m,p,g,y,x;for(h.b=i,h.e=r,i+="",r+="",(y=~r.indexOf("random("))&&(r=Ss(r)),o&&(x=[i,r],o(x,t,e),i=x[0],r=x[1]),d=i.match(ta)||[];c=ta.exec(r);)m=c[0],p=r.substring(l,c.index),f?f=(f+1)%5:p.substr(-5)==="rgba("&&(f=1),m!==d[u++]&&(g=parseFloat(d[u-1])||0,h._pt={_next:h._pt,p:p||u===1?p:",",s:g,c:m.charAt(1)==="="?Ir(g,m)-g:parseFloat(m)-g,m:f&&f<4?Math.round:0},l=ta.lastIndex);return h.c=l<r.length?r.substring(l,r.length):"",h.fp=a,(ff.test(r)||y)&&(h.e=0),this._pt=h,h},Zh=function(t,e,i,r,n,o,a,h,l,u){yt(r)&&(r=r(n||0,t,o));var c=t[e],d=i!=="get"?i:yt(c)?l?t[e.indexOf("set")||!yt(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():c,f=yt(c)?l?M1:Wf:Jh,m;if(Ot(r)&&(~r.indexOf("random(")&&(r=Ss(r)),r.charAt(1)==="="&&(m=Ir(d,r)+(Gt(d)||0),(m||m===0)&&(r=m))),!u||d!==r||gh)return!isNaN(d*r)&&r!==""?(m=new Yt(this._pt,t,e,+d||0,r-(d||0),typeof c=="boolean"?F1:jf,0,f),l&&(m.fp=l),a&&m.modifier(a,this,t),this._pt=m):(!c&&!(e in t)&&jh(e,r),S1.call(this,t,e,d,r,f,h||ie.stringFilter,l))},C1=function(t,e,i,r,n){if(yt(t)&&(t=ms(t,n,e,i,r)),!ze(t)||t.style&&t.nodeType||Ht(t)||cf(t))return Ot(t)?ms(t,n,e,i,r):t;var o={},a;for(a in t)o[a]=ms(t[a],n,e,i,r);return o},$f=function(t,e,i,r,n,o){var a,h,l,u;if(Jt[t]&&(a=new Jt[t]).init(n,a.rawVars?e[t]:C1(e[t],r,n,o,i),i,r,o)!==!1&&(i._pt=h=new Yt(i._pt,n,t,0,1,a.render,a,0,a.priority),i!==br))for(l=i._ptLookup[i._targets.indexOf(n)],u=a._props.length;u--;)l[a._props[u]]=h;return a},di,gh,Qh=function s(t,e,i){var r=t.vars,n=r.ease,o=r.startAt,a=r.immediateRender,h=r.lazy,l=r.onUpdate,u=r.runBackwards,c=r.yoyoEase,d=r.keyframes,f=r.autoRevert,m=t._dur,p=t._startAt,g=t._targets,y=t.parent,x=y&&y.data==="nested"?y.vars.targets:g,_=t._overwrite==="auto"&&!$h,v=t.timeline,b,S,w,T,E,I,z,R,A,P,O,G,L;if(v&&(!d||!n)&&(n="none"),t._ease=Yi(n,kr.ease),t._yEase=c?Uf(Yi(c===!0?n:c,kr.ease)):0,c&&t._yoyo&&!t._repeat&&(c=t._yEase,t._yEase=t._ease,t._ease=c),t._from=!v&&!!r.runBackwards,!v||d&&!r.stagger){if(R=g[0]?Wi(g[0]).harness:0,G=R&&r[R.prop],b=jn(r,Yh),p&&(p._zTime<0&&p.progress(1),e<0&&u&&a&&!f?p.render(-1,!0):p.revert(u&&m?bn:e1),p._lazy=0),o){if(xi(t._startAt=wt.set(g,ue({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:!p&&Wt(h),startAt:null,delay:0,onUpdate:l&&function(){return ee(t,"onUpdate")},stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,e<0&&(zt||!a&&!f)&&t._startAt.revert(bn),a&&m&&e<=0&&i<=0){e&&(t._zTime=e);return}}else if(u&&m&&!p){if(e&&(a=!1),w=ue({overwrite:!1,data:"isFromStart",lazy:a&&!p&&Wt(h),immediateRender:a,stagger:0,parent:y},b),G&&(w[R.prop]=G),xi(t._startAt=wt.set(g,w)),t._startAt._dp=0,t._startAt._sat=t,e<0&&(zt?t._startAt.revert(bn):t._startAt.render(-1,!0)),t._zTime=e,!a)s(t._startAt,at,at);else if(!e)return}for(t._pt=t._ptCache=0,h=m&&Wt(h)||h&&!m,S=0;S<g.length;S++){if(E=g[S],z=E._gsap||Kh(g)[S]._gsap,t._ptLookup[S]=P={},uh[z.id]&&gi.length&&Wn(),O=x===g?S:x.indexOf(E),R&&(A=new R).init(E,G||b,t,O,x)!==!1&&(t._pt=T=new Yt(t._pt,E,A.name,0,1,A.render,A,0,A.priority),A._props.forEach(function(X){P[X]=T}),A.priority&&(I=1)),!R||G)for(w in b)Jt[w]&&(A=$f(w,b,t,O,E,x))?A.priority&&(I=1):P[w]=T=Zh.call(t,E,w,"get",b[w],O,x,0,r.stringFilter);t._op&&t._op[S]&&t.kill(E,t._op[S]),_&&t._pt&&(di=t,ft.killTweensOf(E,P,t.globalTime(e)),L=!t.parent,di=0),t._pt&&h&&(uh[z.id]=1)}I&&qf(t),t._onInit&&t._onInit(t)}t._onUpdate=l,t._initted=(!t._op||t._pt)&&!L,d&&e<=0&&v.render(he,!0,!0)},P1=function(t,e,i,r,n,o,a,h){var l=(t._pt&&t._ptCache||(t._ptCache={}))[e],u,c,d,f;if(!l)for(l=t._ptCache[e]=[],d=t._ptLookup,f=t._targets.length;f--;){if(u=d[f][e],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==e&&u.fp!==e;)u=u._next;if(!u)return gh=1,t.vars[e]="+=0",Qh(t,a),gh=0,h?As(e+" not eligible for reset"):1;l.push(u)}for(f=l.length;f--;)c=l[f],u=c._pt||c,u.s=(r||r===0)&&!n?r:u.s+(r||0)+o*u.c,u.c=i-u.s,c.e&&(c.e=vt(i)+Gt(c.e)),c.b&&(c.b=u.s+Gt(c.b))},R1=function(t,e){var i=t[0]?Wi(t[0]).harness:0,r=i&&i.aliases,n,o,a,h;if(!r)return e;n=Qi({},e);for(o in r)if(o in n)for(h=r[o].split(","),a=h.length;a--;)n[h[a]]=n[o];return n},I1=function(t,e,i,r){var n=e.ease||r||"power1.inOut",o,a;if(Ht(e))a=i[t]||(i[t]=[]),e.forEach(function(h,l){return a.push({t:l/(e.length-1)*100,v:h,e:n})});else for(o in e)a=i[o]||(i[o]=[]),o==="ease"||a.push({t:parseFloat(t),v:e[o],e:n})},ms=function(t,e,i,r,n){return yt(t)?t.call(e,i,r,n):Ot(t)&&~t.indexOf("random(")?Ss(t):t},Xf=qh+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Vf={};jt(Xf+",id,stagger,delay,duration,paused,scrollTrigger",function(s){return Vf[s]=1});var wt=function(s){lf(t,s);function t(i,r,n,o){var a;typeof r=="number"&&(n.duration=r,r=n,n=null),a=s.call(this,o?r:fs(r))||this;var h=a.vars,l=h.duration,u=h.delay,c=h.immediateRender,d=h.stagger,f=h.overwrite,m=h.keyframes,p=h.defaults,g=h.scrollTrigger,y=h.yoyoEase,x=r.parent||ft,_=(Ht(i)||cf(i)?ti(i[0]):"length"in r)?[i]:le(i),v,b,S,w,T,E,I,z;if(a._targets=_.length?Kh(_):As("GSAP target "+i+" not found. https://gsap.com",!ie.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,m||d||ln(l)||ln(u)){if(r=a.vars,v=a.timeline=new Xt({data:"nested",defaults:p||{},targets:x&&x.data==="nested"?x.vars.targets:_}),v.kill(),v.parent=v._dp=Ve(a),v._start=0,d||ln(l)||ln(u)){if(w=_.length,I=d&&Rf(d),ze(d))for(T in d)~Xf.indexOf(T)&&(z||(z={}),z[T]=d[T]);for(b=0;b<w;b++)S=jn(r,Vf),S.stagger=0,y&&(S.yoyoEase=y),z&&Qi(S,z),E=_[b],S.duration=+ms(l,Ve(a),b,E,_),S.delay=(+ms(u,Ve(a),b,E,_)||0)-a._delay,!d&&w===1&&S.delay&&(a._delay=u=S.delay,a._start+=u,S.delay=0),v.to(E,S,I?I(b,E,_):0),v._ease=tt.none;v.duration()?l=u=0:a.timeline=0}else if(m){fs(ue(v.vars.defaults,{ease:"none"})),v._ease=Yi(m.ease||r.ease||"none");var R=0,A,P,O;if(Ht(m))m.forEach(function(G){return v.to(_,G,">")}),v.duration();else{S={};for(T in m)T==="ease"||T==="easeEach"||I1(T,m[T],S,m.easeEach);for(T in S)for(A=S[T].sort(function(G,L){return G.t-L.t}),R=0,b=0;b<A.length;b++)P=A[b],O={ease:P.e,duration:(P.t-(b?A[b-1].t:0))/100*l},O[T]=P.v,v.to(_,O,R),R+=O.duration;v.duration()<l&&v.to({},{duration:l-v.duration()})}}l||a.duration(l=v.duration())}else a.timeline=0;return f===!0&&!$h&&(di=Ve(a),ft.killTweensOf(_),di=0),De(x,Ve(a),n),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(c||!l&&!m&&a._start===Mt(x._time)&&Wt(c)&&a1(Ve(a))&&x.data!=="nested")&&(a._tTime=-at,a.render(Math.max(0,-u)||0)),g&&Ef(Ve(a),g),a}var e=t.prototype;return e.render=function(r,n,o){var a=this._time,h=this._tDur,l=this._dur,u=r<0,c=r>h-at&&!u?h:r<at?0:r,d,f,m,p,g,y,x,_,v;if(!l)l1(this,r,n,o);else if(c!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(d=c,_=this.timeline,this._repeat){if(p=l+this._rDelay,this._repeat<-1&&u)return this.totalTime(p*100+r,n,o);if(d=Mt(c%p),c===h?(m=this._repeat,d=l):(m=~~(c/p),m&&m===Mt(c/p)&&(d=l,m--),d>l&&(d=l)),y=this._yoyo&&m&1,y&&(v=this._yEase,d=l-d),g=Nr(this._tTime,p),d===a&&!o&&this._initted&&m===g)return this._tTime=c,this;m!==g&&(_&&this._yEase&&Gf(_,y),this.vars.repeatRefresh&&!y&&!this._lock&&this._time!==p&&this._initted&&(this._lock=o=1,this.render(Mt(p*m),!0).invalidate()._lock=0))}if(!this._initted){if(Sf(this,u?r:d,o,n,c))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&m!==g))return this;if(l!==this._dur)return this.render(r,n,o)}if(this._tTime=c,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=x=(v||this._ease)(d/l),this._from&&(this.ratio=x=1-x),d&&!a&&!n&&!m&&(ee(this,"onStart"),this._tTime!==c))return this;for(f=this._pt;f;)f.r(x,f.d),f=f._next;_&&_.render(r<0?r:_._dur*_._ease(d/this._dur),n,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!n&&(u&&ch(this,r,n,o),ee(this,"onUpdate")),this._repeat&&m!==g&&this.vars.onRepeat&&!n&&this.parent&&ee(this,"onRepeat"),(c===this._tDur||!c)&&this._tTime===c&&(u&&!this._onUpdate&&ch(this,r,!0,!0),(r||!l)&&(c===this._tDur&&this._ts>0||!c&&this._ts<0)&&xi(this,1),!n&&!(u&&!a)&&(c||a||y)&&(ee(this,c===h?"onComplete":"onReverseComplete",!0),this._prom&&!(c<h&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),s.prototype.invalidate.call(this,r)},e.resetTo=function(r,n,o,a,h){Cs||te.wake(),this._ts||this.play();var l=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||Qh(this,l),u=this._ease(l/this._dur),P1(this,r,n,o,a,u,l,h)?this.resetTo(r,n,o,a,1):(fo(this,0),this.parent||wf(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(r,n){if(n===void 0&&(n="all"),!r&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?os(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,n,di&&di.vars.overwrite!==!0)._first||os(this),this.parent&&o!==this.timeline.totalDuration()&&Ur(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,h=r?le(r):a,l=this._ptLookup,u=this._pt,c,d,f,m,p,g,y;if((!n||n==="all")&&n1(a,h))return n==="all"&&(this._pt=0),os(this);for(c=this._op=this._op||[],n!=="all"&&(Ot(n)&&(p={},jt(n,function(x){return p[x]=1}),n=p),n=R1(a,n)),y=a.length;y--;)if(~h.indexOf(a[y])){d=l[y],n==="all"?(c[y]=n,m=d,f={}):(f=c[y]=c[y]||{},m=n);for(p in m)g=d&&d[p],g&&((!("kill"in g.d)||g.d.kill(p)===!0)&&uo(this,g,"_pt"),delete d[p]),f!=="all"&&(f[p]=1)}return this._initted&&!this._pt&&u&&os(this),this},t.to=function(r,n){return new t(r,n,arguments[2])},t.from=function(r,n){return ps(1,arguments)},t.delayedCall=function(r,n,o,a){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:n,onReverseComplete:n,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},t.fromTo=function(r,n,o){return ps(2,arguments)},t.set=function(r,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(r,n)},t.killTweensOf=function(r,n,o){return ft.killTweensOf(r,n,o)},t}(Ps);ue(wt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});jt("staggerTo,staggerFrom,staggerFromTo",function(s){wt[s]=function(){var t=new Xt,e=fh.call(arguments,0);return e.splice(s==="staggerFromTo"?5:4,0,0),t[s].apply(t,e)}});var Jh=function(t,e,i){return t[e]=i},Wf=function(t,e,i){return t[e](i)},M1=function(t,e,i,r){return t[e](r.fp,i)},D1=function(t,e,i){return t.setAttribute(e,i)},tl=function(t,e){return yt(t[e])?Wf:Xh(t[e])&&t.setAttribute?D1:Jh},jf=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},F1=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Yf=function(t,e){var i=e._pt,r="";if(!t&&e.b)r=e.b;else if(t===1&&e.e)r=e.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*t):Math.round((i.s+i.c*t)*1e4)/1e4)+r,i=i._next;r+=e.c}e.set(e.t,e.p,r,e)},el=function(t,e){for(var i=e._pt;i;)i.r(t,i.d),i=i._next},O1=function(t,e,i,r){for(var n=this._pt,o;n;)o=n._next,n.p===r&&n.modifier(t,e,i),n=o},B1=function(t){for(var e=this._pt,i,r;e;)r=e._next,e.p===t&&!e.op||e.op===t?uo(this,e,"_pt"):e.dep||(i=1),e=r;return!i},L1=function(t,e,i,r){r.mSet(t,e,r.m.call(r.tween,i,r.mt),r)},qf=function(t){for(var e=t._pt,i,r,n,o;e;){for(i=e._next,r=n;r&&r.pr>e.pr;)r=r._next;(e._prev=r?r._prev:o)?e._prev._next=e:n=e,(e._next=r)?r._prev=e:o=e,e=i}t._pt=n},Yt=function(){function s(e,i,r,n,o,a,h,l,u){this.t=i,this.s=n,this.c=o,this.p=r,this.r=a||jf,this.d=h||this,this.set=l||Jh,this.pr=u||0,this._next=e,e&&(e._prev=this)}var t=s.prototype;return t.modifier=function(i,r,n){this.mSet=this.mSet||this.set,this.set=L1,this.m=i,this.mt=n,this.tween=r},s}();jt(qh+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(s){return Yh[s]=1});re.TweenMax=re.TweenLite=wt;re.TimelineLite=re.TimelineMax=Xt;ft=new Xt({sortChildren:!1,defaults:kr,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});ie.stringFilter=Nf;var qi=[],wn={},k1=[],qu=0,N1=0,na=function(t){return(wn[t]||k1).map(function(e){return e()})},_h=function(){var t=Date.now(),e=[];t-qu>2&&(na("matchMediaInit"),qi.forEach(function(i){var r=i.queries,n=i.conditions,o,a,h,l;for(a in r)o=Re.matchMedia(r[a]).matches,o&&(h=1),o!==n[a]&&(n[a]=o,l=1);l&&(i.revert(),h&&e.push(i))}),na("matchMediaRevert"),e.forEach(function(i){return i.onMatch(i,function(r){return i.add(null,r)})}),qu=t,na("matchMedia"))},Kf=function(){function s(e,i){this.selector=i&&ph(i),this.data=[],this._r=[],this.isReverted=!1,this.id=N1++,e&&this.add(e)}var t=s.prototype;return t.add=function(i,r,n){yt(i)&&(n=r,r=i,i=yt);var o=this,a=function(){var l=ct,u=o.selector,c;return l&&l!==o&&l.data.push(o),n&&(o.selector=ph(n)),ct=o,c=r.apply(o,arguments),yt(c)&&o._r.push(c),ct=l,o.selector=u,o.isReverted=!1,c};return o.last=a,i===yt?a(o,function(h){return o.add(null,h)}):i?o[i]=a:a},t.ignore=function(i){var r=ct;ct=null,i(this),ct=r},t.getTweens=function(){var i=[];return this.data.forEach(function(r){return r instanceof s?i.push.apply(i,r.getTweens()):r instanceof wt&&!(r.parent&&r.parent.data==="nested")&&i.push(r)}),i},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(i,r){var n=this;if(i?function(){for(var a=n.getTweens(),h=n.data.length,l;h--;)l=n.data[h],l.data==="isFlip"&&(l.revert(),l.getChildren(!0,!0,!1).forEach(function(u){return a.splice(a.indexOf(u),1)}));for(a.map(function(u){return{g:u._dur||u._delay||u._sat&&!u._sat.vars.immediateRender?u.globalTime(0):-1/0,t:u}}).sort(function(u,c){return c.g-u.g||-1/0}).forEach(function(u){return u.t.revert(i)}),h=n.data.length;h--;)l=n.data[h],l instanceof Xt?l.data!=="nested"&&(l.scrollTrigger&&l.scrollTrigger.revert(),l.kill()):!(l instanceof wt)&&l.revert&&l.revert(i);n._r.forEach(function(u){return u(i,n)}),n.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),r)for(var o=qi.length;o--;)qi[o].id===this.id&&qi.splice(o,1)},t.revert=function(i){this.kill(i||{})},s}(),U1=function(){function s(e){this.contexts=[],this.scope=e,ct&&ct.data.push(this)}var t=s.prototype;return t.add=function(i,r,n){ze(i)||(i={matches:i});var o=new Kf(0,n||this.scope),a=o.conditions={},h,l,u;ct&&!o.selector&&(o.selector=ct.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=i;for(l in i)l==="all"?u=1:(h=Re.matchMedia(i[l]),h&&(qi.indexOf(o)<0&&qi.push(o),(a[l]=h.matches)&&(u=1),h.addListener?h.addListener(_h):h.addEventListener("change",_h)));return u&&r(o,function(c){return o.add(null,c)}),this},t.revert=function(i){this.kill(i||{})},t.kill=function(i){this.contexts.forEach(function(r){return r.kill(i,!0)})},s}(),qn={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e.forEach(function(r){return Bf(r)})},timeline:function(t){return new Xt(t)},getTweensOf:function(t,e){return ft.getTweensOf(t,e)},getProperty:function(t,e,i,r){Ot(t)&&(t=le(t)[0]);var n=Wi(t||{}).get,o=i?Tf:bf;return i==="native"&&(i=""),t&&(e?o((Jt[e]&&Jt[e].get||n)(t,e,i,r)):function(a,h,l){return o((Jt[a]&&Jt[a].get||n)(t,a,h,l))})},quickSetter:function(t,e,i){if(t=le(t),t.length>1){var r=t.map(function(u){return Kt.quickSetter(u,e,i)}),n=r.length;return function(u){for(var c=n;c--;)r[c](u)}}t=t[0]||{};var o=Jt[e],a=Wi(t),h=a.harness&&(a.harness.aliases||{})[e]||e,l=o?function(u){var c=new o;br._pt=0,c.init(t,i?u+i:u,br,0,[t]),c.render(1,c),br._pt&&el(1,br)}:a.set(t,h);return o?l:function(u){return l(t,h,i?u+i:u,a,1)}},quickTo:function(t,e,i){var r,n=Kt.to(t,Qi((r={},r[e]="+=0.1",r.paused=!0,r),i||{})),o=function(h,l,u){return n.resetTo(e,h,l,u)};return o.tween=n,o},isTweening:function(t){return ft.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Yi(t.ease,kr.ease)),Xu(kr,t||{})},config:function(t){return Xu(ie,t||{})},registerEffect:function(t){var e=t.name,i=t.effect,r=t.plugins,n=t.defaults,o=t.extendTimeline;(r||"").split(",").forEach(function(a){return a&&!Jt[a]&&!re[a]&&As(e+" effect requires "+a+" plugin.")}),ea[e]=function(a,h,l){return i(le(a),ue(h||{},n),l)},o&&(Xt.prototype[e]=function(a,h,l){return this.add(ea[e](a,ze(h)?h:(l=h)&&{},this),l)})},registerEase:function(t,e){tt[t]=Yi(e)},parseEase:function(t,e){return arguments.length?Yi(t,e):tt},getById:function(t){return ft.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var i=new Xt(t),r,n;for(i.smoothChildTiming=Wt(t.smoothChildTiming),ft.remove(i),i._dp=0,i._time=i._tTime=ft._time,r=ft._first;r;)n=r._next,(e||!(!r._dur&&r instanceof wt&&r.vars.onComplete===r._targets[0]))&&De(i,r,r._start-r._delay),r=n;return De(ft,i,0),i},context:function(t,e){return t?new Kf(t,e):ct},matchMedia:function(t){return new U1(t)},matchMediaRefresh:function(){return qi.forEach(function(t){var e=t.conditions,i,r;for(r in e)e[r]&&(e[r]=!1,i=1);i&&t.revert()})||_h()},addEventListener:function(t,e){var i=wn[t]||(wn[t]=[]);~i.indexOf(e)||i.push(e)},removeEventListener:function(t,e){var i=wn[t],r=i&&i.indexOf(e);r>=0&&i.splice(r,1)},utils:{wrap:_1,wrapYoyo:y1,distribute:Rf,random:Mf,snap:If,normalize:g1,getUnit:Gt,clamp:d1,splitColor:Lf,toArray:le,selector:ph,mapRange:Ff,pipe:p1,unitize:m1,interpolate:v1,shuffle:Pf},install:gf,effects:ea,ticker:te,updateRoot:Xt.updateRoot,plugins:Jt,globalTimeline:ft,core:{PropTween:Yt,globals:_f,Tween:wt,Timeline:Xt,Animation:Ps,getCache:Wi,_removeLinkedListItem:uo,reverting:function(){return zt},context:function(t){return t&&ct&&(ct.data.push(t),t._ctx=ct),ct},suppressOverwrites:function(t){return $h=t}}};jt("to,from,fromTo,delayedCall,set,killTweensOf",function(s){return qn[s]=wt[s]});te.add(Xt.updateRoot);br=qn.to({},{duration:0});var G1=function(t,e){for(var i=t._pt;i&&i.p!==e&&i.op!==e&&i.fp!==e;)i=i._next;return i},z1=function(t,e){var i=t._targets,r,n,o;for(r in e)for(n=i.length;n--;)o=t._ptLookup[n][r],o&&(o=o.d)&&(o._pt&&(o=G1(o,r)),o&&o.modifier&&o.modifier(e[r],t,i[n],r))},oa=function(t,e){return{name:t,rawVars:1,init:function(r,n,o){o._onInit=function(a){var h,l;if(Ot(n)&&(h={},jt(n,function(u){return h[u]=1}),n=h),e){h={};for(l in n)h[l]=e(n[l]);n=h}z1(a,n)}}}},Kt=qn.registerPlugin({name:"attr",init:function(t,e,i,r,n){var o,a,h;this.tween=i;for(o in e)h=t.getAttribute(o)||"",a=this.add(t,"setAttribute",(h||0)+"",e[o],r,n,0,0,o),a.op=o,a.b=h,this._props.push(o)},render:function(t,e){for(var i=e._pt;i;)zt?i.set(i.t,i.p,i.b,i):i.r(t,i.d),i=i._next}},{name:"endArray",init:function(t,e){for(var i=e.length;i--;)this.add(t,i,t[i]||0,e[i],0,0,0,0,0,1)}},oa("roundProps",mh),oa("modifiers"),oa("snap",If))||qn;wt.version=Xt.version=Kt.version="3.12.5";mf=1;Vh()&&Gr();tt.Power0;tt.Power1;tt.Power2;tt.Power3;tt.Power4;tt.Linear;tt.Quad;tt.Cubic;tt.Quart;tt.Quint;tt.Strong;tt.Elastic;tt.Back;tt.SteppedEase;tt.Bounce;tt.Sine;tt.Expo;tt.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Ku,fi,Mr,il,zi,Zu,rl,H1=function(){return typeof window<"u"},ei={},Li=180/Math.PI,Dr=Math.PI/180,hr=Math.atan2,Qu=1e8,sl=/([A-Z])/g,$1=/(left|right|width|margin|padding|x)/i,X1=/[\s,\(]\S/,Oe={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},yh=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},V1=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},W1=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},j1=function(t,e){var i=e.s+e.c*t;e.set(e.t,e.p,~~(i+(i<0?-.5:.5))+e.u,e)},Zf=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},Qf=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},Y1=function(t,e,i){return t.style[e]=i},q1=function(t,e,i){return t.style.setProperty(e,i)},K1=function(t,e,i){return t._gsap[e]=i},Z1=function(t,e,i){return t._gsap.scaleX=t._gsap.scaleY=i},Q1=function(t,e,i,r,n){var o=t._gsap;o.scaleX=o.scaleY=i,o.renderTransform(n,o)},J1=function(t,e,i,r,n){var o=t._gsap;o[e]=i,o.renderTransform(n,o)},mt="transform",qt=mt+"Origin",tb=function s(t,e){var i=this,r=this.target,n=r.style,o=r._gsap;if(t in ei&&n){if(this.tfm=this.tfm||{},t!=="transform")t=Oe[t]||t,~t.indexOf(",")?t.split(",").forEach(function(a){return i.tfm[a]=We(r,a)}):this.tfm[t]=o.x?o[t]:We(r,t),t===qt&&(this.tfm.zOrigin=o.zOrigin);else return Oe.transform.split(",").forEach(function(a){return s.call(i,a,e)});if(this.props.indexOf(mt)>=0)return;o.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(qt,e,"")),t=mt}(n||e)&&this.props.push(t,e,n[t])},Jf=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},eb=function(){var t=this.props,e=this.target,i=e.style,r=e._gsap,n,o;for(n=0;n<t.length;n+=3)t[n+1]?e[t[n]]=t[n+2]:t[n+2]?i[t[n]]=t[n+2]:i.removeProperty(t[n].substr(0,2)==="--"?t[n]:t[n].replace(sl,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),n=rl(),(!n||!n.isStart)&&!i[mt]&&(Jf(i),r.zOrigin&&i[qt]&&(i[qt]+=" "+r.zOrigin+"px",r.zOrigin=0,r.renderTransform()),r.uncache=1)}},tp=function(t,e){var i={target:t,props:[],revert:eb,save:tb};return t._gsap||Kt.core.getCache(t),e&&e.split(",").forEach(function(r){return i.save(r)}),i},ep,vh=function(t,e){var i=fi.createElementNS?fi.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):fi.createElement(t);return i&&i.style?i:fi.createElement(t)},Ne=function s(t,e,i){var r=getComputedStyle(t);return r[e]||r.getPropertyValue(e.replace(sl,"-$1").toLowerCase())||r.getPropertyValue(e)||!i&&s(t,zr(e)||e,1)||""},Ju="O,Moz,ms,Ms,Webkit".split(","),zr=function(t,e,i){var r=e||zi,n=r.style,o=5;if(t in n&&!i)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);o--&&!(Ju[o]+t in n););return o<0?null:(o===3?"ms":o>=0?Ju[o]:"")+t},xh=function(){H1()&&window.document&&(Ku=window,fi=Ku.document,Mr=fi.documentElement,zi=vh("div")||{style:{}},vh("div"),mt=zr(mt),qt=mt+"Origin",zi.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",ep=!!zr("perspective"),rl=Kt.core.reverting,il=1)},aa=function s(t){var e=vh("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,r=this.nextSibling,n=this.style.cssText,o;if(Mr.appendChild(e),e.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=s}catch{}else this._gsapBBox&&(o=this._gsapBBox());return i&&(r?i.insertBefore(this,r):i.appendChild(this)),Mr.removeChild(e),this.style.cssText=n,o},tc=function(t,e){for(var i=e.length;i--;)if(t.hasAttribute(e[i]))return t.getAttribute(e[i])},ip=function(t){var e;try{e=t.getBBox()}catch{e=aa.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===aa||(e=aa.call(t,!0)),e&&!e.width&&!e.x&&!e.y?{x:+tc(t,["x","cx","x1"])||0,y:+tc(t,["y","cy","y1"])||0,width:0,height:0}:e},rp=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&ip(t))},Ji=function(t,e){if(e){var i=t.style,r;e in ei&&e!==qt&&(e=mt),i.removeProperty?(r=e.substr(0,2),(r==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),i.removeProperty(r==="--"?e:e.replace(sl,"-$1").toLowerCase())):i.removeAttribute(e)}},pi=function(t,e,i,r,n,o){var a=new Yt(t._pt,e,i,0,1,o?Qf:Zf);return t._pt=a,a.b=r,a.e=n,t._props.push(i),a},ec={deg:1,rad:1,turn:1},ib={grid:1,flex:1},bi=function s(t,e,i,r){var n=parseFloat(i)||0,o=(i+"").trim().substr((n+"").length)||"px",a=zi.style,h=$1.test(e),l=t.tagName.toLowerCase()==="svg",u=(l?"client":"offset")+(h?"Width":"Height"),c=100,d=r==="px",f=r==="%",m,p,g,y;if(r===o||!n||ec[r]||ec[o])return n;if(o!=="px"&&!d&&(n=s(t,e,i,"px")),y=t.getCTM&&rp(t),(f||o==="%")&&(ei[e]||~e.indexOf("adius")))return m=y?t.getBBox()[h?"width":"height"]:t[u],vt(f?n/m*c:n/100*m);if(a[h?"width":"height"]=c+(d?o:r),p=~e.indexOf("adius")||r==="em"&&t.appendChild&&!l?t:t.parentNode,y&&(p=(t.ownerSVGElement||{}).parentNode),(!p||p===fi||!p.appendChild)&&(p=fi.body),g=p._gsap,g&&f&&g.width&&h&&g.time===te.time&&!g.uncache)return vt(n/g.width*c);if(f&&(e==="height"||e==="width")){var x=t.style[e];t.style[e]=c+r,m=t[u],x?t.style[e]=x:Ji(t,e)}else(f||o==="%")&&!ib[Ne(p,"display")]&&(a.position=Ne(t,"position")),p===t&&(a.position="static"),p.appendChild(zi),m=zi[u],p.removeChild(zi),a.position="absolute";return h&&f&&(g=Wi(p),g.time=te.time,g.width=p[u]),vt(d?m*n/c:m&&n?c/m*n:0)},We=function(t,e,i,r){var n;return il||xh(),e in Oe&&e!=="transform"&&(e=Oe[e],~e.indexOf(",")&&(e=e.split(",")[0])),ei[e]&&e!=="transform"?(n=Is(t,r),n=e!=="transformOrigin"?n[e]:n.svg?n.origin:Zn(Ne(t,qt))+" "+n.zOrigin+"px"):(n=t.style[e],(!n||n==="auto"||r||~(n+"").indexOf("calc("))&&(n=Kn[e]&&Kn[e](t,e,i)||Ne(t,e)||vf(t,e)||(e==="opacity"?1:0))),i&&!~(n+"").trim().indexOf(" ")?bi(t,e,n,i)+i:n},rb=function(t,e,i,r){if(!i||i==="none"){var n=zr(e,t,1),o=n&&Ne(t,n,1);o&&o!==i?(e=n,i=o):e==="borderColor"&&(i=Ne(t,"borderTopColor"))}var a=new Yt(this._pt,t.style,e,0,1,Yf),h=0,l=0,u,c,d,f,m,p,g,y,x,_,v,b;if(a.b=i,a.e=r,i+="",r+="",r==="auto"&&(p=t.style[e],t.style[e]=r,r=Ne(t,e)||r,p?t.style[e]=p:Ji(t,e)),u=[i,r],Nf(u),i=u[0],r=u[1],d=i.match(xr)||[],b=r.match(xr)||[],b.length){for(;c=xr.exec(r);)g=c[0],x=r.substring(h,c.index),m?m=(m+1)%5:(x.substr(-5)==="rgba("||x.substr(-5)==="hsla(")&&(m=1),g!==(p=d[l++]||"")&&(f=parseFloat(p)||0,v=p.substr((f+"").length),g.charAt(1)==="="&&(g=Ir(f,g)+v),y=parseFloat(g),_=g.substr((y+"").length),h=xr.lastIndex-_.length,_||(_=_||ie.units[e]||v,h===r.length&&(r+=_,a.e+=_)),v!==_&&(f=bi(t,e,p,_)||0),a._pt={_next:a._pt,p:x||l===1?x:",",s:f,c:y-f,m:m&&m<4||e==="zIndex"?Math.round:0});a.c=h<r.length?r.substring(h,r.length):""}else a.r=e==="display"&&r==="none"?Qf:Zf;return ff.test(r)&&(a.e=0),this._pt=a,a},ic={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},sb=function(t){var e=t.split(" "),i=e[0],r=e[1]||"50%";return(i==="top"||i==="bottom"||r==="left"||r==="right")&&(t=i,i=r,r=t),e[0]=ic[i]||i,e[1]=ic[r]||r,e.join(" ")},nb=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var i=e.t,r=i.style,n=e.u,o=i._gsap,a,h,l;if(n==="all"||n===!0)r.cssText="",h=1;else for(n=n.split(","),l=n.length;--l>-1;)a=n[l],ei[a]&&(h=1,a=a==="transformOrigin"?qt:mt),Ji(i,a);h&&(Ji(i,mt),o&&(o.svg&&i.removeAttribute("transform"),Is(i,1),o.uncache=1,Jf(r)))}},Kn={clearProps:function(t,e,i,r,n){if(n.data!=="isFromStart"){var o=t._pt=new Yt(t._pt,e,i,0,0,nb);return o.u=r,o.pr=-10,o.tween=n,t._props.push(i),1}}},Rs=[1,0,0,1,0,0],sp={},np=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},rc=function(t){var e=Ne(t,mt);return np(e)?Rs:e.substr(7).match(df).map(vt)},nl=function(t,e){var i=t._gsap||Wi(t),r=t.style,n=rc(t),o,a,h,l;return i.svg&&t.getAttribute("transform")?(h=t.transform.baseVal.consolidate().matrix,n=[h.a,h.b,h.c,h.d,h.e,h.f],n.join(",")==="1,0,0,1,0,0"?Rs:n):(n===Rs&&!t.offsetParent&&t!==Mr&&!i.svg&&(h=r.display,r.display="block",o=t.parentNode,(!o||!t.offsetParent)&&(l=1,a=t.nextElementSibling,Mr.appendChild(t)),n=rc(t),h?r.display=h:Ji(t,"display"),l&&(a?o.insertBefore(t,a):o?o.appendChild(t):Mr.removeChild(t))),e&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},bh=function(t,e,i,r,n,o){var a=t._gsap,h=n||nl(t,!0),l=a.xOrigin||0,u=a.yOrigin||0,c=a.xOffset||0,d=a.yOffset||0,f=h[0],m=h[1],p=h[2],g=h[3],y=h[4],x=h[5],_=e.split(" "),v=parseFloat(_[0])||0,b=parseFloat(_[1])||0,S,w,T,E;i?h!==Rs&&(w=f*g-m*p)&&(T=v*(g/w)+b*(-p/w)+(p*x-g*y)/w,E=v*(-m/w)+b*(f/w)-(f*x-m*y)/w,v=T,b=E):(S=ip(t),v=S.x+(~_[0].indexOf("%")?v/100*S.width:v),b=S.y+(~(_[1]||_[0]).indexOf("%")?b/100*S.height:b)),r||r!==!1&&a.smooth?(y=v-l,x=b-u,a.xOffset=c+(y*f+x*p)-y,a.yOffset=d+(y*m+x*g)-x):a.xOffset=a.yOffset=0,a.xOrigin=v,a.yOrigin=b,a.smooth=!!r,a.origin=e,a.originIsAbsolute=!!i,t.style[qt]="0px 0px",o&&(pi(o,a,"xOrigin",l,v),pi(o,a,"yOrigin",u,b),pi(o,a,"xOffset",c,a.xOffset),pi(o,a,"yOffset",d,a.yOffset)),t.setAttribute("data-svg-origin",v+" "+b)},Is=function(t,e){var i=t._gsap||new Hf(t);if("x"in i&&!e&&!i.uncache)return i;var r=t.style,n=i.scaleX<0,o="px",a="deg",h=getComputedStyle(t),l=Ne(t,qt)||"0",u,c,d,f,m,p,g,y,x,_,v,b,S,w,T,E,I,z,R,A,P,O,G,L,X,rt,D,F,Y,it,Q,ot;return u=c=d=p=g=y=x=_=v=0,f=m=1,i.svg=!!(t.getCTM&&rp(t)),h.translate&&((h.translate!=="none"||h.scale!=="none"||h.rotate!=="none")&&(r[mt]=(h.translate!=="none"?"translate3d("+(h.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(h.rotate!=="none"?"rotate("+h.rotate+") ":"")+(h.scale!=="none"?"scale("+h.scale.split(" ").join(",")+") ":"")+(h[mt]!=="none"?h[mt]:"")),r.scale=r.rotate=r.translate="none"),w=nl(t,i.svg),i.svg&&(i.uncache?(X=t.getBBox(),l=i.xOrigin-X.x+"px "+(i.yOrigin-X.y)+"px",L=""):L=!e&&t.getAttribute("data-svg-origin"),bh(t,L||l,!!L||i.originIsAbsolute,i.smooth!==!1,w)),b=i.xOrigin||0,S=i.yOrigin||0,w!==Rs&&(z=w[0],R=w[1],A=w[2],P=w[3],u=O=w[4],c=G=w[5],w.length===6?(f=Math.sqrt(z*z+R*R),m=Math.sqrt(P*P+A*A),p=z||R?hr(R,z)*Li:0,x=A||P?hr(A,P)*Li+p:0,x&&(m*=Math.abs(Math.cos(x*Dr))),i.svg&&(u-=b-(b*z+S*A),c-=S-(b*R+S*P))):(ot=w[6],it=w[7],D=w[8],F=w[9],Y=w[10],Q=w[11],u=w[12],c=w[13],d=w[14],T=hr(ot,Y),g=T*Li,T&&(E=Math.cos(-T),I=Math.sin(-T),L=O*E+D*I,X=G*E+F*I,rt=ot*E+Y*I,D=O*-I+D*E,F=G*-I+F*E,Y=ot*-I+Y*E,Q=it*-I+Q*E,O=L,G=X,ot=rt),T=hr(-A,Y),y=T*Li,T&&(E=Math.cos(-T),I=Math.sin(-T),L=z*E-D*I,X=R*E-F*I,rt=A*E-Y*I,Q=P*I+Q*E,z=L,R=X,A=rt),T=hr(R,z),p=T*Li,T&&(E=Math.cos(T),I=Math.sin(T),L=z*E+R*I,X=O*E+G*I,R=R*E-z*I,G=G*E-O*I,z=L,O=X),g&&Math.abs(g)+Math.abs(p)>359.9&&(g=p=0,y=180-y),f=vt(Math.sqrt(z*z+R*R+A*A)),m=vt(Math.sqrt(G*G+ot*ot)),T=hr(O,G),x=Math.abs(T)>2e-4?T*Li:0,v=Q?1/(Q<0?-Q:Q):0),i.svg&&(L=t.getAttribute("transform"),i.forceCSS=t.setAttribute("transform","")||!np(Ne(t,mt)),L&&t.setAttribute("transform",L))),Math.abs(x)>90&&Math.abs(x)<270&&(n?(f*=-1,x+=p<=0?180:-180,p+=p<=0?180:-180):(m*=-1,x+=x<=0?180:-180)),e=e||i.uncache,i.x=u-((i.xPercent=u&&(!e&&i.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-u)?-50:0)))?t.offsetWidth*i.xPercent/100:0)+o,i.y=c-((i.yPercent=c&&(!e&&i.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-c)?-50:0)))?t.offsetHeight*i.yPercent/100:0)+o,i.z=d+o,i.scaleX=vt(f),i.scaleY=vt(m),i.rotation=vt(p)+a,i.rotationX=vt(g)+a,i.rotationY=vt(y)+a,i.skewX=x+a,i.skewY=_+a,i.transformPerspective=v+o,(i.zOrigin=parseFloat(l.split(" ")[2])||!e&&i.zOrigin||0)&&(r[qt]=Zn(l)),i.xOffset=i.yOffset=0,i.force3D=ie.force3D,i.renderTransform=i.svg?ab:ep?op:ob,i.uncache=0,i},Zn=function(t){return(t=t.split(" "))[0]+" "+t[1]},ha=function(t,e,i){var r=Gt(e);return vt(parseFloat(e)+parseFloat(bi(t,"x",i+"px",r)))+r},ob=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,op(t,e)},Pi="0deg",Zr="0px",Ri=") ",op=function(t,e){var i=e||this,r=i.xPercent,n=i.yPercent,o=i.x,a=i.y,h=i.z,l=i.rotation,u=i.rotationY,c=i.rotationX,d=i.skewX,f=i.skewY,m=i.scaleX,p=i.scaleY,g=i.transformPerspective,y=i.force3D,x=i.target,_=i.zOrigin,v="",b=y==="auto"&&t&&t!==1||y===!0;if(_&&(c!==Pi||u!==Pi)){var S=parseFloat(u)*Dr,w=Math.sin(S),T=Math.cos(S),E;S=parseFloat(c)*Dr,E=Math.cos(S),o=ha(x,o,w*E*-_),a=ha(x,a,-Math.sin(S)*-_),h=ha(x,h,T*E*-_+_)}g!==Zr&&(v+="perspective("+g+Ri),(r||n)&&(v+="translate("+r+"%, "+n+"%) "),(b||o!==Zr||a!==Zr||h!==Zr)&&(v+=h!==Zr||b?"translate3d("+o+", "+a+", "+h+") ":"translate("+o+", "+a+Ri),l!==Pi&&(v+="rotate("+l+Ri),u!==Pi&&(v+="rotateY("+u+Ri),c!==Pi&&(v+="rotateX("+c+Ri),(d!==Pi||f!==Pi)&&(v+="skew("+d+", "+f+Ri),(m!==1||p!==1)&&(v+="scale("+m+", "+p+Ri),x.style[mt]=v||"translate(0, 0)"},ab=function(t,e){var i=e||this,r=i.xPercent,n=i.yPercent,o=i.x,a=i.y,h=i.rotation,l=i.skewX,u=i.skewY,c=i.scaleX,d=i.scaleY,f=i.target,m=i.xOrigin,p=i.yOrigin,g=i.xOffset,y=i.yOffset,x=i.forceCSS,_=parseFloat(o),v=parseFloat(a),b,S,w,T,E;h=parseFloat(h),l=parseFloat(l),u=parseFloat(u),u&&(u=parseFloat(u),l+=u,h+=u),h||l?(h*=Dr,l*=Dr,b=Math.cos(h)*c,S=Math.sin(h)*c,w=Math.sin(h-l)*-d,T=Math.cos(h-l)*d,l&&(u*=Dr,E=Math.tan(l-u),E=Math.sqrt(1+E*E),w*=E,T*=E,u&&(E=Math.tan(u),E=Math.sqrt(1+E*E),b*=E,S*=E)),b=vt(b),S=vt(S),w=vt(w),T=vt(T)):(b=c,T=d,S=w=0),(_&&!~(o+"").indexOf("px")||v&&!~(a+"").indexOf("px"))&&(_=bi(f,"x",o,"px"),v=bi(f,"y",a,"px")),(m||p||g||y)&&(_=vt(_+m-(m*b+p*w)+g),v=vt(v+p-(m*S+p*T)+y)),(r||n)&&(E=f.getBBox(),_=vt(_+r/100*E.width),v=vt(v+n/100*E.height)),E="matrix("+b+","+S+","+w+","+T+","+_+","+v+")",f.setAttribute("transform",E),x&&(f.style[mt]=E)},hb=function(t,e,i,r,n){var o=360,a=Ot(n),h=parseFloat(n)*(a&&~n.indexOf("rad")?Li:1),l=h-r,u=r+l+"deg",c,d;return a&&(c=n.split("_")[1],c==="short"&&(l%=o,l!==l%(o/2)&&(l+=l<0?o:-o)),c==="cw"&&l<0?l=(l+o*Qu)%o-~~(l/o)*o:c==="ccw"&&l>0&&(l=(l-o*Qu)%o-~~(l/o)*o)),t._pt=d=new Yt(t._pt,e,i,r,l,V1),d.e=u,d.u="deg",t._props.push(i),d},sc=function(t,e){for(var i in e)t[i]=e[i];return t},lb=function(t,e,i){var r=sc({},i._gsap),n="perspective,force3D,transformOrigin,svgOrigin",o=i.style,a,h,l,u,c,d,f,m;r.svg?(l=i.getAttribute("transform"),i.setAttribute("transform",""),o[mt]=e,a=Is(i,1),Ji(i,mt),i.setAttribute("transform",l)):(l=getComputedStyle(i)[mt],o[mt]=e,a=Is(i,1),o[mt]=l);for(h in ei)l=r[h],u=a[h],l!==u&&n.indexOf(h)<0&&(f=Gt(l),m=Gt(u),c=f!==m?bi(i,h,l,m):parseFloat(l),d=parseFloat(u),t._pt=new Yt(t._pt,a,h,c,d-c,yh),t._pt.u=m||0,t._props.push(h));sc(a,r)};jt("padding,margin,Width,Radius",function(s,t){var e="Top",i="Right",r="Bottom",n="Left",o=(t<3?[e,i,r,n]:[e+n,e+i,r+i,r+n]).map(function(a){return t<2?s+a:"border"+a+s});Kn[t>1?"border"+s:s]=function(a,h,l,u,c){var d,f;if(arguments.length<4)return d=o.map(function(m){return We(a,m,l)}),f=d.join(" "),f.split(d[0]).length===5?d[0]:f;d=(u+"").split(" "),f={},o.forEach(function(m,p){return f[m]=d[p]=d[p]||d[(p-1)/2|0]}),a.init(h,f,c)}});var ap={name:"css",register:xh,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,i,r,n){var o=this._props,a=t.style,h=i.vars.startAt,l,u,c,d,f,m,p,g,y,x,_,v,b,S,w,T;il||xh(),this.styles=this.styles||tp(t),T=this.styles.props,this.tween=i;for(p in e)if(p!=="autoRound"&&(u=e[p],!(Jt[p]&&$f(p,e,i,r,t,n)))){if(f=typeof u,m=Kn[p],f==="function"&&(u=u.call(i,r,t,n),f=typeof u),f==="string"&&~u.indexOf("random(")&&(u=Ss(u)),m)m(this,t,p,u,i)&&(w=1);else if(p.substr(0,2)==="--")l=(getComputedStyle(t).getPropertyValue(p)+"").trim(),u+="",_i.lastIndex=0,_i.test(l)||(g=Gt(l),y=Gt(u)),y?g!==y&&(l=bi(t,p,l,y)+y):g&&(u+=g),this.add(a,"setProperty",l,u,r,n,0,0,p),o.push(p),T.push(p,0,a[p]);else if(f!=="undefined"){if(h&&p in h?(l=typeof h[p]=="function"?h[p].call(i,r,t,n):h[p],Ot(l)&&~l.indexOf("random(")&&(l=Ss(l)),Gt(l+"")||l==="auto"||(l+=ie.units[p]||Gt(We(t,p))||""),(l+"").charAt(1)==="="&&(l=We(t,p))):l=We(t,p),d=parseFloat(l),x=f==="string"&&u.charAt(1)==="="&&u.substr(0,2),x&&(u=u.substr(2)),c=parseFloat(u),p in Oe&&(p==="autoAlpha"&&(d===1&&We(t,"visibility")==="hidden"&&c&&(d=0),T.push("visibility",0,a.visibility),pi(this,a,"visibility",d?"inherit":"hidden",c?"inherit":"hidden",!c)),p!=="scale"&&p!=="transform"&&(p=Oe[p],~p.indexOf(",")&&(p=p.split(",")[0]))),_=p in ei,_){if(this.styles.save(p),v||(b=t._gsap,b.renderTransform&&!e.parseTransform||Is(t,e.parseTransform),S=e.smoothOrigin!==!1&&b.smooth,v=this._pt=new Yt(this._pt,a,mt,0,1,b.renderTransform,b,0,-1),v.dep=1),p==="scale")this._pt=new Yt(this._pt,b,"scaleY",b.scaleY,(x?Ir(b.scaleY,x+c):c)-b.scaleY||0,yh),this._pt.u=0,o.push("scaleY",p),p+="X";else if(p==="transformOrigin"){T.push(qt,0,a[qt]),u=sb(u),b.svg?bh(t,u,0,S,0,this):(y=parseFloat(u.split(" ")[2])||0,y!==b.zOrigin&&pi(this,b,"zOrigin",b.zOrigin,y),pi(this,a,p,Zn(l),Zn(u)));continue}else if(p==="svgOrigin"){bh(t,u,1,S,0,this);continue}else if(p in sp){hb(this,b,p,d,x?Ir(d,x+u):u);continue}else if(p==="smoothOrigin"){pi(this,b,"smooth",b.smooth,u);continue}else if(p==="force3D"){b[p]=u;continue}else if(p==="transform"){lb(this,u,t);continue}}else p in a||(p=zr(p)||p);if(_||(c||c===0)&&(d||d===0)&&!X1.test(u)&&p in a)g=(l+"").substr((d+"").length),c||(c=0),y=Gt(u)||(p in ie.units?ie.units[p]:g),g!==y&&(d=bi(t,p,l,y)),this._pt=new Yt(this._pt,_?b:a,p,d,(x?Ir(d,x+c):c)-d,!_&&(y==="px"||p==="zIndex")&&e.autoRound!==!1?j1:yh),this._pt.u=y||0,g!==y&&y!=="%"&&(this._pt.b=l,this._pt.r=W1);else if(p in a)rb.call(this,t,p,l,x?x+u:u);else if(p in t)this.add(t,p,l||t[p],x?x+u:u,r,n);else if(p!=="parseTransform"){jh(p,u);continue}_||(p in a?T.push(p,0,a[p]):T.push(p,1,l||t[p])),o.push(p)}}w&&qf(this)},render:function(t,e){if(e.tween._time||!rl())for(var i=e._pt;i;)i.r(t,i.d),i=i._next;else e.styles.revert()},get:We,aliases:Oe,getSetter:function(t,e,i){var r=Oe[e];return r&&r.indexOf(",")<0&&(e=r),e in ei&&e!==qt&&(t._gsap.x||We(t,"x"))?i&&Zu===i?e==="scale"?Z1:K1:(Zu=i||{})&&(e==="scale"?Q1:J1):t.style&&!Xh(t.style[e])?Y1:~e.indexOf("-")?q1:tl(t,e)},core:{_removeProperty:Ji,_getMatrix:nl}};Kt.utils.checkPrefix=zr;Kt.core.getStyleSaver=tp;(function(s,t,e,i){var r=jt(s+","+t+","+e,function(n){ei[n]=1});jt(t,function(n){ie.units[n]="deg",sp[n]=1}),Oe[r[13]]=s+","+t,jt(i,function(n){var o=n.split(":");Oe[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");jt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(s){ie.units[s]="px"});Kt.registerPlugin(ap);var tr=Kt.registerPlugin(ap)||Kt;tr.core.Tween;var ub=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,cb=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform float gamma;
uniform float contrast;
uniform float saturation;
uniform float brightness;
uniform float red;
uniform float green;
uniform float blue;
uniform float alpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (c.a > 0.0) {
        c.rgb /= c.a;

        vec3 rgb = pow(c.rgb, vec3(1. / gamma));
        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);
        rgb.r *= red;
        rgb.g *= green;
        rgb.b *= blue;
        c.rgb = rgb * brightness;

        c.rgb *= c.a;
    }

    gl_FragColor = c * alpha;
}
`;let db=class extends et{constructor(t){super(ub,cb),this.gamma=1,this.saturation=1,this.contrast=1,this.brightness=1,this.red=1,this.green=1,this.blue=1,this.alpha=1,Object.assign(this,t)}apply(t,e,i,r){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,i,r)}};var fb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,pb=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,mb=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`;let nc=class extends et{constructor(t=4,e=3,i=!1){super(fb,i?mb:pb),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new K,this.pixelSize=1,this._clamp=i,Array.isArray(t)?this.kernels=t:(this._blur=t,this.quality=e)}apply(t,e,i,r){const n=this._pixelSize.x/e._frame.width,o=this._pixelSize.y/e._frame.height;let a;if(this._quality===1||this._blur===0)a=this._kernels[0]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,e,i,r);else{const h=t.getFilterTexture();let l=e,u=h,c;const d=this._quality-1;for(let f=0;f<d;f++)a=this._kernels[f]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,l,u,1),c=l,l=u,u=c;a=this._kernels[d]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,l,i,r),t.returnFilterTexture(h)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((t,e)=>t+e+.5,0))}_generateKernels(){const t=this._blur,e=this._quality,i=[t];if(t>0){let r=t;const n=t/e;for(let o=1;o<e;o++)r-=n,i.push(r)}this._kernels=i,this._updatePadding()}get kernels(){return this._kernels}set kernels(t){Array.isArray(t)&&t.length>0?(this._kernels=t,this._quality=t.length,this._blur=Math.max(...t)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(t){typeof t=="number"?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):t instanceof K?(this._pixelSize.x=t.x,this._pixelSize.y=t.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}get blur(){return this._blur}set blur(t){this._blur=t,this._generateKernels()}};var hp=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,gb=`
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform float threshold;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > threshold) {
        gl_FragColor = color;
    } else {
        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`;let _b=class extends et{constructor(t=.5){super(hp,gb),this.threshold=t}get threshold(){return this.uniforms.threshold}set threshold(t){this.uniforms.threshold=t}};var yb=`uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform sampler2D bloomTexture;
uniform float bloomScale;
uniform float brightness;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);
    color.rgb *= brightness;
    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= bloomScale;
    gl_FragColor = color + bloomColor;
}
`;const lp=class extends et{constructor(t){super(hp,yb),this.bloomScale=1,this.brightness=1,this._resolution=k.FILTER_RESOLUTION,typeof t=="number"&&(t={threshold:t});const e=Object.assign(lp.defaults,t);this.bloomScale=e.bloomScale,this.brightness=e.brightness;const{kernels:i,blur:r,quality:n,pixelSize:o,resolution:a}=e;this._extractFilter=new _b(e.threshold),this._extractFilter.resolution=a,this._blurFilter=i?new nc(i):new nc(r,n),this.pixelSize=o,this.resolution=a}apply(t,e,i,r,n){const o=t.getFilterTexture();this._extractFilter.apply(t,e,o,1,n);const a=t.getFilterTexture();this._blurFilter.apply(t,o,a,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=a,t.applyFilter(this,e,i,r),t.returnFilterTexture(a),t.returnFilterTexture(o)}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._extractFilter&&(this._extractFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get threshold(){return this._extractFilter.threshold}set threshold(t){this._extractFilter.threshold=t}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};let Th=lp;Th.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:k.FILTER_RESOLUTION};var vb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,xb=`uniform float radius;
uniform float strength;
uniform vec2 center;
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

void main()
{
    vec2 coord = vTextureCoord * filterArea.xy;
    coord -= center * dimensions.xy;
    float distance = length(coord);
    if (distance < radius) {
        float percent = distance / radius;
        if (strength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
        }
    }
    coord += center * dimensions.xy;
    coord /= filterArea.xy;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    gl_FragColor = color;
}
`;const up=class extends et{constructor(t){super(vb,xb),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,up.defaults,t)}apply(t,e,i,r){const{width:n,height:o}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,t.applyFilter(this,e,i,r)}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}get strength(){return this.uniforms.strength}set strength(t){this.uniforms.strength=t}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}};let cp=up;cp.defaults={center:[.5,.5],radius:100,strength:1};var bb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Tb=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec2 dimensions;

const float SQRT_2 = 1.414213;

const float light = 1.0;

uniform float curvature;
uniform float lineWidth;
uniform float lineContrast;
uniform bool verticalLine;
uniform float noise;
uniform float noiseSize;

uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;

uniform float seed;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));
    
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 rgb = gl_FragColor.rgb;

    if (noise > 0.0 && noiseSize > 0.0)
    {
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        rgb += _noise * noise;
    }

    if (lineWidth > 0.0)
    {
        float _c = curvature > 0. ? curvature : 1.;
        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
        vec2 uv = dir * k;

        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;
        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;
        rgb *= j;
        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);
        rgb *= 0.99 + ceil(segment) * 0.015;
    }

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    gl_FragColor.rgb = rgb;
}
`;const dp=class extends et{constructor(t){super(bb,Tb),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,dp.defaults,t)}apply(t,e,i,r){const{width:n,height:o}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,this.uniforms.seed=this.seed,this.uniforms.time=this.time,t.applyFilter(this,e,i,r)}set curvature(t){this.uniforms.curvature=t}get curvature(){return this.uniforms.curvature}set lineWidth(t){this.uniforms.lineWidth=t}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(t){this.uniforms.lineContrast=t}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(t){this.uniforms.verticalLine=t}get verticalLine(){return this.uniforms.verticalLine}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};let fp=dp;fp.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};var wb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Ab=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,Eb=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`;let oc=class extends et{constructor(t=4,e=3,i=!1){super(wb,i?Eb:Ab),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new K,this.pixelSize=1,this._clamp=i,Array.isArray(t)?this.kernels=t:(this._blur=t,this.quality=e)}apply(t,e,i,r){const n=this._pixelSize.x/e._frame.width,o=this._pixelSize.y/e._frame.height;let a;if(this._quality===1||this._blur===0)a=this._kernels[0]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,e,i,r);else{const h=t.getFilterTexture();let l=e,u=h,c;const d=this._quality-1;for(let f=0;f<d;f++)a=this._kernels[f]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,l,u,1),c=l,l=u,u=c;a=this._kernels[d]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,l,i,r),t.returnFilterTexture(h)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((t,e)=>t+e+.5,0))}_generateKernels(){const t=this._blur,e=this._quality,i=[t];if(t>0){let r=t;const n=t/e;for(let o=1;o<e;o++)r-=n,i.push(r)}this._kernels=i,this._updatePadding()}get kernels(){return this._kernels}set kernels(t){Array.isArray(t)&&t.length>0?(this._kernels=t,this._quality=t.length,this._blur=Math.max(...t)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(t){typeof t=="number"?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):t instanceof K?(this._pixelSize.x=t.x,this._pixelSize.y=t.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}get blur(){return this._blur}set blur(t){this._blur=t,this._generateKernels()}};var Sb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Cb=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float alpha;
uniform vec3 color;

uniform vec2 shift;
uniform vec4 inputSize;

void main(void){
    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);

    // Premultiply alpha
    sample.rgb = color.rgb * sample.a;

    // alpha user alpha
    sample *= alpha;

    gl_FragColor = sample;
}`,Pb=Object.defineProperty,ac=Object.getOwnPropertySymbols,Rb=Object.prototype.hasOwnProperty,Ib=Object.prototype.propertyIsEnumerable,hc=(s,t,e)=>t in s?Pb(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,lc=(s,t)=>{for(var e in t||(t={}))Rb.call(t,e)&&hc(s,e,t[e]);if(ac)for(var e of ac(t))Ib.call(t,e)&&hc(s,e,t[e]);return s};const wh=class extends et{constructor(t){super(),this.angle=45,this._distance=5,this._resolution=k.FILTER_RESOLUTION;const e=t?lc(lc({},wh.defaults),t):wh.defaults,{kernels:i,blur:r,quality:n,pixelSize:o,resolution:a}=e;this._tintFilter=new et(Sb,Cb),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=new K,this._tintFilter.resolution=a,this._blurFilter=i?new oc(i):new oc(r,n),this.pixelSize=o,this.resolution=a;const{shadowOnly:h,rotation:l,distance:u,alpha:c,color:d}=e;this.shadowOnly=h,this.rotation=l,this.distance=u,this.alpha=c,this.color=d,this._updatePadding()}apply(t,e,i,r){const n=t.getFilterTexture();this._tintFilter.apply(t,e,n,1),this._blurFilter.apply(t,n,i,r),this.shadowOnly!==!0&&t.applyFilter(this,e,i,0),t.returnFilterTexture(n)}_updatePadding(){this.padding=this.distance+this.blur*2}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._tintFilter&&(this._tintFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get distance(){return this._distance}set distance(t){this._distance=t,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/Ts}set rotation(t){this.angle=t*Ts,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(t){this._tintFilter.uniforms.alpha=t}get color(){return eo(this._tintFilter.uniforms.color)}set color(t){Bh(t,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};let Mb=wh;Mb.defaults={rotation:45,distance:5,color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:k.FILTER_RESOLUTION};var Db=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Fb=`// precision highp float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;
uniform float aspect;

uniform sampler2D displacementMap;
uniform float offset;
uniform float sinDir;
uniform float cosDir;
uniform int fillMode;

uniform float seed;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * aspect;
    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (offset / filterArea.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);

    if (fillMode == CLAMP) {
        coord = clamp(coord, filterClamp.xy, filterClamp.zw);
    } else {
        if( coord.x > filterClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = filterClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < filterClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -filterClamp.z;
            }
        }

        if( coord.y > filterClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = filterClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < filterClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -filterClamp.w;
            }
        }
    }

    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;
    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;
    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;
    gl_FragColor.a = texture2D(uSampler, coord).a;
}
`;const Ah=class extends et{constructor(t){super(Db,Fb),this.offset=100,this.fillMode=Ah.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=U.from(this._canvas,{scaleMode:ge.NEAREST}),Object.assign(this,Ah.defaults,t)}apply(t,e,i,r){const{width:n,height:o}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,this.uniforms.aspect=o/n,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,t.applyFilter(this,e,i,r)}_randomizeSizes(){const t=this._sizes,e=this._slices-1,i=this.sampleSize,r=Math.min(this.minSize/i,.9/this._slices);if(this.average){const n=this._slices;let o=1;for(let a=0;a<e;a++){const h=o/(n-a),l=Math.max(h*(1-Math.random()*.6),r);t[a]=l,o-=l}t[e]=o}else{let n=1;const o=Math.sqrt(1/this._slices);for(let a=0;a<e;a++){const h=Math.max(o*n*Math.random(),r);t[a]=h,n-=h}t[e]=n}this.shuffle()}shuffle(){const t=this._sizes,e=this._slices-1;for(let i=e;i>0;i--){const r=Math.random()*i>>0,n=t[i];t[i]=t[r],t[r]=n}}_randomizeOffsets(){for(let t=0;t<this._slices;t++)this._offsets[t]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const t=this.sampleSize,e=this.texture,i=this._canvas.getContext("2d");i.clearRect(0,0,8,t);let r,n=0;for(let o=0;o<this._slices;o++){r=Math.floor(this._offsets[o]*256);const a=this._sizes[o]*t,h=r>0?r:0,l=r<0?-r:0;i.fillStyle=`rgba(${h}, ${l}, 0, 1)`,i.fillRect(0,n>>0,t,a+1>>0),n+=a}e.baseTexture.update(),this.uniforms.displacementMap=e}set sizes(t){const e=Math.min(this._slices,t.length);for(let i=0;i<e;i++)this._sizes[i]=t[i]}get sizes(){return this._sizes}set offsets(t){const e=Math.min(this._slices,t.length);for(let i=0;i<e;i++)this._offsets[i]=t[i]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(t){this._slices!==t&&(this._slices=t,this.uniforms.slices=t,this._sizes=this.uniforms.slicesWidth=new Float32Array(t),this._offsets=this.uniforms.slicesOffset=new Float32Array(t),this.refresh())}get direction(){return this._direction}set direction(t){if(this._direction===t)return;this._direction=t;const e=t*Ts;this.uniforms.sinDir=Math.sin(e),this.uniforms.cosDir=Math.cos(e)}get red(){return this.uniforms.red}set red(t){this.uniforms.red=t}get green(){return this.uniforms.green}set green(t){this.uniforms.green=t}get blue(){return this.uniforms.blue}set blue(t){this.uniforms.blue=t}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};let lr=Ah;lr.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},lr.TRANSPARENT=0,lr.ORIGINAL=1,lr.LOOP=2,lr.CLAMP=3,lr.MIRROR=4;var Ob=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Bb=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

uniform float outerStrength;
uniform float innerStrength;

uniform vec4 glowColor;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform bool knockout;
uniform float alpha;

const float PI = 3.14159265358979323846264;

const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);
const float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);

const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;

void main(void) {
    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);

    float totalAlpha = 0.0;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {
       direction = vec2(cos(angle), sin(angle)) * px;

       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {
           displaced = clamp(vTextureCoord + direction * 
                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);

           curColor = texture2D(uSampler, displaced);

           totalAlpha += (DIST - curDistance) * curColor.a;
       }
    }
    
    curColor = texture2D(uSampler, vTextureCoord);

    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);

    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;
    float innerGlowStrength = min(1.0, innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);

    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);
    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);

    if (knockout) {
      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;
      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;
      gl_FragColor = innerColor + outerGlowColor;
    }
}
`;const pp=class extends et{constructor(s){const t=Object.assign({},pp.defaults,s),{outerStrength:e,innerStrength:i,color:r,knockout:n,quality:o,alpha:a}=t,h=Math.round(t.distance);super(Ob,Bb.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/o/h).toFixed(7)}`).replace(/__DIST__/gi,`${h.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:r,outerStrength:e,innerStrength:i,padding:h,knockout:n,alpha:a})}get color(){return eo(this.uniforms.glowColor)}set color(s){Bh(s,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(s){this.uniforms.outerStrength=s}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(s){this.uniforms.innerStrength=s}get knockout(){return this.uniforms.knockout}set knockout(s){this.uniforms.knockout=s}get alpha(){return this.uniforms.alpha}set alpha(s){this.uniforms.alpha=s}};let Lb=pp;Lb.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};var kb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Nb=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,Ub=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform vec2 light;
uniform bool parallel;
uniform float aspect;

uniform float gain;
uniform float lacunarity;
uniform float time;
uniform float alpha;

\${perlin}

void main(void) {
    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    float d;

    if (parallel) {
        float _cos = light.x;
        float _sin = light.y;
        d = (_cos * coord.x) + (_sin * coord.y * aspect);
    } else {
        float dx = coord.x - light.x / dimensions.x;
        float dy = (coord.y - light.y / dimensions.y) * aspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    vec3 dir = vec3(d, d, 0.0);

    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;

}
`;const mp=class extends et{constructor(t){super(kb,Ub.replace("${perlin}",Nb)),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);const e=Object.assign(mp.defaults,t);this._angleLight=new K,this.angle=e.angle,this.gain=e.gain,this.lacunarity=e.lacunarity,this.alpha=e.alpha,this.parallel=e.parallel,this.center=e.center,this.time=e.time}apply(t,e,i,r){const{width:n,height:o}=e.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,this.uniforms.aspect=o/n,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,i,r)}get angle(){return this._angle}set angle(t){this._angle=t;const e=t*Ts;this._angleLight.x=Math.cos(e),this._angleLight.y=Math.sin(e)}get gain(){return this.uniforms.gain}set gain(t){this.uniforms.gain=t}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(t){this.uniforms.lacunarity=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}};let Gb=mp;Gb.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};var zb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Hb=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform float sepia;
uniform float noise;
uniform float noiseSize;
uniform float scratch;
uniform float scratchDensity;
uniform float scratchWidth;
uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;
uniform float seed;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 color = gl_FragColor.rgb;

    if (sepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + sepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= dimensions.y / dimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    if (scratchDensity > seed && scratch != 0.0)
    {
        float phase = seed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));
        if (d < seed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / dimensions.x * (0.75 + seed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        color += _noise * noise;
    }

    gl_FragColor.rgb = color;
}
`;const gp=class extends et{constructor(t,e=0){super(zb,Hb),this.seed=0,this.uniforms.dimensions=new Float32Array(2),typeof t=="number"?(this.seed=t,t=void 0):this.seed=e,Object.assign(this,gp.defaults,t)}apply(t,e,i,r){var n,o;this.uniforms.dimensions[0]=(n=e.filterFrame)==null?void 0:n.width,this.uniforms.dimensions[1]=(o=e.filterFrame)==null?void 0:o.height,this.uniforms.seed=this.seed,t.applyFilter(this,e,i,r)}set sepia(t){this.uniforms.sepia=t}get sepia(){return this.uniforms.sepia}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set scratch(t){this.uniforms.scratch=t}get scratch(){return this.uniforms.scratch}set scratchDensity(t){this.uniforms.scratchDensity=t}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(t){this.uniforms.scratchWidth=t}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};let $b=gp;$b.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};var Xb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Vb=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform float alpha;
uniform vec2 thickness;
uniform vec4 outlineColor;
uniform vec4 filterClamp;

const float DOUBLE_PI = 3.14159265358979323846264 * 2.;

void main(void) {
    vec4 ownColor = texture2D(uSampler, vTextureCoord);
    vec4 curColor;
    float maxAlpha = 0.;
    vec2 displaced;
    for (float angle = 0.; angle <= DOUBLE_PI; angle += \${angleStep}) {
        displaced.x = vTextureCoord.x + thickness.x * cos(angle);
        displaced.y = vTextureCoord.y + thickness.y * sin(angle);
        curColor = texture2D(uSampler, clamp(displaced, filterClamp.xy, filterClamp.zw));
        maxAlpha = max(maxAlpha, curColor.a * alpha);
    }
    float resultAlpha = max(maxAlpha, ownColor.a);
    gl_FragColor = vec4((ownColor.rgb + outlineColor.rgb * (1. - ownColor.a)) * resultAlpha, resultAlpha);
}
`;const An=class extends et{constructor(t=1,e=0,i=.1,r=1){super(Xb,Vb.replace(/\$\{angleStep\}/,An.getAngleStep(i))),this._thickness=1,this._alpha=1,this.uniforms.thickness=new Float32Array([0,0]),this.uniforms.outlineColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=r,Object.assign(this,{thickness:t,color:e,quality:i,alpha:r})}static getAngleStep(t){const e=Math.max(t*An.MAX_SAMPLES,An.MIN_SAMPLES);return(Math.PI*2/e).toFixed(7)}apply(t,e,i,r){this.uniforms.thickness[0]=this._thickness/e._frame.width,this.uniforms.thickness[1]=this._thickness/e._frame.height,this.uniforms.alpha=this._alpha,t.applyFilter(this,e,i,r)}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get color(){return eo(this.uniforms.outlineColor)}set color(t){Bh(t,this.uniforms.outlineColor)}get thickness(){return this._thickness}set thickness(t){this._thickness=t,this.padding=t}};let uc=An;uc.MIN_SAMPLES=1,uc.MAX_SAMPLES=100;var Wb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,jb=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

uniform bool mirror;
uniform float boundary;
uniform vec2 amplitude;
uniform vec2 waveLength;
uniform vec2 alpha;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 coord = pixelCoord / dimensions;

    if (coord.y < boundary) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    float k = (coord.y - boundary) / (1. - boundary + 0.0001);
    float areaY = boundary * dimensions.y / filterArea.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = mirror ? v : vTextureCoord.y;

    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;
    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;
    float _alpha = (alpha.y - alpha.x) * k + alpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;
    x = clamp(x, filterClamp.x, filterClamp.z);

    vec4 color = texture2D(uSampler, vec2(x, y));

    gl_FragColor = color * _alpha;
}
`;const _p=class extends et{constructor(t){super(Wb,jb),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,_p.defaults,t)}apply(t,e,i,r){var n,o;this.uniforms.dimensions[0]=(n=e.filterFrame)==null?void 0:n.width,this.uniforms.dimensions[1]=(o=e.filterFrame)==null?void 0:o.height,this.uniforms.time=this.time,t.applyFilter(this,e,i,r)}set mirror(t){this.uniforms.mirror=t}get mirror(){return this.uniforms.mirror}set boundary(t){this.uniforms.boundary=t}get boundary(){return this.uniforms.boundary}set amplitude(t){this.uniforms.amplitude[0]=t[0],this.uniforms.amplitude[1]=t[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(t){this.uniforms.waveLength[0]=t[0],this.uniforms.waveLength[1]=t[1]}get waveLength(){return this.uniforms.waveLength}set alpha(t){this.uniforms.alpha[0]=t[0],this.uniforms.alpha[1]=t[1]}get alpha(){return this.uniforms.alpha}};let Yb=_p;Yb.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};var qb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Kb=`precision mediump float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

void main(void)
{
   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/filterArea.xy).r;
   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/filterArea.xy).g;
   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/filterArea.xy).b;
   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;
}
`;let Zb=class extends et{constructor(t=[-10,0],e=[0,10],i=[0,0]){super(qb,Kb),this.red=t,this.green=e,this.blue=i}get red(){return this.uniforms.red}set red(t){this.uniforms.red=t}get green(){return this.uniforms.green}set green(t){this.uniforms.green=t}get blue(){return this.uniforms.blue}set blue(t){this.uniforms.blue=t}};var Qb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Jb=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 filterClamp;

uniform vec2 center;

uniform float amplitude;
uniform float wavelength;
// uniform float power;
uniform float brightness;
uniform float speed;
uniform float radius;

uniform float time;

const float PI = 3.14159;

void main()
{
    float halfWavelength = wavelength * 0.5 / filterArea.x;
    float maxRadius = radius / filterArea.x;
    float currentRadius = time * speed / filterArea.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);
    dir.y *= filterArea.y / filterArea.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );

    vec2 offset = diffUV * powDiff / filterArea.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);

    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;

    gl_FragColor = color;
}
`;const yp=class extends et{constructor(t=[0,0],e,i=0){super(Qb,Jb),this.center=t,Object.assign(this,yp.defaults,e),this.time=i}apply(t,e,i,r){this.uniforms.time=this.time,t.applyFilter(this,e,i,r)}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}get amplitude(){return this.uniforms.amplitude}set amplitude(t){this.uniforms.amplitude=t}get wavelength(){return this.uniforms.wavelength}set wavelength(t){this.uniforms.wavelength=t}get brightness(){return this.uniforms.brightness}set brightness(t){this.uniforms.brightness=t}get speed(){return this.uniforms.speed}set speed(t){this.uniforms.speed=t}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}};let tT=yp;tT.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};var eT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,iT=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform vec4 filterArea;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= offset;

    float dist = length(coord);

    if (dist < radius)
    {
        float ratioDist = (radius - dist) / radius;
        float angleMod = ratioDist * ratioDist * angle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += offset;

    return coord;
}

void main(void)
{

    vec2 coord = mapCoord(vTextureCoord);

    coord = twist(coord);

    coord = unmapCoord(coord);

    gl_FragColor = texture2D(uSampler, coord );

}
`;const vp=class extends et{constructor(s){super(eT,iT),Object.assign(this,vp.defaults,s)}get offset(){return this.uniforms.offset}set offset(s){this.uniforms.offset=s}get radius(){return this.uniforms.radius}set radius(s){this.uniforms.radius=s}get angle(){return this.uniforms.angle}set angle(s){this.uniforms.angle=s}};let rT=vp;rT.defaults={radius:200,angle:4,padding:20,offset:new K};var sT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,nT=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uCenter;
uniform float uStrength;
uniform float uInnerRadius;
uniform float uRadius;

const float MAX_KERNEL_SIZE = \${maxKernelSize};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {

    float minGradient = uInnerRadius * 0.3;
    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;

    float gradient = uRadius * 0.3;
    float radius = (uRadius - gradient * 0.5) / filterArea.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / filterArea.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture2D(uSampler, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,cc=Object.getOwnPropertySymbols,oT=Object.prototype.hasOwnProperty,aT=Object.prototype.propertyIsEnumerable,hT=(s,t)=>{var e={};for(var i in s)oT.call(s,i)&&t.indexOf(i)<0&&(e[i]=s[i]);if(s!=null&&cc)for(var i of cc(s))t.indexOf(i)<0&&aT.call(s,i)&&(e[i]=s[i]);return e};const xp=class extends et{constructor(s){const t=Object.assign(xp.defaults,s),{maxKernelSize:e}=t,i=hT(t,["maxKernelSize"]);super(sT,nT.replace("${maxKernelSize}",e.toFixed(1))),Object.assign(this,i)}get center(){return this.uniforms.uCenter}set center(s){this.uniforms.uCenter=s}get strength(){return this.uniforms.uStrength}set strength(s){this.uniforms.uStrength=s}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(s){this.uniforms.uInnerRadius=s}get radius(){return this.uniforms.uRadius}set radius(s){(s<0||s===1/0)&&(s=-1),this.uniforms.uRadius=s}};let lT=xp;lT.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32};class bp extends nt{constructor(e="none",i=0,r=0,n=0){super();C(this,"bgShape");C(this,"ratioX",0);C(this,"ratioWidth",0);C(this,"frameL");C(this,"frameT");C(this,"frameR");C(this,"frameB");C(this,"posX");C(this,"posY");C(this,"bgShapeColor");this.bgShapeColor=e,this.bgShape=new je,this.posX=0,this.posY=0,this.frameL=0,this.frameT=0,this.frameR=0,this.frameB=0,this.addChild(this.bgShape),this.respRelative(i,r,n)}debugArea(e=.5){this.bgShapeColor!=="none"&&(this.bgShape.alpha=e,this.bgShape.clear(),this.bgShape.beginFill(this.bgShapeColor),this.bgShape.drawRect(this.frameL,this.frameT,this.frameR,this.frameB),this.bgShape.endFill())}respAbsolute(e,i=0,r=.5,n=e*9/16){this.x=window.innerWidth/2,this.y=window.innerHeight/2,n!==e*9/16?this.frameR=n:this.frameR=e*9/16,r==0?this.frameL=r:r==.5?this.frameL=-this.frameR/2:r==1&&(this.frameL=-this.frameR),this.frameT=-window.innerHeight/2+i,this.frameB=e,this.debugArea()}respRelative(e=0,i=0,r=0,n=-window.innerHeight/2,o=window.innerHeight){this.x=window.innerWidth/2,this.y=window.innerHeight/2,this.calcDimensions(e,i,r,n,o),this.debugArea()}calcDimensions(e=0,i=0,r=0,n=-window.innerHeight/2,o=window.innerHeight){const a=window.innerHeight;let h,l,u,c;const d=-a*9/32,f=a*9/16;e===0?(u=i+i*this.ratioX,c=-r*this.ratioWidth,h=d+u,l=f+c):(u=-i*2-i*(this.ratioX*2),c=-r*this.ratioWidth,h=d-u-c,l=f+c),this.frameL=h,this.frameR=l,this.frameT=n,this.frameB=o,this.posX=this.ratioWidth/2,this.posY=a/2}}class dc extends bp{constructor(e,i,r,n){super(e,i,r,n);C(this,"spriteA");C(this,"spriteB");C(this,"speedRatio");this.spriteA=new Dt,this.spriteB=new Dt;const a=Ti.instance.getTexture("Blue_Nebula_02-512x512.png");a&&(this.spriteA=new Dt(a),this.addChild(this.spriteA),this.spriteB=new Dt(a),this.addChild(this.spriteB)),this.speedRatio=2,this.loadSprite()}loadSprite(){this.spriteA.width=this.frameR*this.speedRatio,this.spriteA.height=this.frameB*(this.speedRatio*2.5),this.spriteA.x=-this.spriteA.width/2,this.spriteA.y=-this.spriteA.height/2,this.spriteB.width=this.spriteA.width,this.spriteB.height=this.spriteA.height,this.spriteB.x=-this.spriteB.width/2,this.spriteB.y=-this.spriteB.height*1.5}moveSpaceBackground(){this.speedRatio;const e=this.spriteA.height;this.spriteA.y+=this.speedRatio,this.spriteB.y+=this.speedRatio,this.spriteA.y>=e/2&&(this.spriteA.y=-this.spriteB.height*1.49),this.spriteB.y>=e/2&&(this.spriteB.y=-this.spriteA.height*1.49)}}class un extends bp{constructor(t,e,i,r){super(t,e,i,r)}}class fc{constructor(t){C(this,"app");C(this,"gameMode");C(this,"screen");C(this,"deckR");C(this,"deckL");C(this,"maskFilter");C(this,"stageMaskShape");C(this,"crtMaskShape");C(this,"renderTexture");C(this,"maskSprite");C(this,"pixelatedText");C(this,"playerProjCont");C(this,"enemyProjCont");C(this,"battleUiCont");C(this,"lightYearsText");C(this,"startText");this.app=t,this.gameMode=Ti.instance,this.screen=new dc("black"),this.deckR=new un("black"),this.deckL=new un("black"),this.playerProjCont=new nt,this.enemyProjCont=new nt,this.battleUiCont=new nt,this.maskFilter=new Na(new je),this.stageMaskShape=new je,this.crtMaskShape=new je,this.renderTexture=ke.create({width:800,height:600}),this.maskSprite=new Dt,this.lightYearsText=new Ui("no init"),this.startText=new Ui("no init"),this.pixelatedText=new Ui("")}init(){this.screen=new dc("black"),this.gameMode.stageContainer.addChild(this.screen),this.deckR=new un("red"),this.app.stage.addChild(this.deckR),this.deckL=new un("blue"),this.app.stage.addChild(this.deckL);const t=.01,e=.8;this.deckR.ratioX=t,this.deckR.ratioWidth=e,this.deckL.ratioX=t,this.deckL.ratioWidth=e,this.applyFilters()}async textStart(){document.fonts.load('10pt "Pixelify Sans"').then(()=>{const t=new Ge({fontFamily:"Pixelify Sans",fontSize:30,fill:"white",align:"center"});this.startText=new Ui(`PIXI.JS   ARCADE 
 
 
 WASD / Arrow Keys 
 to MOVE  
  
 SPACE to SHOOT  
 
 
 by Javideas`,t),this.startText.x=this.screen.x-this.screen.frameR*.4,this.startText.y=this.screen.frameB*.3,this.startText.scale.set(this.screen.frameB/600);const e=this.gameMode.stageContainer.children.find(i=>i.name==="mainUiCont");e?e.addChild(this.startText):console.error("battleUiCont is not found or is not a Container.")})}async toggleLightYears(){this.lightYearsText.text==="no init"?await this.textLightYears():(this.updateLightYears(this.gameMode.battle.getLightYears()),this.lightYearsText.visible=!this.lightYearsText.visible)}async textLightYears(){const t=new Ge({fontFamily:"Pixelify Sans",fontSize:30,fill:"white",align:"right"});this.lightYearsText=new Ui("Light Years: 0",t),this.updateLightYears();const e=this.gameMode.stageContainer.children.find(i=>i.name==="battleUiCont");e?e.addChild(this.lightYearsText):console.error("battleUiCont is not found or is not a Container.")}updateLightYears(t=0){this.lightYearsText.text=`Light Years: ${t}`,this.lightYearsText.x=this.screen.x-this.screen.frameR*.4,this.lightYearsText.y=this.screen.frameB*.03,this.lightYearsText.scale.set(this.screen.frameB/1e3)}applyFilters(){this.setCrtFilter(),this.setFiltersToStage()}setFiltersToStage(){const t=new cp({radius:350,strength:.1}),e=new db({gamma:1,contrast:1.2,saturation:2,brightness:1}),i=new Th({threshold:.35,bloomScale:1,brightness:.5,blur:4,quality:4,pixelSize:.5}),r=new Zb([-1,1],[0,0],[1,1]);this.stageMaskShape=new je,this.drawStageMaskShape(),this.maskSprite=new Dt(this.renderTexture),this.maskFilter=new Na(this.maskSprite),this.gameMode.stageContainer.filters=[t,r,e,i,this.maskFilter]}drawStageMaskShape(){this.stageMaskShape.clear(),this.stageMaskShape.beginFill("yellow"),this.stageMaskShape.drawRect(this.screen.frameL+this.screen.x,this.screen.frameT+this.screen.y,this.screen.frameR,this.screen.frameB),this.stageMaskShape.endFill(),this.renderTexture=ke.create({width:this.app.screen.width,height:this.app.screen.height}),this.app.renderer.render(this.stageMaskShape,{renderTexture:this.renderTexture})}setCrtFilter(){const t=new fp({curvature:2,lineContrast:5,lineWidth:1,noise:.05,noiseSize:1,seed:0,time:14,verticalLine:!1,vignetting:.4,vignettingAlpha:.8,vignettingBlur:.2}),e=new Ld(.15);e.blendMode=W.ADD;const i=new Th({threshold:.1,bloomScale:3,brightness:5,blur:1,quality:4,pixelSize:.5});this.crtMaskShape=new je,this.drawCrtMaskShape(),this.gameMode.crtFilterContainer.addChild(this.crtMaskShape),this.gameMode.crtFilterContainer.filters=[t,e,i]}drawCrtMaskShape(){this.crtMaskShape.clear(),this.crtMaskShape.beginFill("#142332"),this.crtMaskShape.drawRect(this.screen.frameL+this.screen.x,this.screen.frameT+this.screen.y,this.screen.frameR,this.screen.frameB),this.crtMaskShape.endFill()}resize(t="landscape"){if(this.lightYearsText.text!=="no init"&&this.updateLightYears(),t==="landscape"){this.deckR.ratioWidth=.3,this.deckL.ratioWidth=.3;const e=0,i=-window.innerHeight/2,r=this.screen.frameR,n=this.screen.frameR,o=this.screen.frameL,a=this.screen.frameR,h=-window.innerHeight/2,l=window.innerHeight;this.uiRespRelative(e,i,r,n,o,a,h,l)}else t==="portrait"&&this.uiRespAbsolute();this.gameMode.battle.responsive(),this.updateFilterMasks()}updateFilterMasks(){this.drawCrtMaskShape(),this.drawStageMaskShape();const t=ke.create({width:this.app.screen.width,height:this.app.screen.height});this.app.renderer.render(this.stageMaskShape,{renderTexture:t});const e=new Dt(t);this.maskFilter.maskSprite=e}uiRespRelative(t=0,e=-window.innerHeight/2,i=0,r=0,n=0,o=0,a=-window.innerHeight/2,h=window.innerHeight){this.screen.respRelative(0,0,t,e,h),this.deckR.respRelative(0,i,r,a,h),this.deckL.respRelative(1,n,o,a,h)}uiRespAbsolute(){this.screen.respAbsolute(window.innerHeight*.8,0,.5,window.innerHeight*.8*9/16),this.deckR.respAbsolute(window.innerHeight-this.screen.frameB,this.screen.frameB,0,this.screen.frameR/2),this.deckL.respAbsolute(window.innerHeight-this.screen.frameB,this.screen.frameB,1,this.screen.frameR/2)}}function ni(s,t){let e=s.children.find(i=>i.name===t);return e||(e=new nt,e.name=t,s.addChild(e)),e}class pc{constructor(){C(this,"gameMode");C(this,"mainUiCont");C(this,"tl");this.gameMode=Ti.instance,this.mainUiCont=new nt,this.tl=tr.timeline()}async createText(){this.mainUiCont=ni(this.gameMode.stageContainer,"mainUiCont"),await this.gameMode.ui.textStart(),this.tl.to(this.gameMode.ui.startText,{y:this.gameMode.ui.startText.y-25,duration:3,ease:"linear",yoyo:!0,repeat:-1})}async init(){console.log("Main Menu"),this.gameMode.ui.startText.text==="no init"&&await this.createText()}playerInput(t="none"){console.log("Main Menu",t),this.gameMode.loadScene("battle")}}class Tp extends nt{constructor(e="player",i="ship",r=1,n=1,o=1,a=0,h=.8,l="ShipPlayer-FullHealth.png",u=!1,c="none"){super();C(this,"gameMode");C(this,"sprite");C(this,"hasAi",!1);C(this,"posAccX",0);C(this,"posAccY",0);C(this,"colX",0);C(this,"colY",0);C(this,"colWidth",0);C(this,"colHeight",0);C(this,"idTeam","player");C(this,"isInmune",!1);C(this,"isColVisible",!1);C(this,"screenRef");C(this,"debugGraphics");C(this,"contWidth",0);C(this,"contHeight",0);C(this,"contPosX",0);C(this,"contPosY",0);C(this,"globalLimitR",0);C(this,"globalLimitL",0);C(this,"globalLimitT",0);C(this,"globalLimitB",0);C(this,"wasDestroyed",!1);C(this,"spriteName","none");C(this,"trackOpponent",!1);C(this,"colWidthRatio",1);C(this,"colHeightRatio",1);C(this,"speedGlobalRatio",1);C(this,"dirX",0);C(this,"dirY",0);C(this,"offsetX",0);C(this,"offsetY",0);C(this,"scaleRatio",1);C(this,"idClass","ship");C(this,"shieldSprite");C(this,"spriteScaleRatio",1.6);C(this,"currentHealth",1);C(this,"damage",1);C(this,"enemyContainer");C(this,"enemyProjCont");C(this,"playerContainer");C(this,"playerProjCont");C(this,"maxHealth",1);this.gameMode=Ti.instance,this.screenRef=this.gameMode.ui.screen,this.enemyContainer=this.gameMode.battle.enemyContainer,this.enemyProjCont=this.gameMode.battle.enemyProjCont,this.playerContainer=this.gameMode.battle.playerContainer,this.playerProjCont=this.gameMode.battle.playerProjCont,this.sprite=new Dt,this.debugGraphics=new je,this.addChild(this.debugGraphics),this.shieldSprite=new Dt,this.reset(e,i,r,n,o,a,h,l,u,c)}async reset(e="player",i="ship",r=1,n=1,o=1,a=0,h=.8,l="ShipPlayer-FullHealth.png",u=!1,c="none"){this.idTeam=e,this.idClass=i,this.damage=n,this.scaleRatio=o,this.maxHealth=r,this.currentHealth=this.maxHealth,this.posAccX=a,this.posAccY=h,this.colWidthRatio=1,this.colHeightRatio=1,this.isColVisible=!1,this.speedGlobalRatio=1,this.wasDestroyed=!1,this.offsetY=0,this.offsetX=0,this.dirY=0,this.dirX=0,this.trackOpponent=!1,this.spriteName="none",this.globalLimitL=0,this.globalLimitR=0,this.globalLimitT=0,this.globalLimitB=0,this.contHeight=0,this.contWidth=0,this.colHeight=0,this.colWidth=0,this.contPosY=0,this.contPosX=0,this.colY=0,this.colX=0,this.hasAi=!1,this.isInmune=!1,c&&c!=="none"&&this.loadShieldSprite(c),u?this.loadBaseAnim(l):await this.loadBaseSprite(l),this.spriteScaleRatio=1.6,this.init()}init(){this.setResponsive(),this.draw()}update(){this.checkCollisions()}checkCollisions(){if(!this.wasDestroyed&&this.idTeam==="player"){for(const e of this.enemyContainer.children)if(e.children)for(const i of e.children){const r=i;if(!r.wasDestroyed&&this.isAnActorColliding(r)){if(this.idClass==="projectile"){if(r.idClass==="projectile"){r.hitted(this.damage),this.destroyActor();return}else if(r.idClass==="ship"&&!r.isInmune){r.hitted(this.damage),this.destroyActor();return}}else if(this.idClass==="ship"){if(r.idClass==="projectile"){r.animDestroyed(),this.hitted(r.damage);return}else if(r.idClass==="ship"&&!r.isInmune){r.hitted(this.damage),this.hitted(r.damage);return}}}}}}toggleInmunity(e=!0){this.isInmune=!this.isInmune,e||(this.shieldSprite.alpha=this.shieldSprite.alpha===0?1:0)}hitted(e=1){this.isInmune||(this.currentHealth-=e,this.currentHealth<=0?this.animDestroyed():(this.toggleInmunity(),this.animHurt()))}animHurt(){if(this.sprite){const e=this.idTeam==="enemy"?65280:16711680;tr.to(this.sprite,{tint:e,duration:.1,repeat:3,yoyo:!0,onComplete:()=>{this.sprite.tint=16777215,this.isInmune&&this.toggleInmunity(!0)}})}}animDestroyed(){this.loadBaseAnim("Explosion","destroyed")}destroyActor(){this.idTeam==="player"&&this.idClass==="ship"&&this.gameMode.battle.gameOver(),this.parent&&this.parent.removeChild(this),this.destroy({children:!0,texture:!1,baseTexture:!1})}flipSprite(e,i=1){e===1?this.sprite.anchor.set(0,e):this.sprite.anchor.set(0,0),this.sprite.scale.y*=-e*i}loadShieldSprite(e){const i=this.gameMode.getTexture(e);i?(this.shieldSprite=new Dt(i),this.addChild(this.shieldSprite),this.shieldSprite.alpha=0):console.error(`Texture ${e} not found`)}async loadBaseSprite(e){const i=this.gameMode.getTexture(e);i?(this.sprite=new Dt(i),this.addChild(this.sprite)):console.error(`Texture ${e} not found`)}loadBaseAnim(e,i="none"){const r=this.gameMode.getAnimationTextures(e);r&&r.length>0?(this.sprite&&this.removeChild(this.sprite),this.sprite=new ws(r),this.sprite instanceof ws&&(this.sprite.animationSpeed=.1,i==="destroyed"&&(this.wasDestroyed=!0,this.sprite.loop=!1,this.idClass==="ship"&&(this.sprite.x=-this.sprite.width,this.sprite.scale.set(this.scaleRatio)),this.sprite.onComplete=()=>this.destroyActor()),this.sprite.play(),this.addChild(this.sprite))):console.error(`Animation ${e} not found`)}isAnActorColliding(e){return!this.parent||!e.parent?!1:(this.setCollisionBox(),e.setCollisionBox(),this.isColVisible?(this.drawDebugBoundingBox(this.colX,this.colY,this.colWidth,this.colHeight,65280),e.drawDebugBoundingBox(e.colX,e.colY,e.colWidth,e.colHeight,16711680)):(this.debugGraphics.clear(),e.debugGraphics.clear()),this.colX<e.colX+e.colWidth&&this.colX+this.colWidth>e.colX&&this.colY<e.colY+e.colHeight&&this.colY+this.colHeight>e.colY)}drawDebugBoundingBox(e,i,r,n,o){this.debugGraphics.clear(),this.debugGraphics.lineStyle(2,o,1),this.debugGraphics.drawRect(e-this.x,i-this.y,r,n)}draw(){this.sprite.width=this.contWidth*this.spriteScaleRatio,this.sprite.height=this.contHeight*this.spriteScaleRatio,this.sprite.x=-this.sprite.width/2,this.sprite.y=-this.sprite.height/2,this.shieldSprite&&(this.shieldSprite.width=this.contWidth*this.spriteScaleRatio*1.5,this.shieldSprite.height=this.contHeight*this.spriteScaleRatio*1.5,this.shieldSprite.x=-this.shieldSprite.width/2,this.shieldSprite.y=-this.shieldSprite.height/2)}setCollisionBox(){this.colX=this.x+this.sprite.x*this.colWidthRatio,this.colY=this.y+this.sprite.y*this.colHeightRatio,this.colWidth=this.sprite.width*this.colWidthRatio,this.colHeight=this.sprite.height*this.colHeightRatio}moveX(e=1){const i=this.calcMove("x",this.posAccX,e,this.globalLimitL,this.globalLimitR);i!==null&&(this.posAccX=i,this.setResponsive())}moveY(e=1){const i=this.calcMove("y",this.posAccY,e,this.globalLimitT,this.globalLimitB);i!==null&&(this.posAccY=i,this.setResponsive())}calcMove(e,i,r,n,o){const a=o-n;let h=0,l=0;this.idClass==="ship"&&this.idTeam==="player"?e==="x"?h=.017:e==="y"&&(l=.005):(h=.007,this.idClass==="projectile"?e==="y"&&r>0?l=.015:e==="y"&&r<0&&(l=.02):l=.0015);const c=(e==="x"?h:l)*this.speedGlobalRatio*(a/(this.globalLimitR-this.globalLimitL)),d=i+r*c,f=(d+1)/2*(o-n)+n;return f>=n&&f<=o?d:(this.idClass!=="projectile"||this.destroyActor(),null)}trackPos(){this.parent&&(this.x=(this.posAccX+1)/2*(this.globalLimitR-this.globalLimitL)+this.globalLimitL,this.y=(this.posAccY+1)/2*(this.globalLimitB-this.globalLimitT)+this.globalLimitT)}setResponsive(){this.calcRespScale(),this.calcRespLimits(),this.trackPos()}calcRespScale(){this.contWidth=.07*this.scaleRatio*this.screenRef.frameB,this.contPosX=-this.contWidth/2,this.contPosY=-this.contWidth/2,this.contHeight=this.contWidth}calcRespLimits(){const e=this.screenRef.frameR/2-this.contWidth/2,i=this.screenRef.frameL+this.contWidth/2;this.globalLimitR=window.innerWidth/2+e,this.globalLimitL=window.innerWidth/2+i,this.globalLimitT=this.contHeight/2,this.globalLimitB=this.screenRef.frameB-this.contHeight/2}}class uT extends Tp{constructor(e,i,r=1,n=0,o=-1,a=0,h=0,l=.3){super(e.idTeam,"projectile",1,r,e.idTeam==="player"?l:1,e.posAccX+a,e.posAccY-h,e.idTeam==="player"?"VfxGreen":"Projectile",!0);C(this,"isActive",!1);C(this,"shooterRef");this.shooterRef=e,this.spriteName="Projectile",this.trackOpponent=i,this.colWidthRatio=.15,this.colHeightRatio=.35,this.speedGlobalRatio=1,this.dirX=n,this.dirY=o,this.offsetX=a,this.offsetY=h,this.flipSprite(o)}update(){super.update(),this.trackOpponent||(this.moveX(this.dirX),this.moveY(this.dirY))}destroyActor(){this.isActive=!1,super.destroyActor()}}class wp extends Tp{constructor(e,i,r=1,n=1,o=0,a=.8,h=15,l="ShipPlayer-FullHealth.png",u){super(e,"ship",i,r,n,o,a,l,!1,u);C(this,"fireRate");C(this,"cooldown");C(this,"hasShot");C(this,"shotDirY");C(this,"weaponType");C(this,"contWidth",0);C(this,"contHeight",0);C(this,"contPosX",0);C(this,"contPosY",0);this.weaponType="none",this.idTeam=e,this.fireRate=h,this.cooldown=0,this.hasShot=!1,this.shotDirY=-1}update(e){super.update(),e&&(this.cooldown+=e,this.cooldown>=this.fireRate&&(this.hasShot=!1))}shoot(e="trinormal"){if(!this.hasShot&&!this.wasDestroyed){switch(e){case"trinormal":this.spawnProjectile(!1,1,.5,this.shotDirY),this.spawnProjectile(!1,1,-.5,this.shotDirY),this.spawnProjectile(!1,1,0,this.shotDirY);break;case"doubleFwd":this.spawnProjectile(!1,1,0,this.shotDirY,.13,0),this.spawnProjectile(!1,1,0,this.shotDirY,-.13,0);break}this.hasShot=!0,this.cooldown=0}}spawnProjectile(e,i,r,n,o,a){const h=new uT(this,e,i,r,n,o,a);this.idTeam=="player"?this.playerProjCont.addChild(h):this.enemyProjCont.addChild(h)}}class cT extends wp{constructor(e=0,i=.8){super("player",4,1,1,e,i,8,"ShipPlayer-FullHealth.png","Invincibility-9.png");C(this,"isColVisible");C(this,"contWidth",0);C(this,"contHeight",0);C(this,"contPosX",0);C(this,"contPosY",0);this.isColVisible=!1,this.isInmune=!1,this.spriteName="ShipPlayer-FullHealth.png",this.speedGlobalRatio=2,this.colWidthRatio=.4,this.colHeightRatio=.6,this.moveX(0),this.moveY(0)}showCollisions(){this.isColVisible=!this.isColVisible}shoot(){super.shoot("doubleFwd")}moveX(e){this.wasDestroyed||super.moveX(e)}moveY(e){this.wasDestroyed||super.moveY(e)}}function dT(s="malko"){return s==="malko"?{spriteName:"Enemy - Battlecruiser - Base.png",scaleRatio:.7,health:5,damage:1,fireRate:15,colWidthRatio:.4,colHeightRatio:.6,weaponType:"doubleFwd"}:s==="guliamo"?{spriteName:"Enemy - Dreadnought - Base.png",scaleRatio:2,health:10,damage:1,fireRate:15,colWidthRatio:.5,colHeightRatio:.7,weaponType:"trinormal"}:s==="asteroid"?{spriteName:"Asteroid 01 - Base.png",scaleRatio:Math.random()*3+1,health:4,damage:100,fireRate:0,colWidthRatio:.4,colHeightRatio:.2,weaponType:"none"}:{spriteName:"Asteroid 01 - Base.png",scaleRatio:1,health:1,damage:1,fireRate:0,colWidthRatio:.5,colHeightRatio:.5,weaponType:"none"}}class fT extends wp{constructor(e="malko",i,r){const n=dT(e);super("enemy",n.health,n.damage,n.scaleRatio,i,r,n.fireRate,n.spriteName,"none");C(this,"tl");C(this,"autoShoot");C(this,"enemyType");C(this,"contWidth",0);C(this,"contHeight",0);C(this,"contPosX",0);C(this,"contPosY",0);this.tl=tr.timeline({}),this.enemyType=e,this.weaponType=n.weaponType,this.colWidthRatio=n.colWidthRatio,this.colHeightRatio=n.colHeightRatio,this.shotDirY=1,this.autoShoot=!1,this.flipSprite(this.shotDirY),this.aibehaviour()}update(e){super.update(e),this.wasDestroyed?this.y+=this.screenRef.speedRatio/2:this.autoShoot&&this.shoot(this.weaponType)}shoot(e="trinormal"){super.shoot(e)}aibehaviour(){this.tl=tr.timeline({onUpdate:()=>{this.setResponsive(),this.wasDestroyed&&this.tl.kill()}}),this.enemyType==="malko"?this.aiMoveEightShape(this.tl):this.enemyType==="guliamo"?this.aiMoveTopDown(this.tl):this.enemyType==="asteroid"&&this.aiMoveDownRotating(this.tl)}aiMoveEightShape(e){e.to(this,{posAccX:0,duration:2,ease:"power3.out"},0).to(this,{posAccY:-.5,duration:2,ease:"power2.in"},0),e.to(this,{posAccX:-.85,duration:2,ease:"power2.inOut"},"+=0"),e.to(this,{posAccY:0,duration:3,ease:"power3.inOut",onStart:()=>{this.autoShoot=!0}},"-=2.9"),e.to(this,{posAccX:.85,duration:1,ease:"sine.inOut",repeat:11-1,yoyo:!0},"-=1").to(this,{posAccY:.8,duration:6.5,ease:"sine.inOut"},"-=13").to(this,{posAccY:-.8,duration:6,ease:"sine.inOut",onStart:()=>{this.shotDirY=-1,this.flipSprite(this.shotDirY,-1)}},"-=7.5"),e.to(this,{posAccX:-2,duration:2,ease:"power2.out",onStart:()=>{this.autoShoot=!1},onComplete:()=>{this.destroyActor()}},"-=1.5")}aiMoveTopDown(e){e.to(this,{posAccY:-.5,duration:2,ease:"power1.out"},0).to(this,{posAccY:2,duration:10,ease:"sine.inOut",onStart:()=>{this.autoShoot=!0}},"+=0")}aiMoveDownRotating(e){e.to(this,{posAccY:2,duration:10,ease:"power1.out"},0).to(this,{rotation:360,duration:400,ease:"linear",repeat:-1},0)}pauseTimeline(){this.tl&&this.tl.pause()}resumeTimeline(){this.tl&&this.tl.resume()}}class mc{constructor(){C(this,"gameMode");C(this,"playerContainer");C(this,"enemyContainer");C(this,"player",null);C(this,"enemyProjCont");C(this,"enemyShipCont");C(this,"playerProjCont");C(this,"playerShipCont");C(this,"battleUiCont");C(this,"elapsedDelta",0);C(this,"currentTime",0);C(this,"randomInterval",2e3);C(this,"lightYears",0);this.gameMode=Ti.instance,this.enemyContainer=new nt,this.enemyProjCont=new nt,this.enemyShipCont=new nt,this.playerProjCont=new nt,this.playerShipCont=new nt,this.playerContainer=new nt,this.battleUiCont=new nt}async init(){await this.loadContainers(),await this.gameMode.ui.toggleLightYears(),this.player=new cT,this.playerShipCont.addChild(this.player),this.spawnEnemy("malko",1.3,-.8)}async gameOver(){console.log("---Game Over---"),await this.resetBattle(),this.lightYears=0,this.elapsedDelta=0,this.currentTime=0,await this.gameMode.ui.toggleLightYears(),this.gameMode.loadScene("mainMenu")}update(t){this.elapsedDelta+=t,this.logElapsedTime(),this.gameProgress(),this.gameMode.ui.screen.moveSpaceBackground(),this.enemyContainer.children.forEach(e=>{e.children&&e.children.forEach(i=>{const r=i;typeof r.draw=="function"&&r.update(t)})}),this.playerContainer.children.forEach(e=>{e.children&&e.children.forEach(i=>{const r=i;typeof r.draw=="function"&&r.update(t)})})}logElapsedTime(){const t=Math.floor(this.elapsedDelta/60)*1e3;t>this.currentTime&&(this.currentTime=t)}gameProgress(){this.currentTime!==0&&(this.currentTime>this.randomInterval?(this.spawnRandEnemy(),this.randomInterval=this.randomInterval+this.getRandomNumber(3e3,5e3)):this.currentTime>1e3*this.lightYears&&(this.lightYears<7&&(this.gameMode.ui.screen.speedRatio+=1*.5),this.lightYears++,this.gameMode.ui.updateLightYears(this.lightYears)))}spawnRandEnemy(){const t=["malko","guliamo","asteroid"],e=Math.floor(Math.random()*t.length);t[e]==="malko"?this.spawnEnemy(t[e],Math.random()*2-1,-.8):this.spawnEnemy(t[e],Math.random()*2-1,-1.6)}getRandomNumber(t,e){return Math.floor(Math.random()*(e-t+1))+t}spawnEnemy(t="guliamo",e=0,i=-1){const r=new fT(t,e,i);this.enemyShipCont.addChild(r),r.setResponsive()}async loadContainers(){this.enemyContainer=ni(this.gameMode.stageContainer,"enemyContainer"),this.enemyProjCont=ni(this.enemyContainer,"enemyProjCont"),this.enemyShipCont=ni(this.enemyContainer,"enemyShipCont"),this.playerContainer=ni(this.gameMode.stageContainer,"playerContainer"),this.playerProjCont=ni(this.playerContainer,"playerProjCont"),this.playerShipCont=ni(this.playerContainer,"playerShipCont"),this.battleUiCont=ni(this.gameMode.stageContainer,"battleUiCont")}responsive(){this.enemyContainer.children.forEach(t=>{t.children&&t.children.forEach(e=>{const i=e;typeof i.setResponsive=="function"&&typeof i.draw=="function"&&(i.setResponsive(),i.draw())})}),this.playerContainer.children.forEach(t=>{t.children&&t.children.forEach(e=>{const i=e;typeof i.setResponsive=="function"&&typeof i.draw=="function"&&(i.setResponsive(),i.draw())})})}resetBattle(){this.enemyProjCont.removeChildren(),this.enemyShipCont.removeChildren(),this.enemyContainer.removeChildren(),this.playerProjCont.removeChildren(),this.playerShipCont.removeChildren(),this.playerContainer.removeChildren()}getLightYears(){return this.lightYears}}const Gi=class Gi{constructor(){C(this,"textures",{});C(this,"animations",{})}static getInstance(){return Gi.instance||(Gi.instance=new Gi),Gi.instance}addTexture(t,e){this.textures[t]=e}getTexture(t){return this.textures[t]}setAnimations(t){this.animations=Object.fromEntries(Object.entries(t).map(([e,i])=>[e,i.map(r=>r)]))}getAnimationFrames(t){return this.animations[t]}};C(Gi,"instance");let gs=Gi;const Qn=class Qn{constructor(t,e){C(this,"app");C(this,"ui");C(this,"stageContainer");C(this,"mainMenu");C(this,"battle");C(this,"crtFilterContainer");C(this,"currentMode");C(this,"lastInmuneKeyPressed",-600);C(this,"lastShowColKeyPressed",-600);C(this,"delta",0);this.app=t,this.stageContainer=e,this.crtFilterContainer=t.stage.getChildByName("crtFilterContainer"),this.mainMenu=new pc,this.battle=new mc,this.currentMode="none",Qn.instance=this,this.ui=new fc(this.app)}async loadScene(t="mainMenu"){switch(this.lastInmuneKeyPressed=-600,this.lastShowColKeyPressed=-600,this.currentMode=t,t){case"mainMenu":this.ui.startText&&(this.ui.startText.visible=!0),this.mainMenu=new pc,await this.mainMenu.init();return;case"battle":this.ui.startText&&(this.ui.startText.visible=!1),this.battle=new mc,await this.battle.init();return}window.innerWidth>window.innerHeight?this.resize("landscape"):this.resize("portrait")}async init(){await this.loadAssets(),await this.loadUi(),await this.loadScene("mainMenu"),window.innerWidth>window.innerHeight?this.resize("landscape"):this.resize("portrait"),tr.ticker.add(this.update.bind(this))}update(){if(this.delta=tr.ticker.deltaRatio(60),this.filtersUpdate(),this.currentMode==="battle")return this.battle.update(this.delta)}filtersUpdate(){if(this.crtFilterContainer&&this.crtFilterContainer.filters){const t=this.crtFilterContainer.filters;t[0]&&"time"in t[0]&&(t[0].time-=this.delta/5),t[2]&&"brightness"in t[2]&&(t[2].brightness=Math.sin(this.delta*3)*-2+6)}}async loadUi(){this.ui=new fc(this.app),await this.ui.init()}async loadAssets(){const t=gs.getInstance(),e="./assets/ShipPlayer.json";try{const i=await is.load(e),r=Object.fromEntries(Object.entries(i.animations).map(([n,o])=>[n,o.map(a=>a.textureCacheIds[0])]));t.setAnimations(r);for(const[n,o]of Object.entries(i.textures))t.addTexture(n,o)}catch(i){console.error("Error loading spritesheet:",i)}}getTexture(t){return gs.getInstance().getTexture(t)}getAnimationTextures(t){const i=gs.getInstance().getAnimationFrames(t);return i?i.map(n=>{if(typeof n!="string"){console.error(`Invalid frame name: ${n}`);return}const o=this.getTexture(n);return o||console.error(`Texture ${n} not found`),o}).filter(n=>n!==void 0):(console.error(`Animation ${t} not found in JSON`),[])}playerInput(t="none"){if(this.battle.player&&this.currentMode==="battle"){if(this.delta<.016)return;switch(t){case"left":this.battle.player.moveX(-1);break;case"right":this.battle.player.moveX(1);break;case"up":this.battle.player.moveY(-1);break;case"down":this.battle.player.moveY(1);break;case"up-left":this.battle.player.moveX(-1),this.battle.player.moveY(-1);break;case"up-right":this.battle.player.moveX(1),this.battle.player.moveY(-1);break;case"down-left":this.battle.player.moveX(-1),this.battle.player.moveY(1);break;case"down-right":this.battle.player.moveX(1),this.battle.player.moveY(1);break;case"shoot":this.battle.player.shoot();break;case"inmunity":this.battle.currentTime-this.lastInmuneKeyPressed>500&&(this.battle.player.toggleInmunity(!1),this.battle.player.isColVisible&&this.battle.player.showCollisions(),this.lastInmuneKeyPressed=this.battle.currentTime);break;case"showCollisions":this.battle.currentTime-this.lastShowColKeyPressed>500&&(this.battle.player.showCollisions(),this.lastShowColKeyPressed=this.battle.currentTime);break}}else this.currentMode==="mainMenu"&&this.mainMenu.playerInput(t)}resize(t="landscape"){this.ui.resize(t)}};C(Qn,"instance");let Ti=Qn;const Ap="#020305";document.body.style.backgroundColor=Ap;const _r=new Ud({backgroundColor:Ap,resolution:Math.max(window.devicePixelRatio,2),resizeTo:window,autoDensity:!0,antialias:!1}),Ep=new nt;Ep.name="crtFilterContainer";const Eh=new nt;Eh.name="stageContainer";let En;var la=!1;pT();async function pT(){document.body.appendChild(_r.view),_r.stage.addChild(Eh),_r.stage.addChild(Ep),_r.view.style.imageRendering="pixelated",j.defaultOptions.scaleMode=ge.NEAREST,En=new Ti(_r,Eh),await En.init(),mT(En),Sp()}function mT(s){const t=window.matchMedia("(orientation: landscape)");t.addEventListener("change",gc),window.addEventListener("resize",Sp);const e=new Set;window.addEventListener("keydown",a=>{["ArrowLeft","a","ArrowRight","d","ArrowUp","w","ArrowDown","s"," ","Enter","Backspace","i","p","b"].includes(a.key)&&(a.preventDefault(),e.add(a.key))}),window.addEventListener("keyup",a=>{e.delete(a.key)});let i=0;const r=1e3/60;function n(){const a=performance.now();a-i<r||(i=a,(e.has("ArrowLeft")||e.has("a"))&&s.playerInput("left"),(e.has("ArrowRight")||e.has("d"))&&s.playerInput("right"),(e.has("ArrowUp")||e.has("w"))&&s.playerInput("up"),(e.has("ArrowDown")||e.has("s"))&&s.playerInput("down"),e.has("i")&&s.playerInput("inmunity"),(e.has(" ")||e.has("Enter"))&&s.playerInput("shoot"),(e.has("p")||e.has("Backspace"))&&s.playerInput("pause"),e.has("b")&&s.playerInput("showCollisions"))}function o(){n(),requestAnimationFrame(o)}o(),gc(t)}function _s(s="landscape"){En.resize(s)}function gc(s){s.matches?_s("landscape"):_s("portrait")}function Sp(){_r.renderer.resize(window.innerWidth,window.innerHeight),window.innerWidth>window.innerHeight?(la=!1,_s("landscape")):(la=!0,_s("portrait")),la||_s()}
